!function(e,t){"use strict";function i(e){function t(e){return e}var i=this,a={},o=new L.OsmGeocodingService(e,a),n={house_number:{"Num casa":!0},road:{Calle:!0},suburb:{Suburb:!1},city:{Ciudad:!0},county:{Provincia:!0},state_district:{Suburb:!1},state:{Estado:!1},postcode:{CP:!1},country:{"Pa√≠s":!0},country_code:{cc:!1}};i.search=function(e,t,i){var a=e;!t&&"2"||t.limit||"3";o.search(a,t,i)},i.reverseSearch=function(e,i,a,r,s){$.extend({},n);s=$.extend({},s),o.reverseSearch(e,i,a,function(e,i){if(e)r(e);else{var a=t(i);r(null,a)}},s)}}function a(e,t,i,a,o){var n=L.UxMap||L.Map;return{restrict:"EA",replace:!0,scope:{center:"=",lfCenter:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"=",markersWatchOptions:"=",geojsonWatchOptions:"="},transclude:!0,template:"<div class='angular-leaflet-map'><div ng-transclude></div></div>",controller:["$scope",function(t){this._leafletMap=e.defer(),this.getMap=function(){return this._leafletMap.promise},this.getLeafletScope=function(){return t}}],link:function(e,r,s,l){function c(){isNaN(s.width)?r.css("width",s.width):r.css("width",s.width+"px")}function d(){isNaN(s.height)?r.css("height",s.height):r.css("height",s.height+"px")}var u,p=a.isDefined,h=i.setDefaults(e.defaults,s.id),f=o.getAvailableMapEvents(),m=o.addEvents;e.mapId=s.id,t.setDirectiveControls({},s.id),p(s.width)&&(c(),e.$watch(function(){return r[0].getAttribute("width")},function(){c(),u.invalidateSize()})),p(s.height)&&(d(),e.$watch(function(){return r[0].getAttribute("height")},function(){d(),u.invalidateSize()}));var g=i.getMapCreationDefaults(s.id);if(u=new n(r[0],g),l._leafletMap.resolve(u),p(s.center)||p(s.lfCenter)||u.setView([h.center.lat,h.center.lng],h.center.zoom),!p(s.tiles)&&!p(s.layers)){var v=L.tileLayer(h.tileLayer,h.tileLayerOptions);v.addTo(u),t.setTiles(v,s.id)}if(p(u.zoomControl)&&p(h.zoomControlPosition)&&u.zoomControl.setPosition(h.zoomControlPosition),p(u.zoomControl)&&h.zoomControl===!1&&u.zoomControl.removeFrom(u),p(u.zoomsliderControl)&&p(h.zoomsliderControl)&&h.zoomsliderControl===!1&&u.zoomsliderControl.removeFrom(u),!p(s.eventBroadcast)){var y="broadcast";m(u,f,"eventName",e,y)}u.whenReady(function(){t.setMap(u,s.id)}),e.$on("$destroy",function(){i.reset(),u.remove(),t.unresolveMap(s.id)}),e.$on("invalidateSize",function(){u.invalidateSize()})}}}function o(){}function n(){Object.defineProperty(this,"fields",{value:{identifier:"provision.administration.identifier",organization:"provision.administration.organization",serviceGroup:"provision.administration.serviceGroup",channel:"provision.administration.channel",feed:"provision.administration.defaultFeed",plan:"provision.administration.plan",resourceType:"resourceType"},writable:!1})}function r(){Object.defineProperty(this,"fields",{value:{specificType:"device.specificType",location:"device.location",name:"device.name",description:"device.description",operationalStatus:"device.operationalStatus",serialNumber:"device.serialNumber",identifier:"device.identifier",model:"device.model",software:"device.software",trustedBoot:"device.trustedBoot",image:"device.image",related:"device.related",commsModule:"provision.device.communicationModules[]",commsModuleIdentifier:"provision.device.communicationModules[].identifier",commsModuleSpecificType:"provision.device.communicationModules[].specificType",commsModuleImei:"provision.device.communicationModules[].mobile.imei",imei:"provision.device.communicationModules[].mobile.imei",pac:"provision.device.communicationModules[].sigfox.pac",subscriberIdentifier:"device.communicationModules[].subscriber.identifier",subscriberSerialNumber:"device.communicationModules[].subscriber.serialNumber",subscriberSpecificType:"device.communicationModules[].subscriber.specificType",subscriberName:"device.communicationModules[].subscriber.name",subscriberDescription:"device.communicationModules[].subscriber.description",subscriptionIdentifier:"device.communicationModules[].subscription.identifier",subscriptionSpecificType:"device.communicationModules[].subscription.specificType",subscriptionName:"device.communicationModules[].subscription.name",subscriptionDescription:"device.communicationModules[].subscription.description",subscriptionImsi:"device.communicationModules[].subscription.mobile.imsi",imsi:"device.communicationModules[].subscription.mobile.imsi",subscriptionMsisdn:"device.communicationModules[].subscription.mobile.msisdn",msisdn:"device.communicationModules[].subscription.mobile.msisdn",subscriptionMsisdnVoice:"device.communicationModules[].subscription.mobile.voice.msisdn",subscriptionAddress:"device.communicationModules[].subscription.address",address:"device.communicationModules[].subscription.address",subscriptionHomeOperator:"device.communicationModules[].subscription.mobile.homeOperator",homeOperator:"device.communicationModules[].subscription.mobile.homeOperator",subscriptionRegisteredOperator:"device.communicationModules[].subscription.mobile.registeredOperator",registereOperator:"device.communicationModules[].subscription.mobile.registeredOperator"},writable:!1})}function s(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{adState:"provision.device.administrativeState",certificates:"provision.device.certificates",subscriberAdState:"device.communicationModules[].subscriber.administrativeState",subscriptionAdState:"device.communicationModules[].subscription.administrativeState",subscriberIcc:"provision.device.communicationModules[].subscriber.mobile.icc",icc:"provision.device.communicationModules[].subscriber.mobile.icc"}),writable:!1})}function l(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{image:"asset.image"}),writable:!1})}function c(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{image:"provision.asset.image"}),writable:!1})}function d(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{identifier:"provision.ticket.identifier",name:"provision.ticket.name",label:"provision.ticket.label",type:"provision.ticket.type",severity:"provision.ticket.severity",priority:"provision.ticket.priority",reporter:"provision.ticket.reporter",owner:"provision.ticket.owner",assignee:"provision.ticket.assignee",status:"provision.ticket.status",section:"provision.ticket.section",entity:"provision.ticket.entity",creationDate:"provision.ticket.creationDate",reporterDate:"provision.ticket.reporterDate",assignedDate:"provision.ticket.assignedDate",answeredDate:"provision.ticket.answeredDate",updatedDate:"provision.ticket.updatedDate",restorationDate:"provision.ticket.restorationDate",resolutionDate:"provision.ticket.resolutionDate",closedDate:"provision.ticket.closedDate",specificType:"provision.ticket.specificType"}),writable:!1})}function u(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{surname:"human.surname",surname2:"human.surname2",birthdate:"human.birthdate"}),writable:!1})}function p(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{surname:"provision.human.surname",surname2:"provision.human.surname2",birthdate:"provision.human.birthdate"}),writable:!1})}function h(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{adState:"device.communicationModules[].subscriber.administrativeState",identifier:"device.communicationModules[].subscriber.identifier",specificType:"device.communicationModules[].subscriber.specificType"}),writable:!1})}function f(){}function m(){}function g(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{adState:"device.communicationModules[].subscription.administrativeState",identifier:"device.communicationModules[].subscription.identifier",specificType:"device.communicationModules[].subscription.specificType"}),writable:!1})}function v(){this.dataurl_regex=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i,this.isDataUrl=function(e){return"string"==typeof e&&!!e.match(this.dataurl_regex)}}function y(){}if(angular.module("uxleaflet",[]),angular.module("opengate-angular-js",["schemaForm","uxleaflet","ui-leaflet"]),angular.module("opengate-angular-js").run(["$templateCache",function(e){e.put("components/views/fieldOptions.html",'<small class=ux-txt-danger ng-if=$ctrl.required title="{{ \'FORM.FIELD.REQUIRED\' | translate }}">*</small> <small class=ux-txt-warning ng-if=$ctrl.optional title="{{ \'FORM.FIELD.OPTIONAL\' | translate }}">(-)</small> <small class=ux-txt-info ng-if=$ctrl.multiple title="{{ \'FORM.FIELD.MULTIPLE\' | translate }}"><span class=fa-stack style=font-size:0.5em;><i class="fa fa-clone fa-stack-2x"></i> <i class="fa fa-check fa-stack-1x"></i></span></small>'),e.put("custom-ui-select/views/custom.ui.select.area.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.AREA\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=area ng-model=$ctrl.area theme=bootstrap title="{{ \'FORM.PLACEHOLDER.AREA_MULTI\' | translate }}" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.areaSelected($item, $model)" on-remove="$ctrl.areaRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.AREA_MULTI\' | translate }}" allow-clear=true>{{$item.identifier}}</ui-select-match><ui-select-choices repeat="area in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="area.identifier | highlight: $select.search"></span> - <span ng-bind-html="area.name | highlight: $select.search"></span><br><span ng-bind-html="area.organization | highlight: $select.search"></span></div></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.AREA\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=area ng-model=$ctrl.area theme=bootstrap title="Choose an area" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.areaSelected($item, $model)" on-remove="$ctrl.areaRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.AREA\' | translate }}" allow-clear=true>{{$item.identifier}}</ui-select-match><ui-select-choices repeat="area in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="area.identifier | highlight: $select.search"></span> - <span ng-bind-html="area.name | highlight: $select.search"></span><br><span ng-bind-html="area.organization | highlight: $select.search"></span></div></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.asset.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><ui-select custom-ui-select-config=$ctrl.ownConfig name=asset ng-model=$ctrl.asset theme=bootstrap title="Choose a asset" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.assetSelected($item, $model)" on-remove="$ctrl.assetRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="assetData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="assetData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=assetData.provision.asset.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="assetData.provision.asset.specificType._current.value | highlight: $select.search"></span></div><div ng-if=assetData.provision.asset.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+assetData.provision.asset.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><ui-select custom-ui-select-config=$ctrl.ownConfig name=asset ng-model=$ctrl.asset theme=bootstrap title="Choose an asset" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.assetSelected($item, $model)" on-remove="$ctrl.assetRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="assetData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="assetData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=assetData.provision.asset.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="assetData.provision.asset.specificType._current.value | highlight: $select.search"></span></div><div ng-if=assetData.provision.asset.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+assetData.provision.asset.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.bundle.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.BUNDLE\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=bundle ng-model=$ctrl.bundle theme=bootstrap title="{{ \'FORM.PLACEHOLDER.BUNDLE_MULTI\' | translate }}" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.bundleSelected($item, $model)" on-remove="$ctrl.bundleRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.BUNDLE_MULTI\' | translate }}" allow-clear=true>{{$item.name}} (v{{$item.version}})</ui-select-match><ui-select-choices repeat="bundle in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="bundle.name | highlight: $select.search"></span> - <span ng-bind-html="bundle.version | highlight: $select.search"></span><br><span ng-bind-html="bundle.description | highlight: $select.search"></span></div></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.BUNDLE\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=bundle ng-model=$ctrl.bundle theme=bootstrap title="Choose an bundle" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.bundleSelected($item, $model)" on-remove="$ctrl.bundleRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.BUNDLE\' | translate }}" allow-clear=true>{{$item.name}} (v{{$item.version}})</ui-select-match><ui-select-choices repeat="bundle in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="bundle.name | highlight: $select.search"></span> (v<span ng-bind-html="bundle.version | highlight: $select.search"></span>)<br><span ng-bind-html="bundle.description | highlight: $select.search"></span></div></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.datastream.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.DATASTREAM_ID\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=datastream ng-model=$ctrl.datastream theme=bootstrap title="{{ ($ctrl.placeholder?$ctrl.placeholder:\'FORM.PLACEHOLDER.DATASTREAM\') | translate }}" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.datastreamSelected($item, $model)" on-remove="$ctrl.datastreamRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ ($ctrl.placeholder?$ctrl.placeholder:\'FORM.PLACEHOLDER.DATASTREAM\') | translate }}" allow-clear=true>{{$item.identifier}}</ui-select-match><ui-select-choices repeat="ds in $ctrl.ownConfig.collection | limitTo:$ctrl.maxResults track by $index"><div><span ng-bind-html="ds.identifier | highlight: $select.search"></span> - <span ng-bind-html="ds.name | highlight: $select.search"></span></div><small><div ng-if=ds.category.name>{{ \'FORM.LABEL.CATEGORY\' | translate }} <span ng-bind-html="ds.category.name | highlight: $select.search"></span></div><div ng-if=ds.feed>{{ \'FORM.LABEL.FEED\' | translate }}: <span ng-bind-html="ds.feed | highlight: $select.search"></span></div><div ng-if=ds.datamodel><div>{{ \'FORM.LABEL.DATAMODEL\' | translate }}:</div><div>- {{ \'FORM.LABEL.ID\' | translate }}: <span ng-bind-html="ds.datamodel.identifier | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.ORGANIZATION\' | translate }}: <span ng-bind-html="ds.datamodel.organization | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="ds.datamodel.name | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.DESCRIPTION\' | translate }}: <span ng-bind-html="ds.datamodel.description | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.VERSION\' | translate }}: <span ng-bind-html="ds.datamodel.version | highlight: $select.search"></span></div></div></div></div></div></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.DATASTREAM_ID\' | translate}}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=datastream ng-model=$ctrl.datastream theme=bootstrap title="{{ ($ctrl.placeholder?$ctrl.placeholder:\'FORM.PLACEHOLDER.DATASTREAM\') | translate }}" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.datastreamSelected($item, $model)" on-remove="$ctrl.datastreamRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ ($ctrl.placeholder?$ctrl.placeholder:\'FORM.PLACEHOLDER.DATASTREAM\') | translate }}" allow-clear=true>{{$item.identifier}}</ui-select-match><ui-select-choices repeat="ds in $ctrl.ownConfig.collection | limitTo:$ctrl.maxResults track by $index"><div><span ng-bind-html="ds.identifier | highlight: $select.search"></span> - <span ng-bind-html="ds.name | highlight: $select.search"></span></div><small><div ng-if=ds.category.name>{{ \'FORM.LABEL.CATEGORY\' | translate }} <span ng-bind-html="ds.category.name | highlight: $select.search"></span></div><div ng-if=ds.feed>{{ \'FORM.LABEL.FEED\' | translate }}: <span ng-bind-html="ds.feed | highlight: $select.search"></span></div><div ng-if=ds.datamodel><div>{{ \'FORM.LABEL.DATAMODEL\' | translate }}:</div><div>- {{ \'FORM.LABEL.ID\' | translate }}: <span ng-bind-html="ds.datamodel.identifier | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.ORGANIZATION\' | translate }}: <span ng-bind-html="ds.datamodel.organization | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="ds.datamodel.name | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.DESCRIPTION\' | translate }}: <span ng-bind-html="ds.datamodel.description | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.VERSION\' | translate }}: <span ng-bind-html="ds.datamodel.version | highlight: $select.search"></span></div></div></div></div></div></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.device.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.ENTITY_KEY\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=device ng-model=$ctrl.device theme=bootstrap title="Choose a entity" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.deviceSelected($item, $model)" on-remove="$ctrl.deviceRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="entityData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=entityData.provision.device.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.operationalStatus._current.value>{{ \'FORM.LABEL.OP_STATUS\' | translate }}: <span ng-bind-html="\'\'+entityData.provision.device.operationalStatus._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationsModule[0].subscription.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.ENTITY_KEY\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=device ng-model=$ctrl.device theme=bootstrap title="Choose a entity" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.deviceSelected($item, $model)" on-remove="$ctrl.deviceRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="entityData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=entityData.provision.device.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.operationalStatus._current.value>{{ \'FORM.LABEL.OP_STATUS\' | translate }}: <span ng-bind-html="\'\'+entityData.provision.device.operationalStatus._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationsModule[0].subscription.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.domain.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label for=domain class=custom-ui-select-label>{{ ($ctrl.label?$ctrl.label:\'FORM.LABEL.DOMAIN\') | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select name=domain custom-ui-select-config=$ctrl.ownConfig ng-model=$ctrl.domain theme=bootstrap title="Choose a domaion" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.domainSelected($item, $model)" on-remove="$ctrl.domainRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.DOMAIN\' | translate }}" allow-clear=true>{{$item.name}}</ui-select-match><ui-select-choices repeat="domainData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="domainData.name | highlight: $select.search"></span></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label for=domain class=custom-ui-select-label>{{ ($ctrl.label?$ctrl.label:\'FORM.LABEL.DOMAIN\') | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=domain ng-model=$ctrl.domain theme=bootstrap title="Choose a domain" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.domainSelected($item, $model)" on-remove="$ctrl.domainRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.DOMAIN\' | translate }}" allow-clear=true>{{$item.name}}</ui-select-match><ui-select-choices repeat="domainData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="domainData.name | highlight: $select.search"></span></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.entity.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="entityData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=entityData.resourceType._current.value>{{ \'FORM.LABEL.RESOURCE_TYPE\' | translate }}: <span ng-bind-html="entityData.resourceType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.asset.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.asset.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.operationalStatus._current.value>{{ \'FORM.LABEL.OP_STATUS\' | translate }}: <span ng-bind-html="\'\'+entityData.provision.device.operationalStatus._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationsModule[0].subscription.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="entityData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=entityData.resourceType._current.value>{{ \'FORM.LABEL.RESOURCE_TYPE\' | translate }}: <span ng-bind-html="entityData.resourceType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.asset.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.asset.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.operationalStatus._current.value>{{ \'FORM.LABEL.OP_STATUS\' | translate }}: <span ng-bind-html="\'\'+entityData.provision.device.operationalStatus._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationsModule[0].subscription.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationsModule[0].subscriber.specificType._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.subscriber.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate}}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="Choose a entity" allow-clear=true>{{$item.provision.subscriber.identifier._current.value}}</ui-select-match><ui-select-choices repeat="subscriberData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="subscriberData.provision.subscriber.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=subscriberData.provision.subscriber.name._current.value>Name: <span ng-bind-html="\'\'+subscriberData.provision.subscriber.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate}}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="Choose a entity" allow-clear=true>{{$item.provision.subscriber.identifier._current.value}}</ui-select-match><ui-select-choices repeat="subscriberData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="subscriberData.provision.subscriber.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=subscriberData.provision.subscriber.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+subscriberData.provision.subscriber.name._current.value | highlight: $select.search"></span></div><div ng-if=subscriberData.provision.subscriber.mobile.icc._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+subscriberData.provision.subscriber.mobile.icc.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),
e.put("custom-ui-select/views/custom.ui.select.subscription.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="Choose a entity" allow-clear=true>{{$item.provision.subscription.identifier._current.value}}</ui-select-match><ui-select-choices repeat="subscriptionData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="subscriptionData.provision.subscription.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=subscriptionData.provision.subscription.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+subscriptionData.provision.subscription.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="Choose a entity" allow-clear=true>{{$item.provision.subscription.identifier._current.value}}</ui-select-match><ui-select-choices repeat="subscriptionData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="subscriptionData.provision.subscription.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=subscriptionData.provision.subscription.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+subscriptionData.provision.subscription.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.ticket.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.TICKET\' | translate}}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.ticket theme=bootstrap title="Choose a ticket" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.ticketSelected($item, $model)" on-remove="$ctrl.ticketRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.TICKET\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="ticketData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="ticketData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=ticketData.provision.ticket.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.name._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.type._current.value>{{ \'FORM.LABEL.TYPE\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.type._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.specificType._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.status._current.value>{{ \'FORM.LABEL.STATUS\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.status._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.TICKET\' | translate}}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.ticket theme=bootstrap title="Choose a ticket" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.ticketSelected($item, $model)" on-remove="$ctrl.ticketRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.TICKET\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="ticketData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="ticketData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=ticketData.provision.ticket.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.name._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.type._current.value>{{ \'FORM.LABEL.TYPE\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.type._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.specificType._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.status._current.value>{{ \'FORM.LABEL.STATUS\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.status._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/ui.select.resourceType.html",'<div class="form-group no-margin" ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.RESOURCE_TYPE\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=resourceType ng-model=$ctrl.resourceType theme=bootstrap title="{{ \'FORM.PLACEHOLDER.RESOURCE_TYPE_MULTI\' | translate }}" custom-ui-select multiple=true on-select="$ctrl.resourceTypeSelected($item, $model)" on-remove="$ctrl.resourceTypeRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.RESOURCE_TYPE\' | translate }}" allow-clear=true>{{$item.identifier | translate}}</ui-select-match><ui-select-choices repeat="resourceType in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="resourceType.identifier | translate | highlight: $select.search"></span></div></ui-select-choices></ui-select></div><div class="form-group no-margin" ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.RESOURCE_TYPE\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=resourceType ng-model=$ctrl.resourceType theme=bootstrap title="Choose an resourceType" custom-ui-select multiple=false on-select="$ctrl.resourceTypeSelected($item, $model)" on-remove="$ctrl.resourceTypeRemove($item, $model)" ng-required=$ctrl.required><ui-select-match placeholder="{{ \'FORM.PLACEHOLDER.RESOURCE_TYPE\' | translate }}" allow-clear=true>{{$item.identifier | translate}}</ui-select-match><ui-select-choices repeat="resourceType in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="resourceType.identifier | translate | highlight: $select.search"></span></div></ui-select-choices></ui-select></div>'),e.put("helper/views/custom.ui.select.helper.html",'<div class=form-group ng-hide=$ctrl.have_helper_keys ng-transclude=input><label for={{$ctrl.id}}>{{$ctrl.labelText | translate }}<field-options required=$ctrl.required></field-options></label> <input class=form-control name={{$ctrl.name}} type=text id={{$ctrl.id}} ng-model=$ctrl.helperModel ng-required=$ctrl.required> <span class=help-inline ng-show="!$ctrl.helperModel && $ctrl.required">{{$ctrl.labelError}}</span></div><div class=form-group ng-hide=!$ctrl.have_helper_keys><label for={{$ctrl.id}}>{{$ctrl.labelText | translate }}<field-options required=$ctrl.required></field-options></label><ui-select id={{$ctrl.id}} name={{$ctrl.name}} ng-model=$ctrl.helperModel theme=bootstrap title="Choose an option" ng-required=$ctrl.required tagging=$ctrl.helperTagTransform tagging-label=false><ui-select-match placeholder="Choose an option"><span ng-if="$select.selected && $select.selected.key !== \'image\'">{{$select.selected.value}}</span> <img ng-if="$select.selected && $select.selected.key === \'image\'" src="{{ $select.selected.value }}" style=max-height:30px;></ui-select-match><ui-select-choices repeat="parameter.value as (key, parameter) in $ctrl.$helper_keys | filter: $select.search"><span ng-bind-html="parameter.key | highlight: $select.search"></span>: <small ng-if="parameter.key !== \'image\'" ng-bind-html="parameter.value | highlight: $select.search"></small> <img ng-if="parameter.key === \'image\'" src="{{ parameter.value }}" style=max-height:30px;></ui-select-choices></ui-select><span class=help-inline ng-show="!$ctrl.helperModel && $ctrl.required" translate>FORM.REQUIRED.FIELD</span></div>'),e.put("helper/views/helper.view.html",'<p class="container col-md-12 col-xs-12 input-group form-group no-margin"><span class=no-margin style=padding-left:0;padding-right:0 ng-transclude></span> <span class=input-group-btn><a class="btn btn-info btn-sm ux-txt-info pointer no-margin no-padding" ng-href ng-click=$helper.open() ng-switch=$helper.mode><span ng-switch-when=button><i ng-class=$helper.helperButton aria-hidden=true></i></span> <span ng-switch-when=title>{{$helper.helperTitle}}</span> <span ng-switch-when=title_button><i ng-class=$helper.helperButton aria-hidden=true></i>{{$helper.helperTitle}}</span> <span ng-switch-default><i ng-if="!$helper.helperTitle && !$helper.helperButton" class="fa fa-lg fa-search-plus" title="{{ \'FORM.HELPER\' | translate }}" aria-hidden=true></i></span></a></span></p><script type=text/ng-template id=helper.view.modal.html><div class="modal-header"> <h4 class="modal-title">{{ \'FORM.HELPER\' | translate }}</h4> </div> <div class="modal-body without-padding-top"> <uib-accordion close-others="true"> <div uib-accordion-group is-open="$ctrl.mapIsOpen" is-disabled="$ctrl.helper_exclusive ? !$ctrl.mapIsExclusive : false" class="map-option"> <div uib-accordion-heading>Map</div> <div class="row" ng-if="$ctrl.mapIsOpen"> <div class="col-xs-12"> <div class="form-group leaflet-container"> <leaflet id="map-marker" lf-center="$ctrl.map.center" layers="$ctrl.map.layers" controls="$ctrl.map.controls" event-broadcast="$ctrl.map.events" markers="$ctrl.map.markers" width="100% " height="300px"></leaflet> </div> </div> <div class="col-xs-12 text-right" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.map}" ng-click="$ctrl.ok(\'map\')" ng-disabled="!$ctrl.helper_keys.map"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.entityIsOpen" is-disabled="$ctrl.helper_exclusive ? !$ctrl.entityIsExclusive: false" class="entity-option"> <div uib-accordion-heading>{{ \'FORM.ENTITY\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-entity on-select-item="$ctrl.onSelectEntityKey($item, $model)" on-remove="$ctrl.onDeleteEntityKey()" entity="$ctrl.entity.selected" multiple="false"> </custom-ui-select-entity> </div> <div class="col-xs-2 vcenter" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.entity}" ng-click="$ctrl.ok(\'entity\')" ng-disabled="!$ctrl.helper_keys.entity"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.subscriberIsOpen" class="subscriber-option" is-disabled="$ctrl.helper_exclusive ? (!$ctrl.entityIsExclusive && !$ctrl.subscriberIsExclusive): false"> <div uib-accordion-heading>{{ \'FORM.SUBSCRIBERS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-subscriber on-select-item="$ctrl.onSelectSubscriberKey($item, $model)" specific-type="{{$ctrl.specific_type}}" on-remove="$ctrl.onDeleteSubscriberKey()" entity="$ctrl.subscriber.selected" multiple="false"> </custom-ui-select-subscriber> </div> <div class="col-xs-2 vcenter" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.subscriber}" ng-click="$ctrl.ok(\'subscriber\')" ng-disabled="!$ctrl.helper_keys.subscriber"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.subscriptionIsOpen" class="subscription-option" is-disabled="$ctrl.helper_exclusive ? (!$ctrl.entityIsExclusive && !$ctrl.subscriptionIsExclusive): false"> <div uib-accordion-heading>{{ \'FORM.SUBSCRIPTIONS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-subscription on-select-item="$ctrl.onSelectSubscriptionKey($item, $model)" specific-type="{{$ctrl.specific_type}}" on-remove="$ctrl.onDeleteSubscriptionKey()" entity="$ctrl.subscription.selected" multiple="false"> </custom-ui-select-subscription> </div> <div class="col-xs-2 vcenter" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.subscription}" ng-click="$ctrl.ok(\'subscription\')" ng-disabled="!$ctrl.helper_keys.subscription"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.datastreamIsOpen" is-disabled="$ctrl.helper_exclusive ? !$ctrl.datastreamIsExclusive: false" class="datastream-option"> <div uib-accordion-heading>{{ \'FORM.DATASTREAM\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-datastream on-select-item="$ctrl.onSelectDatastreamKey($item, $model)" on-remove="$ctrl.onDeleteDatastreamKey()" datastream="$ctrl.datastream.selected" multiple="false"> </custom-ui-select-datastream> </div> <div class="col-xs-2 vcenter" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.datastream}" ng-click="$ctrl.ok(\'datastream\')" ng-disabled="!$ctrl.helper_keys.datastream"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.domainIsOpen" class="domain-option" is-disabled="$ctrl.helper_exclusive ? !$ctrl.domainIsExclusive: false"> <div uib-accordion-heading>{{ \'FORM.DOMAINS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-domain on-select-item="$ctrl.onSelectDomainKey($item, $model)" on-remove="$ctrl.onDeleteDomainKey()" domain="$ctrl.domain.selected" multiple="false"> </custom-ui-select-domain> </div> <div class="col-xs-2 vcenter" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.domain}" ng-click="$ctrl.ok(\'domain\')" ng-disabled="!$ctrl.helper_keys.domain"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.areaIsOpen" class="area-option" is-disabled="$ctrl.helper_exclusive ? !$ctrl.areaIsExclusive: false"> <div uib-accordion-heading>{{ \'FORM.AREAS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-area on-select-item="$ctrl.onSelectAreaKey($item, $model)" on-remove="$ctrl.onDeleteAreaKey()" area="$ctrl.area.selected" organization="$ctrl.area.organization" multiple="false"> </custom-ui-select-area> </div> <div class="col-xs-2 vcenter" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.area}" ng-click="$ctrl.ok(\'area\')" ng-disabled="!$ctrl.helper_keys.area"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.bundleIsOpen" class="bundle-option" is-disabled="$ctrl.helper_exclusive ? !$ctrl.bundleIsExclusive: false"> <div uib-accordion-heading>{{ \'FORM.BUNDLES\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-bundle on-select-item="$ctrl.onSelectBundleKey($item, $model)" on-remove="$ctrl.onDeleteBundleKey()" bundle="$ctrl.bundle.selected" multiple="false"> </custom-ui-select-bundle> </div> <div class="col-xs-2 vcenter" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.bundle}" ng-click="$ctrl.ok(\'bundle\')" ng-disabled="!$ctrl.helper_keys.bundle"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.imageIsOpen" class="image-option" is-disabled="$ctrl.helper_exclusive ? !$ctrl.imageIsExclusive: false"> <div uib-accordion-heading>{{ \'FORM.IMAGE\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-12 col-md-8"> <div name="image" ng-if="!$ctrl.helper_keys.image && !$ctrl.helper_keys.image.image" ngf-drop="$ctrl.imageSelected($file)" ng-model="$ctrl.image" ngf-max-size="1MB" ngf-select="$ctrl.imageSelected($file)" class="drop-box pointer" ngf-drag-over-class="\'dragover\'" ngf-multiple="false" ng-required="$ctrl.helper_keys.image" ngf-accept="\'image/*\'" ngf-pattern="\'image/*\'">{{ \'FORM.DRAG_DROP\' | translate }} <br>{{ \'FORM.MAX_SIZE\' | translate }}</div> <img ng-if="$ctrl.helper_keys.image && $ctrl.helper_keys.image.image" src="{{ $ctrl.helper_keys.image.image }}" style="max-height:200px;" name="image" /> </div> <div class="col-xs-12 col-md-4"> <button id="idRemoveFileLink" ng-if="$ctrl.helper_keys.image && $ctrl.helper_keys.image.image" ng-click="$ctrl.removeDataFile()" class="btn btn-warning ux-txt-warning pointer"> <i class="fa fa-trash" aria-hidden="true"></i> {{ \'BUTTON.TITLE.REMOVE\' | translate }}</button> <a ng-if="$ctrl.helper_exclusive" class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.bundle}" ng-click="$ctrl.ok(\'bundle\')" ng-disabled="!$ctrl.helper_keys.bundle"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> </uib-accordion> </div> <div class="modal-footer"> <a ng-if="!$ctrl.helper_exclusive" class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.canApply()}" ng-click="$ctrl.ok()" ng-disabled="!$ctrl.canApply()"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> {{\'BUTTON.TITLE.ALL\' | translate }} </a> <button class="btn btn-warning" type="button" ng-click="$ctrl.cancel()">{{\'BUTTON.TITLE.CANCEL\' | translate}}</button> </div></script>'),e.put("schema-form/views/schema.form.datastream.template.html",'<div><custom-ui-select-datastream on-select-item="evalExpr(form.onselectitem, {$item: $$value$$, $model: $model})" on-remove="evalExpr(form.onremove, {$item: $$value$$, $model: $model})" datastream=$$value$$ multiple=form.multiple sf-field-model=replaceAll></custom-ui-select-datastream></div>'),e.put("schema-form/views/schema.form.entity.template.html",'<div><custom-ui-select-entity on-select-item="evalExpr(form.onselectitem, {$item: $$value$$, $model: $model})" on-remove="evalExpr(form.onremove, {$item: $$value$$, $model: $model})" entity=$$value$$ multiple=form.multiple sf-field-model=replaceAll></custom-ui-select-entity></div>'),e.put("schema-form/views/schema.form.helper.boolean.template.html","<div class=form-group><div class=checkbox><label><input type=checkbox id=$$value$$ name=$$value$$ ng-model=$$value$$ sf-field-model=replaceAll sf-changed=form ng-model-options=form.ngModelOptions schema-validate=form> <span class=checkbox-material><span class=check></span></span> <span ng-bind-html=form.title class=text-left></span></label></div><div class=help-inline sf-message=form.description ng-bind-html=form.description></div></div>"),e.put("schema-form/views/schema.form.helper.checkboxes.template.html",'<div class="{{form.schema?form.schema.htmlClass:\'\'}}"><div class=form-group sf-array=form><label>{{ form.title }}</label><br><div class=checkbox ng-if=form.titleMap ng-repeat="val in titleMapValues track by $index"><label><input type=checkbox id=$$value$$ ng-disabled=form.readonly sf-changed=form name=$$value$$ ng-model=titleMapValues[$index]> <span class=checkbox-material><span class=check></span></span> <span ng-bind-html=form.titleMap[$index].name class=text-left></span></label></div><div ng-if=form.description class=help-inline ng-bind-html=form.description></div></div></div>'),e.put("schema-form/views/schema.form.helper.datetime.template.html","<div ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false }\" class=\"form-group {{form.htmlClass}}\"><label ng-show=showTitle()>{{form.title}}</label><datetime-select id={{form.id}} name={{form.name}} ng-model=$$value$$ sf-changed=form schema-validate=form sf-field-model=replaceAll ng-disabled=form.readonly ng-required=false placeholder=\"{{form.date.placeholder }}\" mode={{form.type}} format={{form.date.format}} ng-value=form.value><div class=help-block sf-message=form.description></div></datetime-select></div>"),e.put("schema-form/views/schema.form.helper.radiobuttons.template.html",'<div class="{{form.schema?form.schema.htmlClass:\'\'}}"><div class=form-group><label for=$$value$$ ng-model=$$value$$>{{ form.title }}</label><br><div class=btn-group><label ng-repeat="data in form.titleMap track by $index" class="btn btn-sm" ng-class="{ \'btn-primary\': data.value === $$value$$, \'btn-default\': data.value !== $$value$$ }" sf-field-model=replaceAll><input type=radio id=$$value$$ name=$$value$$ ng-model=$$value$$ sf-field-model=replaceAll ng-value=data.value style=display:none; sf-changed=form> <span ng-bind-html=data.name class=text-left></span></label></div><div ng-if=form.description class=help-inline ng-bind-html=form.description></div></div></div>'),e.put("schema-form/views/schema.form.helper.radios.template.html",'<div class="{{form.schema?form.schema.htmlClass:\'\'}}"><div class=form-group><label for={{$$value$$}} ng-model=$$value$$>{{ form.title }}</label><br><div class="radio radio-primary" ng-if=form.titleMap ng-repeat="data in form.titleMap track by $index"><label><input type=radio id=$$value$$ name=$$value$$ ng-model=$$value$$ sf-field-model=replaceAll value={{data.value}} sf-changed=form ng-disabled=form.readonly schema-validate=form ng-model-options=form.ngModelOptions> <span class=circle></span> <span class=check></span><p ng-bind-html=data.name class=text-left></p></label></div><div ng-if=form.description class=help-inline ng-bind-html=form.description></div></div></div>'),e.put("schema-form/views/schema.form.helper.radiosinline.template.html",'<div class="{{form.schema?form.schema.htmlClass:\'\'}}"><div class=form-group><label for={{$$value$$}} ng-model=$$value$$ sf-field-model=replaceAll>{{ form.title }}</label><br><div class="radio radio-primary" ng-if=form.titleMap ng-repeat="data in form.titleMap track by $index" style="display: inline;"><label><input type=radio id="{{$$value$$ + \'_\' + $index}}" name={{$$value$$}} ng-model=$$value$$ sf-field-model=replaceAll value={{data.value}} sf-changed=form ng-disabled=form.readonly schema-validate=form ng-model-options=form.ngModelOptions> <span class=circle></span> <span class=check></span><p ng-bind-html=data.name class=text-left></p></label></div><div ng-if=form.description class=help-inline ng-bind-html=form.description></div></div></div>'),e.put("schema-form/views/schema.form.helper.template.html","<div class=\"{{form.schema?form.schema.htmlClass:''}}\"><div class=form-group><helper-dialog helper-id={{form.helperid}} helper-exclusive={{form.exclusive}}><helper-ui-select id={{form.id}} name={{form.name}} label-text={{form.title}} helper-model=$$value$$ sf-field-model=replaceAll label-error={{form.labelerror}}><helper-ui-select-input><label for={{form.name}}>{{form.title}}</label> <input class=form-control name={{form.name}} type=text id={{form.id}} ng-model=$$value$$ sf-field-model=replaceAll></helper-ui-select-input></helper-ui-select></helper-dialog></div></div>"),e.put("window-time-select/views/datetime.select.view.html",'<p class="datetime-container input-group form-group no-margin"><input readonly type=text class="form-control text-left no-margin" ng-model=rawdata ng-required=required ng-disabled=ngDisabled button-bar=customButtonBar ng-click=openCalendar() datetime-picker={{visibleFormat}} is-open=calendarOpen datepicker-options=pickerOptions.datePicker timepicker-options=pickerOptions.timePicker popup-placement="auto top-right" enable-date=enableDate enable-time=enableTime datepicker-append-to-body=false placeholder={{placeholder}}> <span class=input-group-btn><button class="btn btn-default no-padding fa" ng-class="{\'fa-calendar\' : enableDate, \'fa-clock-o\' : !enableDate && enableTime}" ng-click=openCalendar() aria-hidden=true></button></span></p>'),e.put("window-time-select/views/window-time.select.view.html",'<div permission permission-only="\'viewFilter\'" class=window-time-container><button type=button class="btn btn-xs" ng-class=oneDayClass ng-click=oneDay() translate>BUTTON.TITLE.LAST_DAY</button> <button type=button class="btn btn-xs" ng-class=oneWeekClass ng-click=oneWeek() translate=BUTTON.TITLE.LAST_NUMBER_DAY translate-values="{ number: \'7\' }"></button> <button type=button class="btn btn-xs" ng-class=oneMonthClass ng-click=oneMonth() translate=BUTTON.TITLE.LAST_NUMBER_DAY translate-values="{ number: \'30\' }"></button> <button type=button class="btn btn-xs" ng-class=customClass ng-click=custom() translate>BUTTON.TITLE.CUSTOM</button> <button type=button class="btn btn-xs btn-info" ng-if=filterApplied ng-click=clear() translate>BUTTON.TITLE.CLEAR</button><div ng-if=customEnabled class="window-time-body panel panel-body"><div class=col-xs-12><div class=row><div class="col-xs-6 text-left"><label translate>BUTTON.TITLE.CUSTOM</label></div><div class="col-xs-6 text-right"><button type=button class="btn btn-xs oux-button-margin btn-success" ng-disabled="!!errorCustomWindow || fromCalendarOpen || toCalendarOpen" ng-click=applyCustom() translate>BUTTON.TITLE.APPLY</button></div></div><div class=row><div class="col-xs-12 col-md-2 text-left"><label class=control-label><i class="fa fa-calendar" aria-hidden=true></i> {{ \'FORM.LABEL.FROM\' | translate }}: {{fromDate | date:\'fullDate\'}}</label></div><div class="col-xs-12 col-md-4"><input readonly type=text class="form-control text-left no-margin" ng-model=date.from button-bar=customButtonBar ng-click=openCalendarFrom() ng-required=true datetime-picker={{format}} is-open=fromCalendarOpen datepicker-options=fromOptions.datePicker timepicker-options=fromOptions.timePicker when-closed=fromChange(args) popup-placement="auto top-right" datepicker-append-to-body=true></div><div class="col-xs-12 col-md-2 text-left"><label class=control-label><i class="fa fa-calendar" aria-hidden=true></i> {{ \'FORM.LABEL.TO\' | translate }}: {{fromDate | date:\'fullDate\'}}</label></div><div class="col-xs-12 col-md-4"><input readonly type=text class="form-control text-left no-margin" ng-model=date.to button-bar=customButtonBar ng-click=openCalendarTo() ng-required=true datetime-picker={{format}} is-open=toCalendarOpen datepicker-options=toOptions.datePicker timepicker-options=toOptions.timePicker when-closed=toChange(args) popup-placement="auto top-right" datepicker-append-to-body=true></div></div></div><alert type=danger ng-show=errorCustomWindow class=text-danger style="display: block;text-align: center;"><span ng-bind=errorCustomWindow></span></alert></div></div>')}]),angular.module("uxleaflet").constant("defaultMapOptions",{l_gohome:{center:[40.4,-3.7],zoom:5},l_fullscreen:{position:"topleft"},l_placefinder:{text:"Place name or coordinates"},l_print:{title:"Print current map view",position:"topleft"},l_minimap:{layer:"$main",toggleDisplay:!0},l_search:{placeholder:"Enter device ID",timeAutoclose:2e3},l_boxselection:localStorage.testselection&&{position:"topleft"},l_measure:!1,l_mouseposition:{position:"bottomleft",numDigits:4},l_scale:!1,l_magnifying:{scale:3,radius:180},l_localtiles:!1,baseLayers:["osm","dark2","ogWorld","googleTerrain","googleHybrid","googleRoadmap","googleSatellite"],baseLayerDefault:"osm",overlays:{},mapOptions:{editPointSize:10}}).constant("allNgBaseLayers",{osm:{name:"OpenStreetMap",url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz",layerParams:{attribution:"OpenStreet Map",maxZoom:19,subdomains:["a","b","c"]}},dark2:{name:"Dark Map",url:"//{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",layerParams:{attribution:"Cartocdn Dark Map",maxZoom:19},type:"xyz"},ogWorld:{name:"OpenGate Maps",url:"//maps.opengate.es/osm_tiles/{z}/{x}/{y}.png",layerParams:{attribution:"OpenGate Maps",maxZoom:19},type:"xyz"},googleTerrain:{name:"Google Terrain",layerType:"TERRAIN",type:"google"},googleHybrid:{name:"Google Hybrid",layerType:"HYBRID",type:"google"},googleRoadmap:{name:"Google Streets",layerType:"ROADMAP",type:"google"},googleSatellite:{name:"Google Satellite",layerType:"SATELLITE",type:"google"}}).run(["$http","allNgBaseLayers","defaultMapOptions",function(e,t,i){e.get("//a.tile.openstreetmap.org/0/0/0.png").error(function(e){delete t.osm,i.baseLayers.splice(i.baseLayers.indexOf("osm"),1)}),e.get("//a.basemaps.cartocdn.com/dark_all/0/0/0.png").error(function(e){delete t.dark2,i.baseLayers.splice(i.baseLayers.indexOf("dark2"),1)}),e.get("//maps.opengate.es/osm_tiles/0/0/0.png").error(function(e){delete t.ogWorld,i.baseLayers.splice(i.baseLayers.indexOf("ogWorld"),1)})}]).service("mapUxService",["$timeout","leafletData","mapExtraApiService","geomUxService","defaultMapOptions","allNgBaseLayers",function(i,a,o,n,r,s){function l(e,t,i){var a;if(e.split){var o=e,n=o.split(":");if("local"===n[0]){var r=n[1],s=n[2]||"Local "+r;a={name:s,url:"file://_$local_"+r+"_{z}/{x}/{y}.png",type:"xyz",layerParams:{attribution:"",maxZoom:19}}}else{if(!t[o])throw"Not found baseLayer name "+o;a=angular.extend({},t[o])}}else a=angular.extend({},e);return e===i&&(a.visible=!0),a}function c(i,a){var o=i;if("string"==typeof i){var n=i,r=n.split(".");o=e;for(var s="window",l=0;l<r.length;l++){var c=r[l];if(o[c]===t)throw"Not found "+c+" in "+s;s=s+"."+c,o=o[c]}}try{var d=new o(a);if(d instanceof L.Control)return d;console.warn(i+" instance do not appears as L.Control")}catch(u){var p=JSON.stringify(a);throw new Error("Error instantiating "+i+" with "+p,u)}}function d(e){var t=f.getAllBaseLayerConfigs(),i=t[e]||t.osm||t.dark2||t.ogWorld||t.googleTerrain||t.googleHybrid||t.googleRoadmap||t.googleSatellite;if("xyz"===i.type){var a=new L.TileLayer(i.url,i.options||i.layerParams);return a}throw"not implemented tilelayer creation from "+JSON.stringify(i)}function u(e){function t(e,t){for(var a in t){var o=t[a];if(o.addTo)try{o.addTo(e),i.controls.push(o);var n=o._controlName;
n&&!i[n]&&(i[n]=o)}catch(r){console.error("INTERNAL ERROR adding control to map ",r)}}angular.element(e._container).find(".leaflet-control-layers").addClass("navbar navbar-primary")}var i=this;this.controls=[],this.initControls=function(i,a){var o=(f.getBaseLayerConfigs(i),f._createMapControls(i,a));f.getMap(e,function(e){t(e,o)})},this.toggleFullscreen=function(){f.getMap(e,function(e){e.toggleFullscreen({})})}}function p(e,t){try{for(var i in e.controls.custom){var a=e.controls.custom[i];a._isGohomeInstance&&a.changeTargetViewToBounds(t)}}catch(o){console.error("Error zooming to bounds "+t,o)}}var h=this,f=this;this.createMapManager=function(e){if(!e||!e.$id)throw"Invalid angular scope";return new u(e)},h.getMapId=function(e,i){var a=i===t?"":"-"+i;return"map-"+e.$id+a},h.getMap=function(e,t,i){var a=this.getMapId(e,i);h.getMapWithId(a,t,e)},h.getMapWithId=function(e,t,o){a.getMap(e).then(function(e){e.setNgScope&&e.setNgScope(o),i(function(){t(e)})})},h.mapOn=function(e,t,i){var a=h.getMapId(e);e.$on("leafletDirectiveMap.{{ vm.id }}."+t,function(e){if(e.currentScope.vm.id===a)try{i(e)}catch(t){}})},h.getDefaultOptions=function(e){return angular.extend({},r,e||{})},h.createNgOptions=function(e,t){e=e||r,t=t||{};var i=e.l_gohome?e.l_gohome:null,a={center:i?{lat:i.center[0],lng:i.center[1],zoom:i.zoom}:{lat:40,lng:-3.7,zoom:5},layers:{baselayers:this.getBaseLayerConfigs(e),overlays:e.overlays||{}},controls:this.createControlConfigs(e,t),"default":e.mapOptions};return a},h.getAllBaseLayerConfigs=function(){return s},h.getBaseLayerConfigByName=function(e){var t=h.getAllBaseLayerConfigs(),i=null;return angular.forEach(t,function(t,a){i||t.name!==e||(i=t,i.identifier=a)}),i},h.getBaseLayerConfigs=function(e){var t=e.baseLayers,i=e.baseLayerDefault||"",a=this.getAllBaseLayerConfigs(),o={},n=[];if(i){for(var r=0;r<t.length;r++){var s=t[r],c=s instanceof Object?s.id||"layer_"+r:s;try{i===c&&(o[c]=l(s,a,i))}catch(d){n.push(s)}}for(var r=0;r<t.length;r++){var s=t[r],c=s instanceof Object?s.id||"layer_"+r:s;try{i!==c&&(o[c]=l(s,a,i))}catch(d){n.push(s)}}}else for(var r=0;r<t.length;r++){var s=t[r],c=s instanceof Object?s.id||"layer_"+r:s;try{o[c]=l(s,a,i)}catch(d){n.push(s)}}if(n.length>0){var u="Not found basemaps: ["+n.join(", ")+"]. available names: ["+this.getAllBaseLayerConfigNames().join(", ")+"]";console.error(u,"")}return o},h.getAllBaseLayerConfigNames=function(){var e=h.getAllBaseLayerConfigs(),t=[];for(var i in e)t.push(i);return t},h.createControlConfigs=function(e,t){var i={};return e.l_scale&&(i.scale=e.l_scale),i.custom=h.createCustomWidgets(e,t),angular.forEach(e.apikeys,function(e,t){o.setApikey(t,e)}),i},h._createMapControls=function(e,t){var i=this.createCustomWidgets(e,t);return i},h.createCustomWidgets=function(e,t){var i={l_fullscreen:{_controlName:"fullscreenControl",_desc:"Control for set current view mode in fullscreen",constructor:"L.Control.Fullscreen",defaultOpts:{position:"topleft"}},l_minimap:{_controlName:"minimapControl",_desc:"Control for showing a minimap guide in a corner of main map",constructor:null,defaultOpts:{layer:{url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{}},position:"bottomright",toggleDisplay:!0,autoToggleDisplay:!0,minimized:!0,width:100,height:100,strings:{hideText:"Hide Mini Map asdfasdfasdf",showText:"Show Mini Map"}},createControlInstance:function(e){var t,i=e.layer;return t="string"==typeof i?d(i):new L.TileLayer(i.url,i.options),new L.Control.MiniMap(t,e)}},l_mouseposition:{_controlName:"geolocationControl",_desc:"Control for showing current mouse location in lat/lon",constructor:L.Control.MousePosition,defaultOpts:{position:"bottomleft"}},"l_placefinder-google":{_controlName:"googleplacefinderControl",_desc:"Control for Search GeoLocation using external WebService (bower:leaflet-google-places-autocomplete)",constructor:L.Control.GPlaceAutocomplete2,defaultOpts:{searchCall:t&&t.placefinderCb||function(){},placeholder:"Enter place name",text:"Enter place name",position:"topleft"},dependencies:["google"]},"l_placefinder-esri":{_controlName:"esriplacefinderControl",_desc:"Control for Search ... ESRI",constructor:L.Control.PlaceFinderEsri,defaultOpts:{providerName:["arcgisOnlineProvider","mapServiceProvider"],layers:[2,3],searchFields:["NAME","STATE_NAME"]}},"l_placefinder-osm":{_controlName:"osmplacefinderControl",_desc:"Control for Search using OSM/Nominatim",constructor:L.Control.OsmPlaceFinder,defaultOpts:{placeholder:"Enter place name",text:"Enter place name",position:"topleft",forcePosition:"c√≥mo lo hace googleplacefinderControl???"}},l_placefinder:"pending to assign",l_search:{_controlName:"searchControl",_desc:"Control for Search internal features in map",constructor:L.Control.Search,defaultOpts:{searchCall:t.searchCb||function(){console.warn("NOT entitiesCacheCallback setter in l_search")},position:"topright",placeholder:"search",timeAutoclose:2400,textErr:"Device not found"}},l_measure:{_desc:"Control for distance measure in map",constructor:"L.Control.Measure",defaultOpts:{primaryLengthUnit:"kilometers",secondaryLengthUnit:"meters",primaryAreaUnit:"hectares",secondaryAreaUnit:"sqmeters",position:"bottomleft"},_bower:"'leaflet-measure ': '^ 2.1.5'"},l_boxselection:{_controlName:"boxselectionControl",_desc:"Control for select features using mouse bounding box",constructor:L.Control.FeatureSelection,defaultOpts:{position:"topleft"}},l_gohome:{_controlName:"gohomeControl",_desc:"Control for Pan/zoom to original position",constructor:L.Control.Gohome,defaultOpts:{center:[0,0],zoom:4,position:"topleft"},_bower:!1},l_print:{_controlName:"printoutControl",_desc:"Control for print out current map view",constructor:L.Control.EasyPrint,defaultOpts:{title:"Print map",position:"topleft",elementsToHide:"p, h2"},_bower:!1},l_magnifying:{_controlName:"magnifyingControl",_desc:"Control for magnify cursor area on map view",constructor:L.Control.MagnifyingGlass,defaultOpts:{title:"Magnifying glass",position:"topleft"},_bower:!1},l_localtiles:{_controlName:"localtilesControl",_desc:"Control for reset/load base tiles for offline navigation",constructor:L.Control.LocalTileControl,defaultOpts:{position:"topright"},_bower:!1}};i.l_placefinder=i["l_placefinder-osm"];var a=[];for(var o in i){var n=i[o],r=e[o];if(n&&r){var s=o+" "+n._desc;try{var l,u=$.extend(n.defaultOpts,r);l=n.constructor?c(n.constructor,u):n.createControlInstance(u),l._controlName||(l._controlName=n._controlName),a.push(l),console.debug("Created plugin: "+o+" "+s)}catch(p){console.error("INTERNAL ERROR loading leaflet plugin: "+s,p)}}}return a},h.createOverlaysConfig=function(e){if(console.debug("createOverlaysConfig no implementado. Solo funciona  options='demo'"),"demo"===e)return{wms:{name:"EEUU States (WMS)",type:"wms",visible:!0,url:"http://suite.opengeo.org/geoserver/usa/wms",layerParams:{layers:"usa:states",format:"image/png",transparent:!0}}}},h.tryChangeGohomeOptions=p,h.loadGeoJsonFromFile=function(e,t){var i=e?e.name:"null",a=new FileReader;a.onload=function(){try{var e=a.result;t(h.validateGeoJsonContent(e))}catch(o){t(null,new Error("No valid GeoJson file: ["+i+"]\n"+o),null)}};try{a.readAsText(e)}catch(o){t(new Error("Invalid "+i+"\n"+o.message),null)}},h.validateGeoJsonContent=function(e){var t;try{t=JSON.parse(e)}catch(i){throw"Invalid JSON data"}if("object"!=typeof t)throw"Invalid GeoJSON. Expected JSON format";if("FeatureCollection"!==t.type)throw"Invalid GeoJSON. Expected {type:'FeatureCollection'...";var a=t.features;if(!angular.isArray(a))throw"Invalid GeoJSON. Expected {features:[...]...";return t},h.enableRightClickToZoom=function(e,t){function i(){t.showClickMessage=!1,t.$apply()}e.scrollWheelZoom.disable();var a;e.on("fullscreenchange",function(t){t.target._isFullscreen?e.scrollWheelZoom.enable():e.scrollWheelZoom.disable()}),e.on("contextmenu",function(i){t.showClickMessage=!1,e.scrollWheelZoom.enable()}),e.on("click",function(i){t.showClickMessage=!1,e.scrollWheelZoom.enable()}),e.on("mouseout",function(t){e.scrollWheelZoom.disable(),a&&clearTimeout(a),a=setTimeout(i,2e3)}),e.on("blur",function(t){e.scrollWheelZoom.disable(),a&&clearTimeout(a),a=setTimeout(i,2e3)}),e.on("mousemove",function(o){o.target._isFullscreen?e.scrollWheelZoom._enabled||e.scrollWheelZoom.enable():e.scrollWheelZoom._enabled||(t.showClickMessage=!0,a&&clearTimeout(a),a=setTimeout(i,2e3))})},h.circleToPolygon=n.circleToPolygon,h.createVectorLayer=n.createVectorLayer}]),angular.module("uxleaflet").service("mapUxGeoJsonService",["$window","jsonPath","$api","$http","$timeout","mapUxService","mapMarkerService","$oguxThemes",function(e,i,a,o,n,r,s,l){function c(e,t,i){i=i||{};try{var a=u(t);d(a.features);var o=new v(e,a,i);return o}catch(n){throw"invalid data as geojson content. "+n.message}}function d(e){e=Array.isArray(e)?e:[e];var t="#ff6600";try{t=l.getColorFromThemeComposition().sample}catch(i){console.error("WARN: Fail recovering theme from oguxThemes",i)}for(var a=0;a<e.length;a++){var o=e[a];try{var n=o.properties=o.properties||{};if(n.name=n.name||"no-name",n.name){var r="";r+="<div><span class='text-primary'>"+(n.name||"")+"</span><br>"+(n.description||"")+"</div>",n.popupContent=r}n["fill-opacity"]=.2,n.stroke="#555555",n["stroke-width"]=1,n["stroke-opacity"]=1,n.fill=t}catch(i){console.error("Error replacing properties on feature ",o,i)}}}function u(e){if(e&&e.features&&"string"==typeof e.type)return e;if(e.startsWith("<!"))throw"Not found geojson file.";try{var t=JSON.parse(e);if("string"!=typeof t.type)throw"invalid geojson. Expected type property as string";return t}catch(i){throw"invalid geojson. Expected JSON "+i.message}}function p(e,i){return e!==t?e:i}function h(e){return{radius:p(e.radius||12),fillColor:p(e.fill,"#ff7800"),color:p(e.stroke,"#ff0000"),weight:p(e["stroke-weight"],1),opacity:p(e["stroke-opacity"],.8),fillOpacity:p(e["fill-opacity"],.2),popupContent:e.popupContent}}function f(e,t){var i=e?e.name:"null",a=new FileReader;a.onload=function(){try{var e=a.result;m(e),t(null,e)}catch(o){t(new Error("No valid GeoJson file: ["+i+"]\n"+o),null)}};try{a.readAsText(e)}catch(o){t(new Error("Invalid "+i+"\n"+o.message),null)}}function m(e){var t;try{t=JSON.parse(e)}catch(i){throw"Invalid JSON data"}if("object"!=typeof t)throw"Invalid GeoJSON. Expected JSON format";if("FeatureCollection"!==t.type)throw"Invalid GeoJSON. Expected {type:'FeatureCollection'...";var a=t.features;if("[object Array]"!==Object.prototype.toString.call(a))throw"Invalid GeoJSON. Expected {features:[...]..."}function g(e){var t=e;if("string"==typeof e)e=JSON.parse(e);else if("object"!=typeof e)throw new Error("geojson is required as object or string. Nor valid "+t);if(!e||!e.type)throw new Error("Invalid geojson object ",t);var i=y[e.type];if(!i)throw new Error("Invalid geojson type "+e.type);return"geometry"===i?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]}:"feature"===i?{type:"FeatureCollection",features:[e]}:"featurecollection"===i?e:void 0}function v(e,i,a){function o(e){var t=e.layer.toGeoJSON?e.layer.toGeoJSON():"";console.info("map-ux-geojson-service: commited feature. Action: "+e.action,t)}var n=this,r={radius:12,fillColor:"#ff7800",color:"#000",weight:1,opacity:1,fillOpacity:.2,aweMarkerCss:"hand-o-down",onFeatureCommited:o};this._map=e,this._uxEditionControl=null,this.options=L.extend({},r,a),this.layer=L.geoJson(i,{style:this.options.style||function(e){if(e.properties){var t=h(e.properties);return t}return{color:"#ff8800"}},onEachFeature:this.options.onEachFeature||function(e,t){e.properties&&e.properties.popupContent&&t.bindPopup(e.properties.popupContent)},pointToLayer:this.options.pointToLayer||function(e,t){var i=n.options.aweMarkerCss,a=s.createMarker(e,t,{defaultAweSymbol:i});return a},filter:this.options.filter||function(e,t){return!0}}),this.setEditionMode=function(e){var i=this._map;if(!i)throw"Error. No has Map associated to this GeoJson Manager";e?(this._uxEditionControl=new L.Control.UxEdition({position:"topright",onFeatureCommited:this.options.onFeatureCommited}),this._uxEditionControl.addTo(i),this._uxEditionControl.setLayer(this.layer._layers)):this._uxEditionControl&&(this._uxEditionControl.setLayer(t),i.removeControl(this._uxEditionControl),delete this._uxEditionControl);try{for(var a in this.layer._layers){var o=this.layer._layers[a];e?o.enableEdit&&o.enableEdit(i):o.disableEdit&&o.disableEdit()}}catch(n){console.error("Error interno habilitando edici√≥n de geometr√≠as GeoJSON",n)}},this.layersToGeoJson=function(){var e=[];for(var t in this.layer._layers){var i=this.layer._layers[t];try{i.editor.commitDrawing();var a=i.toGeoJSON();e.push(a)}catch(o){console.error(" Layer can be converted to feature: ",o)}}var n={type:"FeatureCollection",features:e,lastEdition:(new Date).toISOString()},r=JSON.stringify(n);return r}}this.createLayerManager=c,this.loadGeoJsonFromFile=f,this.normalizeGeoJson=g;var y={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}}]),angular.module("uxleaflet").service("mapEsriService",["$window","jsonPath","$api","mapUxService",function(e,t,i,a){console.info("TESTING l_placefinder_esri");var o=t("L.esri.Geocoding.Geosearch");o&&console.warn("Error not found L.esri.Geocoding.Geosearch "),L.Control.PlaceFinderEsri=o.extend({initialize:function(e){var t={providers:[L.esri.Geocoding.arcgisOnlineProvider(),L.esri.Geocoding.mapServiceProvider({label:"States and Counties",url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/Census/MapServer",layers:e.layers,searchFields:e.searchFields})]};o.prototype.initialize.call(this,t)},_buildContainer:function(e){o.prototype._buildContainer.call(this,e)},addTo:function(e){o.prototype.addTo.call(this,e)}})}]),angular.module("uxleaflet").service("mapExtraApiService",function(){function t(e,t){o[e]?o[e].apikey=t:console.warn("WARN: 'setApiKey'. Not found ApiName: "+e)}function i(t){for(var i=!0,a=0;a<t.length;a++)for(var o=t[a],n=o.split("."),r=e,s=0;s<n.length&&(i=i&&r[n[s]],i);s++);return i}function a(t,a,n){function r(){l.isApikeyRequired&&!l.apikey?e.setTimeout(r,1e3):(d.src=l.getUrl(),document.getElementsByTagName("head")[0].appendChild(d))}function s(e,t,i){if(e&&e.call)try{e(t,i)}catch(t){console.error("callback error: ",t)}}var l=o[t];l||(console.warn("not found known EXT_API as: "+t),s(n,new Error("not found known EXT_API as: "+t),null));var c=i(a);if(c)return void s(n,null,e[t]);if("fail"===l.status)return void s(n,new Error("not found API for "+t),null);if("loading"!==l.status){l.status="loading";var d=document.createElement("script");d.type="text/javascript",d.readyState?d.onreadystatechange=function(){"loaded"!==d.readyState&&"complete"!==d.readyState||(l.status="ok",d.onreadystatechange=null,s(n,null,e[t]))}:d.onload=function(){l.status="ok",s(n,null,e[t])},r()}else var u=e.setInterval(function(){"loading"!==l.status&&(e.clearInterval(u),"ok"===l.status?s(n,null,e[t]):"fail"===l.status&&s(n,new Error("not found API for "+t),null))})}this.ensureLib=a,this.setApikey=t,L.extraApi={},L.extraApi.ensureLib=this.ensureLib=a,L.extraApi.setApikey=this.setApikey=t;var o={google:{apikey:null,isApikeyRequired:!0,options:{libraries:"drawing,places"},getUrl:function(){this.options.libraries?"&libraries="+this.options.libraries:"";return"https://maps.google.com/maps/api/js?v=3.20&libraries=drawing,places&key="+this.apikey},status:null},esri:{apikey:"",getUrl:function(){return"https://unpkg.com/esri-leaflet@2.0.8"},status:null},osm:{apikey:"",getUrl:function(){return"https://openstreetmap.org/aaaaaaaaaaaaa"},status:null},mapquest:{apikey:"",getUrl:function(){return"https://maquest.com/aaaaaaaaaaaa"},status:null}}}),angular.module("uxleaflet").service("geomUxService",["$timeout",function(e){function i(e){return e*Math.PI/180}function a(e){return 180*e/Math.PI}function o(e,t,o){var n=i(e[1]),r=i(e[0]),s=t/6378137,l=Math.asin(Math.sin(n)*Math.cos(s)+Math.cos(n)*Math.sin(s)*Math.cos(o)),c=r+Math.atan2(Math.sin(o)*Math.sin(s)*Math.cos(n),Math.cos(s)-Math.sin(n)*Math.sin(l));return[a(c),a(l)]}function n(e,t,i){for(var a=i?i:32,n=[],r=0;r<a;r+=1)n.push(o(e,t,2*Math.PI*r/a));return n.push(n[0]),{type:"Polygon",coordinates:[n]}}function r(e,t){var i=1e-7;if(!e||!t)return!1;var a=1*e/t,o=Math.abs(1-a);return o<i}function s(e){var i,a=40075017/360,o=e.coordinates[0]||[],n=L.bounds(o),s=n.getCenter(),l=n.getSize(),c=l.y/2*a;if("Polygon"===e.type){var d=50;if(o.length>=d){i=!0;var u=new L.LatLng(s.y,s.x);for(var p in o){var h=o[p],f=new L.LatLng(h[1],h[0]),m=u.distanceTo(f);if(!m||!r(c,m)){i=!1;break}}}else i=!1}else i=!1;var g;if(i===!1){var v=L.geoJson(e,{onEachFeature:function(e,t){e.properties||(e.properties={})}});g=v.getLayers()[0]}else{var y=s.lat!==t?s.lat:s.y,b=s.lng!==t?s.lng:s.x;g=L.circle([y,b],c)}return g}var l=this;l.circleToPolygon=n,l.createVectorLayer=s}]),angular.module("uxleaflet").service("geocodingService",i),i.$inject=["$http"],angular.module("uxleaflet-directive",[]).directive("uxleaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletMapEvents",a]),angular.module("ui-leaflet").directive("decopaths",["$log","leafletHelpers",function(e,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(i,a,o,n){function r(t){return d(t)&&d(t.coordinates)&&(c.isLoaded()||e.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(t.coordinates)}function s(e,t){if(d(e)&&d(t)&&d(t.coordinates)&&d(t.patterns))return e.setPaths(t.coordinates),e.setPatterns(t.patterns),e}var l=n.getLeafletScope(),c=t.PolylineDecoratorPlugin,d=t.isDefined,u={};n.getMap().then(function(e){l.$watch("decopaths",function(t){console.debug("Pendiente implementar aqu√≠: decopaths");for(var i in u)d(t[i])&&angular.equals(t[i],u)||(e.removeLayer(u[i]),delete u[i]);for(var a in t){var o=t[a],n=r(o);d(n)&&(u[a]=n,e.addLayer(n),s(n,o))}},!0)})}}}]),angular.module("opengate-angular-js").directive("windowTimeSelect",function(){return{restrict:"AE",templateUrl:"window-time-select/views/window-time.select.view.html",scope:{event:"@",rawdate:"@"},controller:["$scope","$element","$attrs","$translate",function(i,a,o,n){function r(){return e.moment(i.date.from).add(1,"minutes")._d}function s(){return e.moment(i.date.to).subtract(1,"minutes")._d}function l(){return e.moment(i.date.to).subtract(1,"months")._d}function c(e){i.date||(i.date={}),i.date.to=e,i.toMax=e,i.toOptions={datePicker:{startingDay:1,showWeeks:!1,minDate:i.toMin,minMode:"day",closed:i.toChange},timePicker:{showMeridian:!1}}}function d(){i.date.from=l(i.date.to),i.toOptions.datePicker.minDate=r(),i.toMin=r(),i.fromMax=s(i.date.to),i.fromOptions={datePicker:{startingDay:1,showWeeks:!1,maxDate:i.fromMax,maxMode:"day",closed:i.fromChange},timePicker:{showMeridian:!1}}}function u(t){var i=e.moment().subtract(1,t);return{from:i._d,type:t}}i.fromCalendarOpen=!1,i.toCalendarOpen=!1,i.customButtonBar={show:!0,now:{show:!1},today:{show:!1},clear:{show:!1},date:{show:!0,text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-calendar"},time:{show:!0,text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-clock-o"},close:{show:!0,text:" ",cls:"btn-sm btn-success oux-button-margin fa fa-check"},cancel:{show:!1}},i.oneDayClass=i.oneWeekClass=i.oneMonthClass=i.customClass="btn-info",i.filterApplied=!1,i.format="dd MMMM yyyy HH:mm",i.clear=function(){i.oneDayClass=i.oneWeekClass=i.oneMonthClass=i.customClass="btn-info",i.filterApplied=!1,i.customEnabled=!1,i.$emit("onWindowTimeChanged",{})},i.fromOpen=function(){i.fromPopup.opened=!0},i.fromPopup={opened:!1},i.toOpen=function(){i.toPopup.opened=!0},i.toPopup={opened:!1},i.openCalendarFrom=function(){i.fromCalendarOpen=!0},i.openCalendarTo=function(){i.toCalendarOpen=!0},i.custom=function(){i.customEnabled&&(i.fromCalendarOpen||i.toCalendarOpen)||(i.customEnabled=!i.customEnabled)},i.apply=function(t,a){if(i.filterApplied=!0,i.customEnabled=!1,!e.eval(i.rawdate)){for(var o in t)"type"!==o&&"rawdate"!==o&&(t[o]=e.moment(t[o]).format());t.rawdate=!1}a&&i.$emit("onWindowTimeChanged",t)},i.oneDay=function(e){i.oneDayClass="btn-success",i.oneWeekClass=i.oneMonthClass=i.customClass="btn-info",i.apply(u("days"),!e)},i.oneWeek=function(e){i.oneWeekClass="btn-success",i.oneDayClass=i.oneMonthClass=i.customClass="btn-info",i.apply(u("weeks"),!e)},i.oneMonth=function(e){i.oneMonthClass="btn-success",i.oneWeekClass=i.oneDayClass=i.customClass="btn-info",i.apply(u("months"),!e)},i.applyCustom=function(e){i.fromCalendarOpen?i.fromChange():i.toCalendarOpen?i.toChange():(i.fromCalendarOpen=!1,i.toCalendarOpen=!1,i.customClass="btn-success",i.oneWeekClass=i.oneDayClass=i.oneMonthClass="btn-info",i.apply({type:"custom",to:i.date.to,from:i.date.from},!e))},i.init=function(){function a(){e.moment(i.date.to).diff(i.date.from)<=0?i.errorCustomWindow="From date("+i.date.from.toISOString()+") is bigger than to date("+i.date.to.toISOString()+")":i.errorCustomWindow=t}if(c(new Date),d(),i.toChange=function(){a(),i.fromMax=s(i.date.to),i.fromOptions.datePicker.maxDate=i.fromMax,i.toCalendarOpen=!1},i.fromChange=function(){a(),i.toOptions.datePicker.minDate=r(),i.toMin=r(),i.fromCalendarOpen=!1},i.$parent.config&&i.$parent.config.windowFilter){var o=i.$parent.config.windowFilter;switch(e.eval(i.rawdate)||(i.$parent.config.windowFilter.rawdate=!1),o.type){case"days":i.oneDay(!0);break;case"weeks":i.oneWeek(!0);break;case"months":i.oneMonth(!0);break;case"custom":o.to&&o.from&&(i.date.to=new Date(o.to),i.date.from=new Date(o.from)),i.applyCustom(!0)}}},i.init()}]}}),angular.module("opengate-angular-js").directive("datetimeSelect",function(){return{restrict:"AE",templateUrl:"window-time-select/views/datetime.select.view.html",scope:{ngModel:"=",ngValue:"=",ngRequired:"=",placeholder:"@",format:"@",mode:"@"},controller:["$scope","$element","$attrs","$translate","uibDateParser",function(e,i,a,o,n){e.mode&&"date-time"!==e.mode?e.inputMode=e.mode:e.inputMode="datetime",e.required=!!e.ngRequired&&!!e.ngRequired,e.calendarOpen=!1,e.enableDate=!e.inputMode||"datetime"===e.inputMode||"date"===e.inputMode,e.enableTime=e.inputMode&&("datetime"===e.inputMode||"time"===e.inputMode),e.format?e.visibleFormat=e.format:e.enableDate&&!e.enableTime?(e.format="yyyy-MM-dd",e.visibleFormat="dd MMMM yyyy"):!e.enableDate&&e.enableTime?(e.format="HH:mm",e.visibleFormat="HH:mm"):(e.format="yyyy-MM-ddTHH:mm:ss.sssZ",e.visibleFormat="dd MMMM yyyy HH:mm"),e.outputFormat=e.format,angular.isUndefined(e.ngModel)&&angular.isUndefined(e.ngValue)||(e.ngValue?e.rawdata=e.ngValue:e.ngModel&&(e.rawdata=n.parse(e.ngModel,e.outputFormat))),e.customButtonBar={show:!0,now:{show:!1},today:{show:!1},clear:{show:!0,text:" ",cls:"btn-sm btn-success oux-button-margin fa fa-close"},date:{show:!e.inputMode||"datetime"===e.inputMode||"date"===e.inputMode,text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-calendar"},time:{show:e.inputMode&&("datetime"===e.inputMode||"time"===e.inputMode),text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-clock-o"},close:{show:!0,text:" ",cls:"btn-sm btn-success oux-button-margin fa fa-check"},cancel:{show:!1}},e.pickerOptions={datePicker:{startingDay:1,showWeeks:!1},timePicker:{showMeridian:!1}},e.openCalendar=function(){e.calendarOpen=!0},e.$watch("rawdata",function(i){i?e.ngModel=n.filter(i,e.outputFormat):e.ngModel=t,e.ngValue=i}),e.init=function(){},e.init()}]}}),function(){L.Control.Search=L.Control.extend({includes:L.Mixin.Events,options:{searchCall:null,searchJsonpUrl:"",searchJsonpFilter:null,searchLayer:null,searchLayerProp:"title",searchInitial:!0,searchMinLen:1,searchDelay:300,timeAutoclose:1200,autoPan:!0,autoResize:!0,animatePan:!0,zoom:null,position:"topright",placeholder:"Seach feature by id...",textErr:"Location not found"},initialize:function(e){L.Util.setOptions(this,e),this._inputMinSize=this.options.placeholder.length,this.options.searchLayer=this.options.searchLayer||new L.LayerGroup,this.options.searchJsonpFilter=this.options.searchJsonpFilter||this._jsonpDefaultFilter,this.timeDelaySearch=this.options.searchDelay,this._recordsCache={}},onAdd:function(e){return this._map=e,this._circleLoc=new L.CircleMarker([0,0],{radius:0,weight:3,color:"#0000",fill:!1}).addTo(this._map),this._container=L.DomUtil.create("div","leaflet-control-search leaflet-bar"),this._alert=this._createAlert("search-alert"),this._input=this._createInput(this.options.placeholder,"search-input"),this._createButton(this.options.placeholder,"search-button"),this._tooltip=this._createTooltip("search-tooltip"),this._container},onRemove:function(e){this._recordsCache={}},showAlert:function(e){this._setVisibleElem(this._alert,!0,100),this._alert.innerHTML=e;var t=this;clearTimeout(this.timerAlert);var i=2e3;this.timerAlert=setTimeout(function(){t._setVisibleElem(t._alert,!1,200)},i)},_setVisibleElem:function(e,t,i){var a=t?"show":"hide";$&&$.fn&&$.fn.show&&$.fn.hide?$(e)[a](500):this._alert.style.display=t?"inherit":"none"},_setCircleVisible:function(e,i,a){var o=this._circleLoc;e?(i&&o.setLatLng(i),a!==t&&o.setRadius(a),o.setStyle({color:"#ac60"})):(o.setLatLng([0,0]),o.setStyle({color:"#0000"}))},expand:function(){this._input.style.display="block",L.DomUtil.addClass(this._container,"exp"),this._input.focus()},collapse:function(){this._hideTooltip(),this._input.value="",this._input.size=this._inputMinSize,this._alert.style.display="none",this._input.style.display="none",L.DomUtil.removeClass(this._container,"exp"),this._setCircleVisible(!1)},autoCollapse:function(){var e=this,t=isNaN(this.options.timeAutoclose)?0:+this.options.timeAutoclose;t&&(this.timerCollapse=setTimeout(function(){e.collapse()},this.timeout))},autoCollapseStop:function(){clearTimeout(this.timerCollapse)},_clickFocus:function(e){e.target.focus()},_createAlert:function(e){var t=L.DomUtil.create("div",e,this._container);return t.style.display="none",t},_createInput:function(e,t){var i=L.DomUtil.create("input",t,this._container);return i.type="text",i.size=this._inputMinSize,i.value="",i.placeholder=e,i.style.display="none",L.DomEvent.disableClickPropagation(i).addListener(i,"keyup",this._handleKeypress,this).addListener(i,"keyup",this._handleAutoresize,this).addListener(i,"blur",this.autoCollapse,this).addListener(i,"focus",this.autoCollapseStop,this),i},_createButton:function(e,t){var i=L.DomUtil.create("a",t,this._container);return i.href="#",i.title=e,L.DomEvent.disableClickPropagation(i).addListener(i,"focus",this.autoCollapseStop,this).addListener(i,"blur",this.autoCollapse,this).addListener(i,"click",this._handleSubmit,this),i},_createTooltip:function(e){var t=L.DomUtil.create("div",e,this._container);t.style.display="none";var i=this;return L.DomEvent.disableClickPropagation(t).addListener(t,"blur",this.autoCollapse,this).addListener(t,"mousewheel",function(e){i.autoCollapseStop(),L.DomEvent.stopPropagation(e)},this).addListener(t,"mousedown",function(e){L.DomEvent.stop(e),i.autoCollapseStop()},this),t},_createTip:function(e){var t=L.DomUtil.create("a","search-tip");return t.href="#",t.innerHTML=e,L.DomEvent.addListener(t,"click",function(t){this._input.value=e,this._input.focus(),this._hideTooltip(),this._handleAutoresize(),this.options.autoPan&&this._handleSubmit()},this),t},_showTooltip:function(){if(this._input.value.length<this.options.searchMinLen)return this._hideTooltip();var e=new RegExp("^[.]$|[|]","g"),t=this._input.value.replace(e,""),i=this.options.searchInitial?"^":"",a=new RegExp(i+t,"i"),o=0;this._tooltip.innerHTML="";for(var n in this._recordsCache)a.test(n)&&(this._tooltip.appendChild(this._createTip(n)),o++);return o>0?this._tooltip.style.display="block":this._hideTooltip(),o},_hideTooltip:function(){this._tooltip.style.display="none",this._tooltip.innerHTML=""},_jsonpDefaultFilter:function(e){var t={};for(var i in e)t[e[i].title]=L.latLng(e[i].loc);return t},_recordsFromJsonp:function(e,t,i){L.Control.Search.callJsonp=function(e){var a=i.options.searchJsonpFilter(e);t(a)};var a=L.DomUtil.create("script","",document.getElementsByTagName("body")[0]),o=L.Util.template(i.options.searchJsonpUrl,{s:e,c:"L.Control.Search.callJsonp"});return a.type="text/javascript",a.src=o,t},_recordsFromLayer:function(){var e={},t=this.options.searchLayer,i=this.options.searchLayerProp;return t.eachLayer(function(t){var a=t.options.hasOwnProperty(i)&&t.options[i]||"";a&&(e[a]=t.getLatLng())},this),e},_handleKeypress:function(e){switch(e.keyCode){case 27:this.collapse();break;case 13:this._handleSubmit();break;case 37:case 39:case 16:case 17:break;default:if(clearTimeout(this.timerKeypress),this._input.value.length<this.options.searchMinLen)return this._hideTooltip();var t=this;this.timerKeypress=setTimeout(function(){t._timerKeypressElapsed()},t.timeDelaySearch)}},_timerKeypressElapsed:function(){var e=this,t=e._input.value;e.options.searchCall?(e._recordsCache=e.options.searchCall.apply(e,[t]),e._showTooltip()):e.options.searchJsonpUrl?e._recordsFromJsonp(t,function(t){e._recordsCache=t,e._showTooltip()},e):e.options.searchLayer&&(e._recordsCache=e._recordsFromLayer(),e._showTooltip())},_handleAutoresize:function(){this.options.autoResize&&(this._input.size=this._input.value.length<this._inputMinSize?this._inputMinSize:this._input.value.length)},_handleSubmit:function(e){"none"===this._input.style.display?this.expand():""===this._input.value?this.collapse():this._findLocation(this._input.value)===!1?this.showAlert(this.options.textErr):+this.options.timeAutoclose>0==!1&&this.collapse(),this._input.focus()},_animateLocation:function(e){this._setCircleVisible(!0,e,50),console.info("animated to: "+e);var t=this._circleLoc,i=200,a=10,o=parseInt(t._radius/a),n=0,r=this;this.timerAnimLoc=setInterval(function(){n+=.5,o+=n;var e=t._radius-o;e>.5?t.setRadius(e):clearInterval(r.timerAnimLoc)},i)},_findLocation:function(e){if(null===this._recordsCache)return console.warn("Callback for findLocation not set in L.Search plugin"),!1;if(this._recordsCache.hasOwnProperty(e)){var t=this._recordsCache[e];return this.options.zoom?this._map.setView(t,this.options.zoom):this._map.setView(t),this.options.animatePan&&this._animateLocation(t),t}return this._setCircleVisible(!1),!1}})}(),function(){if("0.7.7"!==L.version)return void console.warn("Ux-leaflet-patch only is applicable to leaflet 0.7.7. No applied to leaflet "+L.version);L.DomUtil.getPosition=function(e){return e._leaflet_pos||new L.Point(0,0)};var e=L.DomUtil.getTranslateString;L.DomUtil.getTranslateString=function(i){return i&&i.x!==t&&i.y!==t?e(i):""};var i=L.Path.prototype._updateStyle;L.Path.prototype._updateStyle=function(){i.apply(this,arguments),this.options.fill||this._path.setAttribute("fill-opacity",0)};var a=L.Draggable.prototype._onMove;L.Draggable.prototype._onMove=function(e){a.apply(this,arguments),this._lastEvent=e},console.info("Ux-leaflet-patch applied to leaflet "+L.version)}(),function(){function e(e,t){function i(e,t,i){var a=l+"/search",o=r(e),s=!t&&"2"||t.limit||"3",c=a+"/"+o+"?format=json&limit="+s;t&&t.extraParams&&(c+="&"+t.extraParams),console.info("URL nominatim search \n"+c),n(c,i)}function a(t,i,a,o,n){var r=($.extend({},d),l+"/reverse"),s=r+"?format=json&lat="+t+"&lon="+i+"&zoom="+a+"&addressdetails=1";e({method:"GET",url:s}).then(function(e){var t;try{if(e.address)t=e;else{if(200!==e.status)return;t=e.data}}catch(i){return void o(new Error("Invalid json: \n ",e))}o(null,t)},function(e){o(e)})}function o(e,t){}function n(t,i){e({method:"GET",url:t}).then(function(e){var t;try{t="string"!=typeof e?e:JSON.parse(e)}catch(a){return void i(new Error("Invalid json: \n "+e.substring(0,20)))}i(null,t)},function(e){i(e)})}function r(e){return e}var s=this,l="https://nominatim.openstreetmap.org",c=!1;t&&(l=t.baseAddress||l,c=t.houseNumberSwap||c);var d={house_number:{"Num casa":!0},road:{Calle:!0},suburb:{Suburb:!1},city:{Ciudad:!0},county:{Provincia:!0},state_district:{Suburb:!1},state:{Estado:!1},postcode:{
CP:!1},country:{"Pa√≠s":!0},country_code:{cc:!1}};s.reverseSearch=a,s.search=i,s.lookupGeometry=o}function i(e){return $.ajax(e.url)}if(L.OsmGeocodingService=e,L.Util.geocodingService=new e(i),L.Control.OsmPlaceFinder=L.Control.extend({includes:L.Mixin.Events,options:{searchLayerProp:"title",searchInitial:!0,searchMinLen:5,searchDelay:300,timeAutoclose:1200,autoPan:!0,autoResize:!0,animatePan:!0,zoom:null,position:"topleft",prepend:!0,placeholder:"Search place ..",textErr:"Place not found",autocompleteEnabled:!0,hightlightTarget:!0},initialize:function(e){L.Control.prototype.initialize.apply(this,arguments),L.Util.setOptions(this,e),this._inputMinSize=this.options.placeholder.length,this.options.searchLayer=this.options.searchLayer||new L.LayerGroup,this.options.searchJsonpFilter=this.options.searchJsonpFilter||this._jsonpDefaultFilter,this.timeDelaySearch=this.options.searchDelay,this._recordsCache={}},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),i=this.getPosition(),a=e._controlCorners[i];return L.DomUtil.addClass(t,"leaflet-control"),this.options.prepend?a.insertBefore(t,a.firstChild):a.appendChild(t),this},onAdd:function(e){this._map=e;var t="leaflet-control-osmplacefinder";return this._container=L.DomUtil.create("div",t+" leaflet-bar"),this._alert=this._createAlert("search-alert"),this._input=this._createInput(this.options.placeholder,"search-input"),this._createButton(this.options.placeholder,"search-button"),this._tooltip=this._createTooltip("search-tooltip"),this._container},onRemove:function(e){this._recordsCache=[]},showAlert:function(e){this._setVisibleElem(this._alert,!0,100),this._alert.innerHTML=e;var t=this;clearTimeout(this.timerAlert);var i=2e3;this.timerAlert=setTimeout(function(){t._setVisibleElem(t._alert,!1,200)},i)},_setVisibleElem:function(e,t,i){var a=t?"show":"hide";$&&$.fn&&$.fn.show&&$.fn.hide?$(e)[a](500):this._alert.style.display=t?"inherit":"none"},expand:function(){this._input.style.display="block",L.DomUtil.addClass(this._container,"exp"),this._input.focus(),""!==this._input.value&&this._refreshPlaces()},collapse:function(){return localStorage.getItem("CSS")?void console.error("  comentado c√≥digo para colapsar"):(this._hideTooltip(),this._input.size=this._inputMinSize,this._alert.style.display="none",this._input.style.display="none",void L.DomUtil.removeClass(this._container,"exp"))},autoCollapse:function(){var e=this,t=isNaN(this.options.timeAutoclose)?0:+this.options.timeAutoclose;t&&(this.timerCollapse=setTimeout(function(){e.collapse()},this.timeout))},autoCollapseStop:function(){clearTimeout(this.timerCollapse)},_clickFocus:function(e){e.target.focus()},_createAlert:function(e){var t=L.DomUtil.create("div",e,this._container);return t.style.display="none",t},_createInput:function(e,t){var i=L.DomUtil.create("input",t,this._container);return i.type="text",i.size=this._inputMinSize,i.value="",i.placeholder=e,i.style.display="none",L.DomEvent.disableClickPropagation(i).addListener(i,"keyup",this._handleKeypress,this).addListener(i,"keyup",this._handleAutoresize,this).addListener(i,"blur",this.autoCollapse,this).addListener(i,"focus",this.autoCollapseStop,this),i},_createButton:function(e,t){var i=L.DomUtil.create("a",t,this._container);return i.href="#",i.title=e,L.DomEvent.disableClickPropagation(i).addListener(i,"focus",this.autoCollapseStop,this).addListener(i,"blur",this.autoCollapse,this).addListener(i,"click",this._handleSubmit,this),i},_createTooltip:function(e){var t=L.DomUtil.create("div",e,this._container);t.style.display="none";var i=this;return L.DomEvent.disableClickPropagation(t).addListener(t,"blur",this.autoCollapse,this).addListener(t,"mousewheel",function(e){i.autoCollapseStop(),L.DomEvent.stopPropagation(e)},this).addListener(t,"mousedown",function(e){L.DomEvent.stop(e),i.autoCollapseStop()},this),t},_createTip:function(e){var t=L.DomUtil.create("a","search-tip");return t.href="#",t.innerHTML=e.display_name,t.setAttribute("data-tip",e),L.DomEvent.addListener(t,"click",function(t){this._input.focus(),this._hideTooltip(),this._handleAutoresize(),this.options.autoPan&&this._handleSubmit(e)},this),t},_createCopyright:function(){var e=L.DomUtil.create("p","osm-copyright");e.innerHTML="powered by ";var t=L.DomUtil.create("a");return t.href="http://wiki.openstreetmap.org/wiki/Nominatim",t.innerHTML="Nominatim",t.target="_blank",e.appendChild(t),e},_showTooltip:function(){this._tooltip.innerHTML="";for(var e=this._recordsCache,t=0;t<e.length;t+=1){var i=e[t];this._tooltip.appendChild(this._createTip(i))}if(0===+e.length){var a=L.DomUtil.create("p","err-text",this._tooltip);a.innerText=this.options.textErr}this._tooltip.appendChild(this._createCopyright()),this._tooltip.style.display="block"},_hideTooltip:function(){this._tooltip.style.display="none",this._tooltip.innerHTML=""},_handleKeypress:function(e){switch(e.keyCode){case 27:""===this._input.value?this.collapse():this._input.value="";break;case 13:this.options.autocompleteEnabled===!1?this._refreshPlaces():this._handleSubmit(0);break;case 37:case 39:var t=this._input.value;this._input.selectionStart>=t.length&&this._refreshPlaces(t);break;case 16:case 17:break;default:if(this.options.autocompleteEnabled===!1)return;if(clearTimeout(this.timerKeypress),this._input.value.length<this.options.searchMinLen)return this._hideTooltip();var i=this;this.timerKeypress=setTimeout(function(){i._refreshPlaces()},i.timeDelaySearch)}},_refreshPlaces:function(e){var i=this;if(!this._isRefreshing){this._isRefreshing=!0,e===t&&(e=this._input.value);var a=L.Util.geocodingService,o={limit:5};a.search(e,o,function(t,a){if(null!==t)console.warn("Error search in nominatim "+e+"]",t),i._recordsCache=[];else{i._recordsCache=a;var o=a||a.length;console.info(""+new Date+" nominatim - getPlaces: ok: "+o,a)}i._isRefreshing=!1,i._showTooltip()})}},_handleAutoresize:function(){this.options.autoResize&&(this._input.size=this._input.value.length<this._inputMinSize?this._inputMinSize:this._input.value.length)},_handleSubmit:function(e){"none"===this._input.style.display?this.expand():(e=e||this._recordsCache[0],e?this._findLocation(e)===!1?this.showAlert(this.options.textErr):(+this.options.timeAutoclose>0==!1&&this.collapse(),this.options.hightlightTarget&&this.highlightResult(e)):this.collapse()),this._input.focus()},_findLocation:function(e){try{var t=new L.latLng(e.lat,e.lon),i=e.boundingbox,a=new L.LatLngBounds([[i[0],i[2]],[i[1],i[3]]]);return this._map.fitBounds(a),t}catch(o){return!1}},highlightResult:function(e){if(e){var t=new L.LayerGroup;if(t.addTo(this._map),e.lat){var i=L.circleMarker([e.lat,e.lon],{radius:10,weight:2,fillColor:"#ff7800",color:"blue",opacity:.75}),a=this._map;i.on("click",function(){a.removeLayer(t)}),t.addLayer(i)}if(e.aBoundingBox){var o=[[1*e.aBoundingBox[0],1*e.aBoundingBox[2]],[1*e.aBoundingBox[1],1*e.aBoundingBox[3]]];if(this._map.fitBounds(o),e.asgeojson&&e.asgeojson.match(/(Polygon)|(Line)/)){var n=JSON.parse(e.asgeojson),r=L.geoJson(n,{style:function(e){return{interactive:!1,color:"blue"}}});t.addLayer(r)}}}}}),L.Map._isDemoEnabled){console.info("OJO: Nominatim activado. Hacking L.Map._onclic"),L.Map.mergeOptions({uxNominatim:{zoomOffset:2}});var a;L.Map.NominatimClickHandler=L.Handler.extend({initialize:function(e){a.initialize.apply(this,arguments),this._zoomOffset=e.options.uxNominatim.zoomOffset||0},addHooks:function(){var e=this._map;e.on("click",this._clicked,this),e.whenReady(this._mapReady,this)},removeHooks:function(){this._map.off("click",this._clicked,this)},_mapReady:function(){var e=this._map._container&&this._map._container.id;console.info("GeocodingService. Mapa listo para  click->nominatim-balloon: MapId: ["+e+"]. Clic con shift y ctrl presionados")},_clicked:function(t){var a=t.originalEvent;if(a.altKey&&a.ctrlKey){console.info("Prueba con nominatim en ",a);var o=this._map,n=t.latlng,r=o.getZoom()+this._zoomOffset,s=L.popup({className:"ux-nomintim"}),l=document.createElement("div");s.setContent(l),s.setLatLng(n),l.classList.add("ux-nominatim"),l.classList.add("ux-waiting");var c=document.createElement("div");c.style.maxHeight="150px",c.style.overflowY="scroll",c.style.padding=".6em",c.style.backgroundColor="#f0f0d0",l.innerHTML="<p>Obteniendo posici√≥n</p>",l.appendChild(c);var d=new e(i,{}),u=this;d.reverseSearch(n.lat,n.lng,r,function(e,t){if(null!==e)c.innerText=e.message;else{var i=u._generateHtmlTable(t.address,null,!1);c.style.fontSize="1.35em",c.innerHTML=i,l.classList.remove("ux-waiting"),l.parentNode.style.width="inherit",l.parentNode.style.minWidth="200px",l.parentNode.style.maxWidth="500px",s.update()}}),this._map.openPopup(s)}},_onViewReset:function(){var e=this._map.getSize()._divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.project([0,180]).x},_generateHtmlTable:function(e,t,i){if("string"==typeof t)return e[t];var a=!t;t=!t&&e;var o="";for(var n in t)if(a||n in e){var r=i?n+" : ":"";o+="<tr><td>"+r+"</td><td>"+e[n]+"</td></tr>"}return o=o||"- - -","<table><tbody>"+o+"</tbody></table>"}}),a=L.Map.NominatimClickHandler.__super__,L.Map.addInitHook("addHandler","uxNominatim",L.Map.NominatimClickHandler)}}(),function(e){function t(e){var t=i(e.options);if(e instanceof L.SVG)return L.svg(t);if(e instanceof L.Canvas)return L.canvas(t);if(e instanceof L.TileLayer)return L.tileLayer(e._url,t);if(e instanceof L.ImageOverlay)return L.imageOverlay(e._url,e._bounds,t);if(e instanceof L.Marker)return L.marker(e.getLatLng(),t);if(e instanceof L.Circle)return L.circle(e.getLatLng(),e.getRadius(),t);if(e instanceof L.CircleMarker)return L.circleMarker(e.getLatLng(),t);if(e instanceof L.Rectangle)return L.rectangle(e.getBounds(),t);if(e instanceof L.Polygon)return L.polygon(e.getLatLngs(),t);if(e instanceof L.Polyline)return L.polyline(e.getLatLngs(),t);if(e instanceof L.GeoJSON)return L.geoJson(e.toGeoJSON(),t);if(e instanceof L.LayerGroup)return L.layerGroup(a(e));if(e instanceof L.FeatureGroup)return L.FeatureGroup(a(e));throw"Unknown layer, cannot clone this layer. Leaflet-version: "+L.version}function i(e){var i={};for(var a in e){var o=e[a];o&&o.clone?i[a]=o.clone():o instanceof L.Layer?i[a]=t(o):i[a]=o}return i}function a(e){var i=[];return e.eachLayer(function(e){i.push(t(e))}),i}L.Util.cloneLayer||(L.Util.cloneLayer=t),"object"==typeof e&&(module.exports=t)}(e.exports),function(){function i(e,i){var a=i.properties[e];return a===t&&(a="not-found-"+e),a}if(!e.L)throw new Error("L.Control.Markers needs Leaflet");L.ux||(L.ux={});L.ux.Marker=L.Marker.extend({_isMarker:!0,_feature:null,_latlng:null,_bocadilloOffset:new L.Point(0,(-42)),initialize:function(e,t){this._feature=t,this._latlng=e;var i=this.createIcon(),a=this.createTitle();L.Marker.prototype.initialize.call(this,e,{title:a,icon:i})},showPopup:function(e,t,i,a){if(null===this._popup){var o=e.fillPopup(this._feature,t,i),n=this._latlng,r=this._bocadilloOffset;this._popup=L.popup({offset:r}).setLatLng(n).setContent(o)}this._popup.openOn(e)},createIcon:function(){return L.marker()},createTitle:function(){return"Marker"},_getProperty:function(e){i("entitytype",this._feature)},_end:0}),L.ux.EntityMarker=L.ux.Marker.extend({_isEntityMarker:!0,_bocadilloOffset:new L.Point(0,(-42)),createIcon:function(){var e=this._feature.properties.status||"unknown",t="status-"+e+" t-"+this._getProperty("entitytype"),i=L.divIcon({iconSize:[40,40],iconAnchor:[20,40],html:"<div class='m2m-type'></div>",className:t});return i},createTitle:function(){return this._getProperty("entityKeyAsString")},_end:0}),L.ux.entityMarker=function(e,t){return new L.ux.maps.EntityMarker(e,t)},L.ux.QuadrantMarker=L.ux.Marker.extend({_isQuadrantMarker:!0,_bocadilloOffset:new L.Point(0,(-17)),createIcon:function(){var e="marker-cluster marker-cluster-small quadranKey",t=L.divIcon({iconSize:[40,40],iconAnchor:[20,20],html:"<div class=''><span>G</span></div>",className:e});return t},createTitle:function(){var e="Agrupador: "+this._getProperty("quadrantKeyAsString");return e},_end:0}),L.ux.quadrantMarker=function(e,t){return new L.ux.maps.QuadrantMarker(e,t)}}(),function(){function e(e,t){var i=t[0];return i?(n(i,function(t,i){if(t)return void console.error("Error cartgando fichero",t);try{L.TileLayer.prototype.changeTileDataFromJson.call(e,i)}catch(t){throw"Invalid JSON data"}}),void console.debug("Cambiando tiles a capa: "+e.name)):void console.debug("carga de tiles locales cancelada")}function t(e,t){var i=t[0];if("string"==typeof i)return!1;i.id;return!1}function i(e){var t=(e.options||{},e.options.usingLocalTiles||localStorage.getItem("localtiles")),i={osm:{name:"OpenStreetMap",url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz",layerParams:{attribution:"OpenStreet Map",maxZoom:19}},dark2:{name:"Dark Map",url:"//{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",layerParams:{attribution:"Cartocdn Dark Map",maxZoom:19},type:"xyz"},ogWorld:{name:"OpenGate Maps",url:"http://172.19.18.248/osm_tiles/{z}/{x}/{y}.png",layerParams:{attribution:"OpenGate Maps",maxZoom:19},type:"xyz"}},a=new L.Control.Layers;e.addControl(a);for(var o in i){var n=i[o],r=L.tileLayer(n.url,n.options);a.addBaseLayer(r,n.name)}e.addControl(new L.Control.MousePosition({})),e.addControl(new L.Control.Fullscreen({})),t&&L.Control.LocalTileControl&&e.addControl(new L.Control.LocalTileControl({}))}function a(e,t){var i=t&&t.controls&&t.controls.custom;!e._syncMinimapLayerenabled&&i&&(e._syncMinimapLayerenabled=!0,e.on("baselayerchange",function(e){var t=o(i,L.Control.MiniMap);if(t){var a=new L.TileLayer(e.layer._url);t.changeLayer(a)}var n=o(i,L.Control.Gohome);if(n){var r=e.layer.getHomeInfo&&e.layer.getHomeInfo();r&&r.center?n.changeTargetView(r.center,r.zoom):n.restoreOriginalView()}}))}function o(e,t){for(var i=0;i<e.length;i+=1){var a=e[i];if(a instanceof t)return a}}function n(e,t){var i=e?e.name:"null",a=new FileReader;a.onload=function(){try{var e=a.result;t(null,e)}catch(o){t(new Error("No valid GeoJson file: ["+i+"]\n"+o),null)}};try{a.readAsText(e)}catch(o){t(new Error("Invalid "+i+"\n"+o.message),null)}}function r(e,t,i){function a(e){this.getMessage=function(){return e}}console.warn("WARN: MapUx est√° usando __overrideClass. Class in development: ",e.constructor);var o=i||{};for(var n in t){var r=n,s=e.prototype[r];if(!s){var l=r;s=new a(" not exist "+l).getMessage}o[r]=s;var c=t[r];e.prototype[r]=c}return o}var s,l=!1;if(!L.UxMap&&!L.Map_ixUx){s=L.Map;var c,d={initialize:function(){var e=t(this,arguments);c.initialize.apply(this,arguments),console.info("Ux L.Map initialize");var a=this.options;if(a.editPointSize&&L.Editable&&L.Editable.VertexIcon){var o=parseInt(a.editPointSize);o>5&&o<30&&(L.Editable.VertexIcon.prototype.options.iconSize=new L.Point(o,o))}e&&i(this)},setNgScope:function(e){this._$ScopeConfig||(this._$ScopeConfig=e&&e.config,a(this,e))},_enableMinimapSynchronization:function(e){},addControl:function(e){c.addControl.apply(this,arguments);var t=e&&e._container&&e._container.classList;if(t&&t.contains("leaflet-control-layers")&&(!this._mainLayerControl&&e instanceof L.Control.Layers&&(this._mainLayerControl=e),this._layerControlPosition=e.options.position),this._layerControlPosition===e.options.position){var i=$(this._container).find(".leaflet-control-layers.leaflet-control")[0];if(i&&i!==e._container){var a=i.parentNode;a.removeChild(i),a.appendChild(i)}}}};l?(c=s.prototype,L.UxMap=s.extend(d),L.UxMap._isUx=!0):(c={},r(s,d,c)),L.Map._isUx=!0,L.Map._isDemoEnabled=!!localStorage.getItem("isUxDemo");var u=L.Control.Zoom.prototype.options;u.zoomInText="",u.zoomOutText="",u.maxZoom=20,L.Map.prototype._removeZoomContent||(L.Map.prototype._removeZoomContent=!0)}if(!L.Control.UxLayers){s=L.Control.Layers;var p,h="Offline",f={initialize:function(e,t,i){p.initialize.apply(this,arguments),this._localLayer=null},_initLayout:function(){p._initLayout.apply(this,arguments),this._container.classList.add("navbar"),this._container.classList.add("navbar-primary"),this._form.classList.add("navbar"),this._form.classList.add("navbar-primary")},addBaseLayer:function(e,t){return p.addBaseLayer.apply(this,arguments),e._isUsingLocalTiles&&(null===this._localLayer?this._localLayer=e:console.warn("Another locallayer already exists. "+this._localLayer.layerName)),this},removeLayer:function(e){return p.removeLayer.apply(this,arguments),e._isUsingLocalTiles&&this._localLayer===e,this},_addItem:function(t){var i=p._addItem.apply(this,arguments);if(t.name.startsWith(h)){var a=document.createElement("input");a.textContent="Seleccionar",a.type="file",Object.defineProperty(a,"layerId",{get:function(){return t.layer._leaflet_id}}),a.style.width="160px",a.style.position="absolute",a.style.left="0px",a.style.top="-24px",a.style.display="none",$(a).click(function(e){e.stopPropagation()}),a.onchange=function(i){i.stopPropagation(),e(t.layer,i.target.files)};var o=i.children[0],n=i.parentNode;$(n).click(function(){var e=o.checked?"inherit":"none";a.style.display=e});var r=n.parentNode;r.insertBefore(a,r.firstChild)}},_refreshOfflineLayer:function(e,t){var i=t[0];return i?(t.length>1&&console.warn("selected "+(t.length-1)+" files after first is ignored"),n(i,function(t,i){if(t)return void console.error("Error cartgando fichero",t);try{L.TileLayer.prototype.changeTileDataFromJson.call(e,i)}catch(t){throw"Invalid JSON data"}}),void console.debug("Cambiando tiles a capa: "+e.name)):void console.debug("carga de tiles locales cancelada")}};l?(p=s.prototype,L.Control.UxLayers=s.extend(f)):(p={},r(s,f,p))}L.DomUtil.uxLoadGeoJsonFromFile=n}(),function(){L.Control.MousePosition=L.Control.extend({options:{position:"bottomleft",separator:" : ",emptyString:"Unavailable",lngFirst:!1,numDigits:6,lngFormatter:t,latFormatter:t,prefix:""},_existMouse:!1,onAdd:function(e){return this._container=L.DomUtil.create("div","leaflet-control-mouseposition"),L.DomEvent.disableClickPropagation(this._container),e.on("mousemove",this._onMouseMove,this),e.on("move",this._onMove,this),this._container.innerHTML=this.options.emptyString,this._container},onRemove:function(e){e.off("mousemove",this._onMouseMove)},_setText:function(e){var t=this.options.lngFormatter?this.options.lngFormatter(e.lng):L.Util.formatNum(e.lng,this.options.numDigits),i=this.options.latFormatter?this.options.latFormatter(e.lat):L.Util.formatNum(e.lat,this.options.numDigits),a=this.options.lngFirst?t+this.options.separator+i:i+this.options.separator+t,o=this.options.prefix+" "+a;this._container.innerHTML=o},_onMouseMove:function(e){this._existMouse=!0,this._setText(e.latlng)},_onMove:function(e){if(!this._existMouse){var t=e.target;this._setText(t.getCenter())}}}),L.Map.mergeOptions({positionControl:!1}),L.Map.addInitHook(function(){this.options.positionControl&&(this.positionControl=new L.Control.MousePosition,this.addControl(this.positionControl))}),L.control.mousePosition=function(e){return new L.Control.MousePosition(e)}}(),function(){function t(){}function i(t,i){var a=e.addEventListener?document.addEventListener:document.attachEvent;a("keydown",function(e){16!==e.keyCode&&16!==e.charCode||(e._iskeydown=!0,t.call(i,e,!0))}),a("keyup",function(e){16!==e.keyCode&&16!==e.charCode||(e._iskeyup=!0,t.call(i,e,!1))})}function a(t,i){var a=e.removeEventListener?document.removeEventListener:function(){};a("keydown",i),a("keyup",i)}function o(t){var i=e.location.protocol+"//b.tile.openstreetmap.org/{z}/{x}/{y}.png",a={attribution:"&copy; <a href='https://osm.org/copyright'>OpenStreetMap</a> contributors"},o=L.tileLayer(i,a),n=L.magnifyingGlass({zoomOffset:3,layers:[o]});return n}if(!e.L)throw new Error("L.MagnifyingGlass needs Leaflet");var n,r;L.Layer?(n=L.Layer,r=!1):(n=L.Class,r=!0),L.MagnifyingGlass=n.extend({options:{radius:180,zoomOffset:3,layers:[],fixedPosition:!1,latLng:[0,0],fixedZoom:-1},initialize:function(e){L.Util.setOptions(this,e),this._fixedZoom=this.options.fixedZoom!==-1,this._mainMap=null,this._glassMap=null},_shifPerformed:function(e,t){var i=t?".6":"1";this._glassMap._container.style.opacity=i},getMap:function(){return this._glassMap},_createMiniMap:function(e){return new L.Map(e,{layers:this.options.layers,zoom:this._getZoom(),maxZoom:this._mainMap.getMaxZoom(),minZoom:this._mainMap.getMinZoom(),crs:this._mainMap.options.crs,fadeAnimation:!1,attributionControl:!1,zoomControl:!1,boxZoom:!1,touchZoom:!1,scrollWheelZoom:!1,doubleClickZoom:!1,dragging:!1,keyboard:!1})},_getZoom:function(){return this._fixedZoom?this.options.fixedZoom:this._mainMap.getZoom()+this.options.zoomOffset},_updateZoom:function(){this._glassMap.setZoom(this._getZoom())},setRadius:function(e){this.options.radius=e,this._wrapperElt&&(this._wrapperElt.style.width=2*this.options.radius+"px",this._wrapperElt.style.height=2*this.options.radius+"px")},setLatLng:function(e){this.options.latLng=e,this._update(e)},_updateFromMouse:function(e){this._update(e.latlng,e.layerPoint)},_updateFixed:function(){this._update(this.options.latLng)},_update:function(e,t){this._glassMap.setView(e,this._getZoom(),{pan:{animate:!1}}),t=t||this._mainMap.latLngToLayerPoint(e),this._wrapperElt.style.left=t.x-this.options.radius+"px",this._wrapperElt.style.top=t.y-this.options.radius+"px"},onAdd:function(e){this._mainMap=e,this._wrapperElt=L.DomUtil.create("div","leaflet-magnifying-glass");var t=L.DomUtil.create("div","",this._wrapperElt);L.Browser.webkit&&L.DomUtil.addClass(t,"leaflet-magnifying-glass-webkit"),this._glassMap=this._createMiniMap(t),L.DomEvent.addListener(this._wrapperElt,"click",this._fireClick,this);var a=this.options;return this.setRadius(a.radius),this.setLatLng(a.latLng),this._glassMap.whenReady(function(){a.fixedPosition?(this._mainMap.on("zoomend",this._updateFixed,this),L.DomUtil.addClass(this._wrapperElt,"leaflet-zoom-hide")):(this._mainMap.on("mousemove",this._updateFromMouse,this),this._fixedZoom||this._mainMap.on("zoomend",this._updateZoom,this))},this),e.getPanes().popupPane.appendChild(this._wrapperElt),this._glassMap.invalidateSize(),i(this._shifPerformed,this),this},_fireClick:function(e){this.fire&&this.fire("click",e),L.DomEvent.stopPropagation(e)},onRemove:function(e){e.off("viewreset",this._updateFixed,this),e.off("mousemove",this._updateFromMouse,this),e.off("zoomend",this._updateZoom,this);for(var t=0,i=this.options.layers.length;t<i;t++)this._glassMap.removeLayer(this.options.layers[t]);return this._glassMap.remove(),L.DomEvent.removeListener(this._wrapperElt,"click",this._fireClick),e.getPanes().popupPane.removeChild(this._wrapperElt),this._mainMap=null,a(this._shifPerformed,this),this}}),L.magnifyingGlass=function(e){return new L.MagnifyingGlass(e)},L.Control.MagnifyingGlass=L.Control.extend({_magnifyingGlass:!1,options:{position:"topleft",title:"Toggle Magnifying Glass",forceSeparateButton:!0},initialize:function(e){for(var t in e)e.hasOwnProperty(t)&&this.options.hasOwnProperty(t)&&(this.options[t]=e[t])},onAdd:function(e){var t,i="leaflet-control-magnifying-glass";return t=e.zoomControl&&!this.options.forceSeparateButton?e.zoomControl._container:L.DomUtil.create("div",i+" leaflet-bar"),this._button=this._createButton(this.options.title,i,t,e),t},_createButton:function(e,t,i,a){var o=this,n=L.DomUtil.create("a",t,i);return n.href="#",n.title=e,L.DomEvent.addListener(n,"click",L.DomEvent.stopPropagation).addListener(n,"click",L.DomEvent.preventDefault).addListener(n,"click",function(){o._clicked(a)}),n},_clicked:function(){var e=this._map;this._magnifyingGlass||(this._magnifyingGlass=o(e)),e.hasLayer(this._magnifyingGlass)?(e.removeLayer(this._magnifyingGlass),L.DomUtil.removeClass(this._button,"active")):(this._magnifyingGlass.addTo?this._magnifyingGlass.addTo(e):e.addLayer(this._magnifyingGlass),L.DomUtil.addClass(this._button,"active"))}}),L.control.magnifyingglass=function(e){return new L.Control.MagnifyingGlass(e)},t()}(),function(){var t=L.Control.GPlaceAutocomplete;if(!t)return void console.error("L.Control.GPlaceAutocomplete2 requires L.Control.GPlaceAutocomplete");if(L.Control.GPlaceAutocomplete2=t.extend({_buildContainer:function(e){var i=this;L.extraApi.ensureLib("google",["google.maps.places.Autocomplete"],function(){t.prototype._buildContainer.call(i,e)})},addTo:function(i){var a=this,o=e.setInterval(function(){a.container&&(e.clearInterval(o),t.prototype.addTo.call(a,i))},100)}}),document.location.host.startsWith("172.")||document.location.host.startsWith("localhost"))var i=2e3,a=3,o=a,n=e.setInterval(function(){var t="google-apikey",i=localStorage.getItem(t);i&&L.extraApi?(console.info("Found apikey in locaStorage['"+t+"']"),L.extraApi.setApikey("google",i),o=-1):console.debug("Not Found apikey in locaStorage['"+t+"']"),(o-=1)<0&&e.clearInterval(n)},i)}(),function(){function i(e){L.Google.asyncWait.push(e),a||(a=!0,L.extraApi.ensureLib("google",["google.maps.Map"],function(){var e;for(e=0;e<L.Google.asyncWait.length;e++){var t=L.Google.asyncWait[e];t._ready=!0,t._container&&(t._initMapObject(),t._update())}L.Google.asyncWait=[]}))}if(!e.L)throw new Error("L.Google needs Leaflet");L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1},initialize:function(a,o){L.Util.setOptions(this,o),this._ready=e.google!==t,this._ready||i(this),this._type=a||"SATELLITE"},onAdd:function(e,t){this._map=e,this._insertAtTheBottom=t,this._initContainer(),this._initMapObject(),e.on("viewreset",this._resetCallback,this),this._limitedUpdate=L.Util.limitExecByInterval(this._update,50,this),e.on("move",this._update,this),e.on("dragstart",this._update,this),e.on("drag",this._update,this),e.on("zoomstart",this._update,this),e.on("zoomend",this._update,this),e.on("autopanstart",this._update,this),e._controlCorners.bottomright.style.marginBottom="1em",this._reset(),this._update()},onRemove:function(e){this._map._container.removeChild(this._container),this._map.off("viewreset",this._resetCallback,this),this._map.off("move",this._update,this),e._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(e){this.options.opacity=e,e<1&&L.DomUtil.setOpacity(this._container,e)},setElementSize:function(e,t){e.style.width=t.x+"px",e.style.height=t.y+"px"},_initContainer:function(){var e=this._map._container,t=e.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left"),this._container.id="_GMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),e.insertBefore(this._container,t),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(this._ready){this._google_center=new google.maps.LatLng(0,0);var e=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!0,streetViewControl:!1}),t=this;this._reposition=google.maps.event.addListenerOnce(e,"center_changed",function(){t.onReposition()}),e.backgroundColor="#ff0000",this._google=e}},_resetCallback:function(e){this._reset(e.hard)},_reset:function(e){this._initContainer()},_update:function(){if(this._google){this._resize();var e=this._map.getBounds(),t=e.getNorthEast(),i=e.getSouthWest(),a=(new google.maps.LatLngBounds(new google.maps.LatLng(i.lat,i.lng),new google.maps.LatLng(t.lat,t.lng)),this._map.getCenter()),o=new google.maps.LatLng(a.lat,a.lng);this._google.setCenter(o),this._google.setZoom(this._map.getZoom())}},_resize:function(){var e=this._map.getSize();this._container.style.width===e.x&&this._container.style.height===e.y||(this.setElementSize(this._container,e),this.onReposition())},onReposition:function(){this._google&&google.maps.event.trigger(this._google,"resize")}}),L.Google.asyncWait=[];var a=!1}(),!e.L)throw new Error("L.Control.Gohome needs Leaflet");L.Control.Gohome=L.Control.extend({includes:L.Mixin.Events,options:{className:""},_isGohomeInstance:!0,initialize:function(e){L.Control.initialize&&L.Control.initialize.apply(this,arguments),L.Util.setOptions(this,e),this._className=(this.options.className||"")+" ux-home",this.options.center=this.options.center||[40,-3.7],this.options.zoom=this.options.zoom||8,this._originalView={center:this.options.center,zoom:this.options.zoom}},onAdd:function(e){var t=this._className+" leaflet-control-home",i=L.DomUtil.create("div",t+" leaflet-bar"),a=this.options.fullscreenTitle||"Go Home Location";return this._createButton("",a,t,i,this.goHome,this),i},_createButton:function(e,t,i,a,o,n){var r=L.DomUtil.create("a",i+" leaflet-bar-part",a);r.innerHTML=e,r.href="#",r.title=t;var s=L.DomEvent.stopPropagation;return L.DomEvent.on(r,"click",s).on(r,"mousedown",s).on(r,"dblclick",s).on(r,"click",L.DomEvent.preventDefault).on(r,"click",o,n).on(r,"click",this._refocusOnMap,n),r},goHome:function(){if(this.options.bounds)this._map.fitBounds(this.options.bounds);else{var e=this.options.zoom||8,t=this.options.center,i=new L.LatLng(t[0],t[1]);this._map.setView(i,e)}this._map.invalidateSize()},saveCurrentViewOriginalView:function(){this._originalView={center:this.options.center,zoom:this.options.zoom}},restoreOriginalView:function(){this.changeTargetView(this._originalView.center,this._originalView.zoom)},changeTargetView:function(e,i){if(isNaN(e[0])||isNaN(e[1])){if(isNaN(e.lat)||isNaN(e.lng))throw"unknowwn format for center: "+e;this.options.center=[e.lat,e.lng]}else this.options.center=e;this.options.zoom=i,this.options.bounds=t},changeTargetViewToBounds:function(e){if(!e.isValid)throw"Invalid bounds: "+e;this.options.bounds=e,this.options.zoom=t,this.options.center=t},_oldStyle:{}}),L.gohome=function(e){return new L.Control.Gohome(e)},o(),function(){if(!e.L)throw new Error("L.Control.FeatureSelection needs Leaflet");L.Control.FeatureSelection=L.Control.extend({includes:L.Mixin.Events,options:{className:""},_button:null,_restriction:null,initialize:function(t){if(!e.L.Map.SelectArea)throw new Error("L.Control.FeatureSelection needs L.Map.SelectArea (bower: leaflet-select-area");L.Control.initialize&&L.Control.initialize.apply(this,arguments),L.Util.setOptions(this,t)},onAdd:function(e){this._map=e;var t=(this._className||"")+" leaflet-control-boxselection",i=L.DomUtil.create("div",t+" leaflet-bar"),a=this.options.title||"Select features on map";a="IN DEVELOPMENT  --  Select features on map",console.warn(a),this._button=this._createButton("",a,t,i,this.goHome,this);document.querySelector(".info .result")||$("<div></div>");return e.on({areaselected:this.areaSelectedPerformed,areaselecttoggled:this.updateButton}),this._map.selectArea.setControlKey(!1),this.updateButton(),i},areaSelectedPerformed:function(e){var t=e.bounds.toBBoxString().split(",").join(",\n");console.info(t)},_createButton:function(e,t,i,a,o,n){var r=this,s=L.DomUtil.create("a",i+" leaflet-bar-part",a);s.innerHTML=e,s.href="#",s.title=t;var l=L.DomEvent.stopPropagation;return L.DomEvent.on(s,"click",function(){r._areaSelectToggled()}).on(s,"mousedown",l).on(s,"dblclick",l).on(s,"click",L.DomEvent.preventDefault),s},updateButton:function(){this._button&&L.DomUtil[this._map.selectArea.enabled()?"addClass":"removeClass"](this._button,"active")},toggleRestriction:function(){var e=this._map;if(this._restriction)e.removeLayer(this._restriction),e.selectArea.setValidate(),this._restriction=null;else{var t=e.getBounds().pad(-.25);this._restriction=L.rectangle(t,{weight:2,color:"#0ff",fillOpacity:0,clickable:!1,opacity:.7}).addTo(e),e.selectArea.setValidate(function(i){return t.contains(e.layerPointToLatLng(i))})}},_areaSelectToggled:function(){this._map.selectArea.enabled()?(L.DomUtil.removeClass(this._button,"active"),this._map.selectArea.disable(),console.info("Select area disabled")):(L.DomUtil.addClass(this._button,"active"),this._map.selectArea.enable(),console.info("Select area enabled"))},toggleCtrlKey:function(){this._map.selectArea.setControlKey(document.querySelector("#ctrl-key").checked);
},toggleShiftKey:function(){this._map.selectArea.selectArea.setShiftKey(document.querySelector("#shift-key").checked)},_oldStyle:{}}),L.boxSelection=function(e){return new L.Control.BoxSelection(e)}}(),L.Editable=L.Class.extend({_dev_version:"0.9.0",_clazzName:"L.Editable",includes:[L.Mixin.Events],statics:{FORWARD:1,BACKWARD:-1},options:{zIndex:1e3,polygonClass:L.Polygon,polylineClass:L.Polyline,markerClass:L.Marker,drawingCSSClass:"leaflet-editable-drawing"},initialize:function(e,t){L.setOptions(this,t),this._lastZIndex=this.options.zIndex,this.map=e,this.editLayer=this.createEditLayer(),this.featuresLayer=this.createFeaturesLayer(),this.newClickHandler=this.createNewClickHandler(),this.forwardLineGuide=this.createLineGuide(),this.backwardLineGuide=this.createLineGuide()},fireAndForward:function(e,t){t=t||{},t.editTools=this,this.fire(e,t),this.map.fire(e,t)},createLineGuide:function(){var e=L.extend({dashArray:"5,10",weight:1},this.options.lineGuideOptions);return L.polyline([],e)},createVertexIcon:function(e){return L.Browser.touch?new L.Editable.TouchVertexIcon(e):new L.Editable.VertexIcon(e)},createNewClickHandler:function(){return L.marker(this.map.getCenter(),{icon:this.createVertexIcon({className:"leaflet-div-icon leaflet-drawing-icon"}),opacity:0,zIndexOffset:this._lastZIndex})},createEditLayer:function(){return this.options.editLayer||(new L.LayerGroup).addTo(this.map)},createFeaturesLayer:function(){return this.options.featuresLayer||(new L.LayerGroup).addTo(this.map)},moveForwardLineGuide:function(e){this.forwardLineGuide._latlngs.length&&(this.forwardLineGuide._latlngs[1]=e,this.forwardLineGuide.redraw())},moveBackwardLineGuide:function(e){this.backwardLineGuide._latlngs.length&&(this.backwardLineGuide._latlngs[1]=e,this.backwardLineGuide.redraw())},anchorForwardLineGuide:function(e){this.forwardLineGuide._latlngs[0]=e,this.forwardLineGuide.redraw()},anchorBackwardLineGuide:function(e){this.backwardLineGuide._latlngs[0]=e,this.backwardLineGuide.redraw()},attachForwardLineGuide:function(){this.editLayer.addLayer(this.forwardLineGuide)},attachBackwardLineGuide:function(){this.editLayer.addLayer(this.backwardLineGuide)},detachForwardLineGuide:function(){this.forwardLineGuide._latlngs=[],this.editLayer.removeLayer(this.forwardLineGuide)},detachBackwardLineGuide:function(){this.backwardLineGuide._latlngs=[],this.editLayer.removeLayer(this.backwardLineGuide)},updateNewClickHandlerZIndex:function(){this._lastZIndex+=2,this.newClickHandler.setZIndexOffset(this._lastZIndex)},registerForDrawing:function(e){this.map.on("mousemove touchmove",e.onMouseMove,e),this._drawingEditor&&this.unregisterForDrawing(this._drawingEditor),this._drawingEditor=e,this.editLayer.addLayer(this.newClickHandler),this.newClickHandler.on("click",e.onNewClickHandlerClicked,e),L.Browser.touch&&this.map.on("click",e.onTouch,e),L.DomUtil.addClass(this.map._container,this.options.drawingCSSClass),this.updateNewClickHandlerZIndex()},unregisterForDrawing:function(e){e=e||this._drawingEditor,this.editLayer.removeLayer(this.newClickHandler),e&&(this.map.off("mousemove touchmove",e.onMouseMove,e),this.newClickHandler.off("click",e.onNewClickHandlerClicked,e),L.Browser.touch&&this.map.off("click",e.onTouch,e),e===this._drawingEditor&&(delete this._drawingEditor,e.drawing&&e.cancelDrawing(),L.DomUtil.removeClass(this.map._container,this.options.drawingCSSClass)))},stopDrawing:function(){this.unregisterForDrawing()},connectCreatedToMap:function(e){return this.featuresLayer.addLayer(e)},startPolyline:function(e,t){var i=this.createPolyline([],t);this.connectCreatedToMap(i);var a=i.enableEdit();return a.startDrawingForward(),e&&a.newPointForward(e),i},startPolygon:function(e,t){var i=this.createPolygon([],t);this.connectCreatedToMap(i);var a=i.enableEdit();return a.startDrawingForward(),e&&a.newPointForward(e),i},startMarker:function(e,t){e=e||this.map.getCenter();var i=this.createMarker(e,t);this.connectCreatedToMap(i);var a=i.enableEdit();return a.startDrawing(),i},startHole:function(e,t){e.newHole(t)},extendMultiPolygon:function(e){var t=this.createPolygon([]);e.addLayer(t),t.multi=e;var i=t.enableEdit();return i.startDrawingForward(),t},createPolyline:function(e,t){t=L.Util.extend({editOptions:{editTools:this}},t);var i=new this.options.polylineClass(e,t);return this.fireAndForward("editable:created",{layer:i}),i},createPolygon:function(e,t){t=L.Util.extend({editOptions:{editTools:this}},t);var i=new this.options.polygonClass(e,t);return this.fireAndForward("editable:created",{layer:i}),i},createMarker:function(e,t){t=L.Util.extend({editOptions:{editTools:this}},t);var i=new this.options.markerClass(e,t);return this.fireAndForward("editable:created",{layer:i}),i}}),L.Map.addInitHook(function(){this.whenReady(function(){this.options.editable!==!1&&(this.editTools=new L.Editable(this,this.options.editOptions))})}),L.Editable.VertexIcon=L.DivIcon.extend({_clazzName:"L.Editable.VertexIcon",options:{iconSize:new L.Point(8,8)}}),L.Editable.TouchVertexIcon=L.Editable.VertexIcon.extend({_clazzName:"L.Editable.TouchVertexIcon",options:{iconSize:new L.Point(20,20)}}),L.Editable.VertexMarker=L.Marker.extend({_clazzName:"L.Editable.VertexMarker",options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon"},initialize:function(e,t,i,a){this.latlng=e,this.latlngs=t,this.editor=i,L.Marker.prototype.initialize.call(this,e,a),this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.latlng.__vertex=this,this.editor.editLayer.addLayer(this),this.setZIndexOffset(i.tools._lastZIndex+1)},onAdd:function(e){L.Marker.prototype.onAdd.call(this,e),this.on("drag",this.onDrag),this.on("dragstart",this.onDragStart),this.on("dragend",this.onDragEnd),this.on("click",this.onClick),this.on("contextmenu",this.onContextMenu),this.on("mousedown touchstart",this.onMouseDown),this.addMiddleMarkers()},onRemove:function(e){this.middleMarker&&this.middleMarker["delete"](),delete this.latlng.__vertex,this.off("drag",this.onDrag),this.off("dragstart",this.onDragStart),this.off("dragend",this.onDragEnd),this.off("click",this.onClick),this.off("contextmenu",this.onContextMenu),this.off("mousedown touchstart",this.onMouseDown),L.Marker.prototype.onRemove.call(this,e)},onDrag:function(e){e.vertex=this,this.editor.onVertexMarkerDrag(e);var t=L.DomUtil.getPosition(this._icon),i=this._map.layerPointToLatLng(t);this.latlng.lat=i.lat,this.latlng.lng=i.lng,this.editor.refresh(),this.middleMarker&&this.middleMarker.updateLatLng();var a=this.getNext();a&&a.middleMarker&&a.middleMarker.updateLatLng()},onDragStart:function(e){e.vertex=this,this.editor.onVertexMarkerDragStart(e)},onDragEnd:function(e){e.vertex=this,this.editor.onVertexMarkerDragEnd(e)},onClick:function(e){e.vertex=this,this.editor.onVertexMarkerClick(e)},onContextMenu:function(e){e.vertex=this,this.editor.onVertexMarkerContextMenu(e)},onMouseDown:function(e){e.vertex=this,this.editor.onVertexMarkerMouseDown(e)},"delete":function(){var e=this.getNext();this.latlngs.splice(this.latlngs.indexOf(this.latlng),1),this.editor.editLayer.removeLayer(this),this.editor.onVertexDeleted({latlng:this.latlng,vertex:this}),e&&e.resetMiddleMarker()},getIndex:function(){return this.latlngs.indexOf(this.latlng)},getLastIndex:function(){return this.latlngs.length-1},getPrevious:function(){if(!(this.latlngs.length<2)){var e=this.getIndex(),t=e-1;0===e&&this.editor.CLOSED&&(t=this.getLastIndex());var i=this.latlngs[t];return i?i.__vertex:void 0}},getNext:function(){if(!(this.latlngs.length<2)){var e=this.getIndex(),t=e+1;e===this.getLastIndex()&&this.editor.CLOSED&&(t=0);var i=this.latlngs[t];return i?i.__vertex:void 0}},addMiddleMarker:function(e){e=e||this.getPrevious(),e&&!this.middleMarker&&(this.middleMarker=this.editor.addMiddleMarker(e,this,this.latlngs,this.editor))},addMiddleMarkers:function(){if(!this.editor.tools.options.skipMiddleMarkers){var e=this.getPrevious();e&&this.addMiddleMarker(e);var t=this.getNext();t&&t.resetMiddleMarker()}},resetMiddleMarker:function(){this.middleMarker&&this.middleMarker["delete"](),this.addMiddleMarker()},_initInteraction:function(){L.Marker.prototype._initInteraction.call(this),L.DomEvent.on(this._icon,"touchstart",function(e){this._fireMouseEvent(e)},this)}}),L.Editable.mergeOptions({vertexMarkerClass:L.Editable.VertexMarker}),L.Editable.MiddleMarker=L.Marker.extend({_clazzName:"L.Editable.MiddleMarker",options:{opacity:.5,className:"leaflet-div-icon leaflet-middle-icon"},initialize:function(e,t,i,a,o){this.left=e,this.right=t,this.editor=a,this.latlngs=i,L.Marker.prototype.initialize.call(this,this.computeLatLng(),o),this._opacity=this.options.opacity,this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.editor.editLayer.addLayer(this);try{this.setVisibility()}catch(n){console.error("err interno MiddleMarker",n)}},setVisibility:function(){var e=this._map.latLngToContainerPoint(this.left.latlng),t=this._map.latLngToContainerPoint(this.right.latlng),i=L.point(this.options.icon.options.iconSize);e.distanceTo(t)<3*i.x?this.hide():this.show()},show:function(){this.setOpacity(this._opacity)},hide:function(){this.setOpacity(0)},updateLatLng:function(){this.setLatLng(this.computeLatLng()),this.setVisibility()},computeLatLng:function(){var e=this.editor.map.latLngToContainerPoint(this.left.latlng),t=this.editor.map.latLngToContainerPoint(this.right.latlng),i=(e.y+t.y)/2,a=(e.x+t.x)/2;return this.editor.map.containerPointToLatLng([a,i])},onAdd:function(e){L.Marker.prototype.onAdd.call(this,e),this.on("mousedown touchstart",this.onMouseDown),e.on("zoomend",this.setVisibility,this)},onRemove:function(e){delete this.right.middleMarker,this.off("mousedown touchstart",this.onMouseDown),e.off("zoomend",this.setVisibility,this),L.Marker.prototype.onRemove.call(this,e)},onMouseDown:function(e){this.editor.onMiddleMarkerMouseDown(e,this),this.latlngs.splice(this.index(),0,e.latlng),this.editor.refresh();var t=this.editor.addVertexMarker(e.latlng,this.latlngs);t.dragging._draggable._onDown(e.originalEvent),this["delete"]()},"delete":function(){this.editor.editLayer.removeLayer(this)},index:function(){return this.latlngs.indexOf(this.right.latlng)},_initInteraction:function(){L.Marker.prototype._initInteraction.call(this),L.DomEvent.on(this._icon,"touchstart",function(e){this._fireMouseEvent(e)},this)}}),L.Editable.mergeOptions({middleMarkerClass:L.Editable.MiddleMarker}),L.Editable.BaseEditor=L.Class.extend({_clazzName:"L.Editable.BaseEditor",initialize:function(e,t,i){L.setOptions(this,i),this.map=e,this.feature=t,this.feature.editor=this,this.editLayer=new L.LayerGroup,this.tools=this.options.editTools||e.editTools},enable:function(){return this._enabled?this:(this.tools.editLayer.addLayer(this.editLayer),this.onEnable(),this._enabled=!0,this.feature.on("remove",this.disable,this),console.warn("habilitando dragging en feature ???? "),this.feature.dragging.enable(),this._getEvents&&this.feature.on(this._getEvents(),this),this)},disable:function(){return this.feature.off("remove",this.disable,this),this.editLayer.clearLayers(),this.tools.editLayer.removeLayer(this.editLayer),this.onDisable(),delete this._enabled,this.drawing&&this.cancelDrawing(),console.info("deshabilitando dragging en feature ???? "),this.feature.dragging.disable(),this},fireAndForward:function(e,t){t=t||{},t.layer=this.feature,this.feature.fire(e,t),this.feature.multi&&this.feature.multi.fire(e,t),this.tools.fireAndForward(e,t)},onEnable:function(){this.fireAndForward("editable:enable")},onDisable:function(){this.fireAndForward("editable:disable")},onEditing:function(){this.fireAndForward("editable:editing")},onStartDrawing:function(){this.fireAndForward("editable:drawing:start")},onEndDrawing:function(){this.fireAndForward("editable:drawing:end")},onCancelDrawing:function(){this.fireAndForward("editable:drawing:cancel")},onCommitDrawing:function(){this.fireAndForward("editable:drawing:commit")},startDrawing:function(){this.drawing||(this.drawing=L.Editable.FORWARD),this.tools.registerForDrawing(this),this.onStartDrawing()},commitDrawing:function(){this.onCommitDrawing(),this.endDrawing()},cancelDrawing:function(){this.onCancelDrawing(),this.endDrawing()},endDrawing:function(){this.drawing=!1,this.tools.unregisterForDrawing(this),this.onEndDrawing()},onMouseMove:function(e){this.drawing&&this.tools.newClickHandler.setLatLng(e.latlng)},onTouch:function(e){this.onMouseMove(e),this.drawing&&this.tools.newClickHandler._fireMouseEvent(e)},onNewClickHandlerClicked:function(e){this.fireAndForward("editable:drawing:click",e)},isNewClickValid:function(e){return!0}}),L.Editable.MarkerEditor=L.Editable.BaseEditor.extend({_clazzName:"L.Editable.MarkerEditor",enable:function(){return this._enabled?this:(L.Editable.BaseEditor.prototype.enable.call(this),this.feature.dragging.enable(),this.feature.on("dragstart",this.onEditing,this),this)},disable:function(){return L.Editable.BaseEditor.prototype.disable.call(this),this.feature.dragging.disable(),this.feature.off("dragstart",this.onEditing,this),this},onMouseMove:function(e){this.drawing&&(L.Editable.BaseEditor.prototype.onMouseMove.call(this,e),this.feature.setLatLng(e.latlng),this.tools.newClickHandler._bringToFront())},onNewClickHandlerClicked:function(e){this.isNewClickValid(e.latlng)&&(L.Editable.BaseEditor.prototype.onNewClickHandlerClicked.call(this,e),this.commitDrawing())}}),L.Editable.PathEditor=L.Editable.BaseEditor.extend({_clazzName:"L.Editable.PathEditor",CLOSED:!1,MIN_VERTEX:2,enable:function(){return this._enabled?this:(L.Editable.BaseEditor.prototype.enable.call(this),this.feature&&this.initVertexMarkers(),this)},disable:function(){return L.Editable.BaseEditor.prototype.disable.call(this)},initVertexMarkers:function(){for(var e=this.getLatLngsGroups(),t=0;t<e.length;t++)this.addVertexMarkers(e[t])},getLatLngsGroups:function(){return[this.getLatLngs()]},getLatLngs:function(){return this.feature.getLatLngs()},reset:function(){this.editLayer.clearLayers(),this.initVertexMarkers()},addVertexMarker:function(e,t){return new this.tools.options.vertexMarkerClass(e,t,this)},addVertexMarkers:function(e){for(var t=0;t<e.length;t++)this.addVertexMarker(e[t],e)},addMiddleMarker:function(e,t,i){return new this.tools.options.middleMarkerClass(e,t,i,this)},onVertexMarkerClick:function(e){var t=e.vertex.getIndex();e.originalEvent.ctrlKey?this.onVertexMarkerCtrlClick(e):e.originalEvent.altKey?this.onVertexMarkerAltClick(e):e.originalEvent.shiftKey?this.onVertexMarkerShiftClick(e):t>=this.MIN_VERTEX-1&&t===e.vertex.getLastIndex()&&this.drawing===L.Editable.FORWARD?this.commitDrawing():0===t&&this.drawing===L.Editable.BACKWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX?this.commitDrawing():0===t&&this.drawing===L.Editable.FORWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX&&this.CLOSED?this.commitDrawing():this.onVertexRawMarkerClick(e)},onVertexRawMarkerClick:function(e){this.vertexCanBeDeleted(e.vertex)&&(e.vertex["delete"](),this.refresh())},vertexCanBeDeleted:function(e){return e.latlngs.length>this.MIN_VERTEX},onVertexDeleted:function(e){this.fireAndForward("editable:vertex:deleted",e)},onVertexMarkerCtrlClick:function(e){this.fireAndForward("editable:vertex:ctrlclick",e)},onVertexMarkerShiftClick:function(e){this.fireAndForward("editable:vertex:shiftclick",e)},onVertexMarkerAltClick:function(e){this.fireAndForward("editable:vertex:altclick",e)},onVertexMarkerContextMenu:function(e){this.fireAndForward("editable:vertex:contextmenu",e)},onVertexMarkerMouseDown:function(e){this.fireAndForward("editable:vertex:mousedown",e)},onMiddleMarkerMouseDown:function(e){this.fireAndForward("editable:middlemarker:mousedown",e)},onVertexMarkerDrag:function(e){this.fireAndForward("editable:vertex:drag",e)},onVertexMarkerDragStart:function(e){this.fireAndForward("editable:vertex:dragstart",e)},onVertexMarkerDragEnd:function(e){this.fireAndForward("editable:vertex:dragend",e)},startDrawing:function(){this._drawnLatLngs||(this._drawnLatLngs=this.getLatLngs()),L.Editable.BaseEditor.prototype.startDrawing.call(this)},startDrawingForward:function(){this.startDrawing(),this.tools.attachForwardLineGuide()},endDrawing:function(){L.Editable.BaseEditor.prototype.endDrawing.call(this),this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),delete this._drawnLatLngs},addLatLng:function(e){this.drawing===L.Editable.FORWARD?this._drawnLatLngs.push(e):this._drawnLatLngs.unshift(e),this.refresh(),this.addVertexMarker(e,this._drawnLatLngs)},newPointForward:function(e){this.addLatLng(e),this.tools.anchorForwardLineGuide(e),this.tools.backwardLineGuide._latlngs[0]||this.tools.anchorBackwardLineGuide(e)},newPointBackward:function(e){this.addLatLng(e),this.tools.anchorBackwardLineGuide(e)},onNewClickHandlerClicked:function(e){this.isNewClickValid(e.latlng)&&(this.drawing===L.Editable.FORWARD?this.newPointForward(e.latlng):this.newPointBackward(e.latlng),L.Editable.BaseEditor.prototype.onNewClickHandlerClicked.call(this,e))},onMouseMove:function(e){this.drawing&&(L.Editable.BaseEditor.prototype.onMouseMove.call(this,e),this.tools.moveForwardLineGuide(e.latlng),this.tools.moveBackwardLineGuide(e.latlng))},refresh:function(){this.feature.redraw(),this.onEditing()},onMove:function(e){this.fireAndForward("editable:drawing:move",e)},_getEvents:function(){return{dragstart:this.onDragStart,drag:this.onDrag,dragend:this.onDragEnd,remove:this.disable}},onDragStart:function(e){this.onEditing(),this.editLayer.clearLayers(),this.fireAndForward("editable:dragstart",e)},onDrag:function(e){this.onMove(e),this.fireAndForward("editable:drag",e)},onDragEnd:function(e){this.initVertexMarkers(),this.fireAndForward("editable:dragend",e)}}),L.Editable.PolylineEditor=L.Editable.PathEditor.extend({_clazzName:"L.Editable.PolylineEditor",startDrawingBackward:function(){this.drawing=L.Editable.BACKWARD,this.startDrawing(),this.tools.attachBackwardLineGuide()},continueBackward:function(){this.tools.anchorBackwardLineGuide(this.getFirstLatLng()),this.startDrawingBackward()},continueForward:function(){this.tools.anchorForwardLineGuide(this.getLastLatLng()),this.startDrawingForward()},getLastLatLng:function(){return this.getLatLngs()[this.getLatLngs().length-1]},getFirstLatLng:function(){return this.getLatLngs()[0]}}),L.Editable.PolygonEditor=L.Editable.PathEditor.extend({_clazzName:"L.Editable.PolygonEditor",CLOSED:!0,MIN_VERTEX:3,getLatLngsGroups:function(){var e=L.Editable.PathEditor.prototype.getLatLngsGroups.call(this);if(this.feature._holes)for(var t=0;t<this.feature._holes.length;t++)e.push(this.feature._holes[t]);return e},startDrawingForward:function(){L.Editable.PathEditor.prototype.startDrawingForward.call(this),this.tools.attachBackwardLineGuide()},addNewEmptyHole:function(){var e=Array();return this.feature._holes||(this.feature._holes=[]),this.feature._holes.push(e),e},newHole:function(e){this._drawnLatLngs=this.addNewEmptyHole(),this.startDrawingForward(),e&&this.newPointForward(e)},checkContains:function(e){return this.feature._containsPoint(this.map.latLngToLayerPoint(e))},vertexCanBeDeleted:function(e){return e.latlngs!==this.getLatLngs()||L.Editable.PathEditor.prototype.vertexCanBeDeleted.call(this,e)},isNewClickValid:function(e){return this._drawnLatLngs===this.getLatLngs()||this.checkContains(e)},onVertexDeleted:function(e){L.Editable.PathEditor.prototype.onVertexDeleted.call(this,e),e.vertex.latlngs.length||e.vertex.latlngs===this.getLatLngs()||this.feature._holes.splice(this.feature._holes.indexOf(e.vertex.latlngs),1)}}),L.Map.mergeOptions({polylineEditorClass:L.Editable.PolylineEditor}),L.Map.mergeOptions({polygonEditorClass:L.Editable.PolygonEditor}),L.Map.mergeOptions({markerEditorClass:L.Editable.MarkerEditor});var b={createEditor:function(e){e=e||this._map;var t=this.options.editorClass||this.getEditorClass(e);return new t(e,this,this.options.editOptions)},enableEdit:function(){return console.warn("enabling edition ... "),this.editor||this.createEditor(),this.multi&&this.multi.onEditEnabled(),this.editor.enable()},editEnabled:function(){return this.editor&&this.editor._enabled},disableEdit:function(){this.editor&&(this.multi&&this.multi.onEditDisabled(),this.editor.disable(),delete this.editor)},toggleEdit:function(){this.editEnabled()?this.disableEdit():this.enableEdit()}};L.Polyline.include(b),L.Polygon.include(b),L.Marker.include(b),L.Polyline.include({_containsPoint:function(e,t){var i,a,o,n,r,s,l,c=this.options.weight/2;for(L.Browser.touch&&(c+=10),i=0,n=this._parts.length;i<n;i++)for(l=this._parts[i],a=0,r=l.length,o=r-1;a<r;o=a++)if((t||0!==a)&&(s=L.LineUtil.pointToSegmentDistance(e,l[o],l[a]),s<=c))return!0;return!1},getEditorClass:function(e){return e.options.polylineEditorClass}}),L.Polygon.include({_containsPoint:function(e){var t,i,a,o,n,r,s,l,c=!1;if(L.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(o=0,s=this._parts.length;o<s;o++)for(t=this._parts[o],n=0,l=t.length,r=l-1;n<l;r=n++)i=t[n],a=t[r],i.y>e.y!=a.y>e.y&&e.x<(a.x-i.x)*(e.y-i.y)/(a.y-i.y)+i.x&&(c=!c);return c},getEditorClass:function(e){return e.options.polygonEditorClass}}),L.Marker.include({getEditorClass:function(e){return e.options.markerEditorClass}});var w={enableEdit:function(){this.eachLayer(function(e){e.multi=this,e.enableEdit()},this)},disableEdit:function(){this.eachLayer(function(e){e.disableEdit()})},toggleEdit:function(e){e.layer.editor?this.disableEdit():this.enableEdit(e)},onEditEnabled:function(){this._editEnabled||(this._editEnabled=!0,this.fire("editable:multi:edit:enabled"))},onEditDisabled:function(){this._editEnabled&&(this._editEnabled=!1,this.fire("editable:multi:edit:disabled"))},editEnabled:function(){return!!this._editEnabled}};L.MultiPolygon.include(w),L.MultiPolyline.include(w),function(){function t(){var e=document.createElement("style");e.type="text/css",e.innerHTML=".leaflet-control-easyPrint a {background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMiA1MTI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPGc+Cgk8cGF0aCBkPSJNMTI4LDMyaDI1NnY2NEgxMjhWMzJ6IE00ODAsMTI4SDMyYy0xNy42LDAtMzIsMTQuNC0zMiwzMnYxNjBjMCwxNy42LDE0LjM5OCwzMiwzMiwzMmg5NnYxMjhoMjU2VjM1Mmg5NiAgIGMxNy42LDAsMzItMTQuNCwzMi0zMlYxNjBDNTEyLDE0Mi40LDQ5Ny42LDEyOCw0ODAsMTI4eiBNMzUyLDQ0OEgxNjBWMjg4aDE5MlY0NDh6IE00ODcuMTk5LDE3NmMwLDEyLjgxMy0xMC4zODcsMjMuMi0yMy4xOTcsMjMuMiAgIGMtMTIuODEyLDAtMjMuMjAxLTEwLjM4Ny0yMy4yMDEtMjMuMnMxMC4zODktMjMuMiwyMy4xOTktMjMuMkM0NzYuODE0LDE1Mi44LDQ4Ny4xOTksMTYzLjE4Nyw0ODcuMTk5LDE3NnoiIGZpbGw9IiMwMDAwMDAiLz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K);background-size:16px 16px;cursor: pointer;}._epHidden{display:none!important;}@media print {html {padding: 0px!important;}.leaflet-control-easyPrint-button{display: none!important;}}",document.body.appendChild(e)}if(!e.L)throw new Error("EasyPrint needs Leaflet");L.Control.EasyPrint=L.Control.extend({options:{title:"Print map",position:"topleft"},printPage:function(){var t;if(this.options.elementsToHide){t=document.querySelectorAll(this.options.elementsToHide);for(var i=0;i<t.length;i++)t[i].className=t[i].className+" _epHidden"}if(this._map.fire("beforePrint"),e.print(),this._map.fire("afterPrint"),this.options.elementsToHide){t=document.querySelectorAll(this.options.elementsToHide);for(var a=0;a<t.length;a++)t[a].className=t[a].className.replace(" _epHidden","")}},onAdd:function(){var e=L.DomUtil.create("div","leaflet-control-easyPrint leaflet-bar leaflet-control");return this.link=L.DomUtil.create("a","leaflet-control-easyPrint-button leaflet-bar-part",e),this.link.id="leafletEasyPrint",this.link.title=this.options.title,L.DomEvent.addListener(this.link,"click",this.printPage,this),L.DomEvent.disableClickPropagation(e),e}}),L.easyPrint=function(e){return t(),new L.Control.EasyPrint(e)}}(),L.PathDraggable=L.Draggable.extend({initialize:function(e){this._path=e,this._canvas=e._map.getRenderer&&e._map.getRenderer(e)instanceof L.Canvas;var t=this._canvas?this._path._map.getRenderer(this._path)._container:this._path._path;L.Draggable.prototype.initialize.call(this,t,t,!0)},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("drag",e)},_onDown:function(e){var t=e.touches?e.touches[0]:e;this._startPoint=new L.Point(t.clientX,t.clientY),this._canvas&&!this._path._containsPoint(this._path._map.mouseEventToLayerPoint(t))||L.Draggable.prototype._onDown.call(this,e)}}),L.Handler.PathDrag=L.Handler.extend({initialize:function(e){this._path=e},getEvents:function(){return{dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd}},addHooks:function(){this._draggable||(this._draggable=new L.PathDraggable(this._path)),this._draggable.on(this.getEvents(),this).enable(),L.DomUtil.addClass(this._draggable._element,"leaflet-path-draggable")},removeHooks:function(){this._draggable.off(this.getEvents(),this).disable(),L.DomUtil.removeClass(this._draggable._element,"leaflet-path-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._startPoint=this._draggable._startPoint,this._path.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(e){var t=this._path,i=e.originalEvent.touches&&1===e.originalEvent.touches.length?e.originalEvent.touches[0]:e.originalEvent,a=L.point(i.clientX,i.clientY),o=t._map.layerPointToLatLng(a);this._offset=a.subtract(this._startPoint),this._startPoint=a,this._path.eachLatLng(this.updateLatLng,this),t.redraw(),e.latlng=o,e.offset=this._offset,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){this._path._bounds&&this.resetBounds(),this._path.fire("moveend").fire("dragend",e)},latLngToLayerPoint:function(e){var t=this._path._map.project(L.latLng(e));return t._subtract(this._path._map.getPixelOrigin())},updateLatLng:function(e){var t=this.latLngToLayerPoint(e);t._add(this._offset);var i=this._path._map.layerPointToLatLng(t);e.lat=i.lat,e.lng=i.lng},resetBounds:function(){this._path._bounds=new L.LatLngBounds,this._path.eachLatLng(function(e){this._bounds.extend(e)})}}),L.Path.include({eachLatLng:function(e,t){t=t||this;var i=function(a){for(var o=0;o<a.length;o++)L.Util.isArray(a[o])?i(a[o]):e.call(t,a[o])};i(this.getLatLngs?this.getLatLngs():[this.getLatLng()])}}),L.Path.addInitHook(function(){this.dragging=new L.Handler.PathDrag(this),this.options.draggable&&this.once("add",function(){this.dragging.enable()})}),function(){function e(e,t,i){var a=new XMLHttpRequest;a.open("GET",e),a.onload=function(){if(a.status>=200&&a.status<300){var o=a.response;"{"===o[0]?t(o):i("Invalid json. Expected start with '{'. Response start with: "+o.substring(0,20))}else i("Invalid request for "+e,a.statusText)},a.onerror=function(){i(a.statusText)},a.send(null)}if(L.Map){var t="",i="";L.TileLayer.DEFAULT_LS_KEY="currentlocaltiles",L.TileLayer.LOCAL_MAX_VIEW_ZOOM=16;var a=L.TileLayer.prototype.initialize;L.TileLayer.prototype.initialize=function(){a.apply(this,arguments);var e=arguments[0]||"__",t=e.split("_"),i=t[1];if("$local"===i&&(this.options.maxNativeZoom=L.TileLayer.LOCAL_MAX_VIEW_ZOOM,this.options.minZoom=4,this._isLocalLayer=!0,!this._localTiles)){var o=t[2]||L.TileLayer.DEFAULT_LS_KEY,n=localStorage.getItem(o);if(this._isUsingLocalTiles=!0,n)console.info("Detected offline layer from localStorage: "+o),this.changeTileDataFromJson(n);else{console.info("Detected offline layer: "+o);var r="./sampledata/tiles-"+o+".json";this.changeTileDataFromUrl(r)}}this._url&&this._url.indexOf("172.")>0&&this._url.indexOf("smara/")&&(this._defaultView={zoom:16,center:{lat:26.742,lng:-11.7006}})},L.Control.Layers.include({setLocalTilesFromLocalstorage:function(e){var t=localStorage.getItem(e);t&&this._localLayer&&(this._localLayer.changeTileDataFromJson(t),this._map.update())},setLocalTilesFromUrl:function(e){e&&this._localLayer&&(this._localLayer.changeTileDataFromUrl(e),this._map.update())}}),L.TileLayer.prototype.changeTileDataFromUrl=function(t){if(!this._isLocalLayer)throw"This layer is not a Local TileLayer";var i=this;e(t,function(e){try{var a=i._localTiles=JSON.parse(e),o=0;for(var n in a)o+=n.indexOf("/")>0?1:0;console.info("Loaded tiles offline: "+t+"\n Tile count:"+o+"\n Map View: ",a.mapview)}catch(r){console.info("Fail parsing json file container of tiles: "+t+"\n",r)}},function(e){console.info("Fail response. "+t,e)})},L.TileLayer.prototype.changeTileDataFromJson=function(e){try{var t=this._localTiles=JSON.parse(e),i=0;for(var a in t)i+=a.indexOf("/")>0?1:0;console.info("Loaded tiles offline from localstorage\n Tile count:"+i+"\n Map View: ",t.mapview)}catch(o){console.info("Fail parsing json content \n",o)}},L.TileLayer.prototype.getHomeInfo=function(){return this._isUsingLocalTiles?this._localTiles&&this._localTiles.mapview||{}:this._defaultView||{}};var o=L.TileLayer.prototype.getTileUrl;L.TileLayer.prototype.getTileUrl=function(e){if(!this._isUsingLocalTiles)return this._url||(this._url="//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),o.apply(this,arguments);var a=L.Util.template(this._url,L.extend({s:this._getSubdomain(e),z:e.z,x:e.x,y:e.y},this.options)),n=a.split("_")[3];if(n){n=n.split(".")[0];var r=this._localTiles&&(this._localTiles[n]||i)||t;return r}},L.TileLayer.getJson=e}}(),function(){function t(e,t){function i(e,t,i){var a="data:image/"+t+";base64,",o=new Blob([e],{type:"application/octet-binary"}),n=new FileReader;n.onload=function(e){var t=e.target.result.split(",");if(t[0].startsWith("data")){var o=a+t[1];i(o)}else console.error("interval error: invalid data as base64")},n.readAsDataURL(o)}this.key=e,this.url=t,this.data=null,this.load=function(e,a){var o=this,n=this.url.split("."),r=1===n.length?"png":n[n.length-1],s=new XMLHttpRequest;s.responseType="arraybuffer",s.open("GET",t),s.onload=function(){s.status>=200&&s.status<300?i(s.response,r,function(t){o.data=t,e(o)}):a("not found "+t,s.statusText)},s.onerror=function(){a(s.statusText)},s.send(null)}}function i(t){var i=t&&t._map;if(!i)return void console.error("Error interno. Falta referencia a mapa en Control LocalTileControl");var o=i.getZoom();if(o<n)return void alert("Zoom demasiado lejano: "+o+"\nAl menos debe ser "+n);var r=6,s=17,l=a(r,s,i),c=e.confirm("WARN: Current stored tiles will be deleted. \nThen, it will be loaded "+l._tileInfos.length+" tiles replacing old tiles for offset navigation","Offline tile replacement");if(c!==!1){var d=prompt("Enter 'new' word of a name for searching in public/sampledata/files-NAME.json \n (salonica25, smara, smara-topo)","new");if(d){if("new"===d){t.disable();var u=l._tileInfos,p=L.TileLayer.DEFAULT_LS_KEY;l.startLoading({},function(){t.setProgressText("OK: "+l._tileInfos.length+" tiles");var e=l.tileSetToJson();console.info("Json tileSet have a size in bytes of "+e.length);var i=localStorage.getItem(p);try{localStorage.removeItem(p),localStorage.setItem(p,e),alert("local tiles downloaded: "+u.length),t._refresDefaultLocalLayer(e),console.info("local base layer refreshed")}catch(a){i&&localStorage.setItem(p,i),alert("Error saving tileSet in localstorage\n\n"+a.message);try{var o=new Blob([e],{type:"text/JSON"});L.Util.saveAs(o,p+".json"),alert("WARN. json has been downloaded in local folder")}catch(n){alert("Error saving tileSet in local folder\n\n"+n.message)}}t.enable()},function(e,i,a){var o=a-e;t.setProgressText("Left "+o)})}else{var h="./sampledata/tiles-"+d+".json";
console.info("Probando cargar tiles desde "+h);var f=i._mainLayerControl._localLayer;f&&f.changeTileDataFromUrl(h)}console.error("AVISO. Sin implementar reseteado de tiles para navegaci√≥n offline")}}}function a(e,t,i){if(!i._mainLayerControl)return void console.error("Invalid leaflet. No mainLayercontrol found");if(!i._mainLayerControl._localLayer)return void console.error("Invalid leaflet. No locallayer defined");var a=i._mainLayerControl._localLayer,n=o(i),r=((new Date).getMilliseconds(),new L.LocalTileSet(a,n));return r.updateTileRange(e,t,i),r}function o(e){var t=null;for(var i in e._layers){var a=e._layers[i];a instanceof L.TileLayer&&null===t&&(t=a)}return t}if(L.Map){var n=12;L.LocalTileSet=L.Class.extend({options:{},_refTileLayer:null,_localTileLayer:null,_zoom:null,_center:null,_tileInfos:[],tileSetToJson:function(){var e=this._center.lat||this._center[1]||0,t=this._center.lng||0|this._center[0],i={};i.mapview={zoom:this._zoom,center:{lat:e,lng:t}};for(var a=0;a<this._tileInfos.length;a+=1){var o=this._tileInfos[a];i[o.key]=o.data}return JSON.stringify(i,null,2)},initialize:function(e,t){if(this._localTileLayer=e,!(t instanceof L.TileLayer))throw"argument exception: it is needed a TileLayer";this._refTileLayer=t},updateTileRange:function(e,t,i){this._center=i.getCenter(),this._zoom=i.getZoom(),this._tileInfos=[];for(var a=i.getBounds(),o=e;o<=t;o+=1){var n=this.getPixelBounds(i,o,a),r=this._refTileLayer._getTileSize(),s=L.bounds(n.min.divideBy(r)._floor(),n.max.divideBy(r)._floor()),l=this._getTileInfosFrom(s,o);this._tileInfos=this._tileInfos.concat(l)}},_getTileInfosFrom:function(e,i){var a,o,n,r=[],s=e.getCenter();for(a=e.min.y;a<=e.max.y;a++)for(o=e.min.x;o<=e.max.x;o++)n=new L.Point(o,a),r.push(n);var l=r.length;if(console.info("Descarga desde zoom: "+i+", cantidad: "+l),0===l)return[];r.sort(function(e,t){return e.distanceTo(s)-t.distanceTo(s)});var c=[];for(o=0;o<l;o++){var d=r[o];d.z=i;var u=d.z+"/"+d.x+"/"+d.y,p=this._refTileLayer.getTileUrl(d);this._tileInfos.push(new t(u,p)),console.info("* Tile desde: "+p)}return c},startLoading:function(e,t,i){function a(){s-=1,s<=0&&t()}function o(){this.success=function(){i(l+1,c,r),l+=1,a()},this.reject=function(){a()}}for(var n=this._tileInfos,r=n.length,s=r,l=0,c=0,d=new o,u=0;u<r;u+=1){var p=n[u];p.load(d.success,d.reject)}console.info("Downloading started for bb centered in "+this.center)},getPixelBounds:function(e,t,i){var a=(e.options.crs.latLngToPoint(i.getSouthWest(),t),this.project(e,t,i.getSouthWest())),o=this.project(e,t,i.getNorthEast());return new L.Bounds(a,o)},project:function(e,t,i){return e.options.crs.latLngToPoint(L.latLng(i),t)},getTileCount:function(){this._tileInfos.length},_0:""}),L.Control.LocalTileControl=L.Control.extend({options:{title:"Reset Local base tile layer",position:"topright"},onAdd:function(){var e=L.DomUtil.create("div","leaflet-control-localtiles leaflet-bar leaflet-control");e.style.position="relative";var t=this;return this.progressLabel=L.DomUtil.create("div","leaflet-control-localtiles-progress leaflet-bar-part",e),this.progressLabel.style.position="absolute",this.progressLabel.style.display="none",this.progressLabel.style.right="36px",this.progressLabel.style.left="auto",this.progressLabel.style.width="70px",this.progressLabel.style.textAlign="center",this.progressLabel.style["float"]="left",this.progressLabel.style.backgroundColor="#e0e0e0",this.progressLabel.style.color="#ff7040",this.link=L.DomUtil.create("a","leaflet-control-localtiles-button leaflet-bar-part",e),this.link.title=this.options.title,L.DomEvent.addListener(this.link,"click",function(){i(t)},this),L.DomEvent.disableClickPropagation(e),e},disable:function(){this.link.classList.add("leaflet-disabled"),this.progressLabel.style.display="block",this.progressLabel.innerHTML="downloading..."},enable:function(){this.link.classList.remove("leaflet-disabled"),this.progressLabel.style.display="none"},setProgressText:function(e){this.progressLabel.innerHTML=e},resetTiles:function(){i.apply(this,arguments)},_refresDefaultLocalLayer:function(e){var t=this._map._mainLayerControl;if(!t)return void console.error("this map is not a UX map. Not found mainLayerControl");var i=this._map._mainLayerControl._localLayer;i&&(i.changeTileDataFromJson(e),this._map.setZoom(this._map.getZoom()))}}),L.LocalTileSet.MIN_DOWNLOAD_ZOOM=n,L.Control.LocalTileControl.recalculateTileset=a,L.Map.mergeOptions({localtiles:!1}),L.Map.addInitHook(function(){if(this.options.localtiles){var e="localtiles",t="string"==typeof this.options.localtiles?this.options.localtiles:this.options.localtiles.urlName||e;this.positionControl=new L.Control.LocalTileControl({keyname:t}),this.addControl(this.positionControl)}})}}(),L.Map.mergeOptions({zooms:t}),L.Map.include({_limitZoom:function(e){var t,i=this.options.zooms;if(i&&"length"in i&&i.length){var a,o,n,r=100,s=-1,l=100,c=e-this._zoom;for(t=L.Browser.any3d?this.options.zoomSnap:1,t&&(e=Math.round(e/t)*t),o=0;o<i.length;o++)n=Math.abs(i[o]-e),n<r&&(a=i[o],r=n),c*(i[o]-this._zoom)>0&&n<l&&(s=i[o],l=n);return s<0?a:s}var d=this.getMinZoom(),u=this.getMaxZoom();return t=L.Browser.any3d?this.options.zoomSnap:1,t&&(e=Math.round(e/t)*t),Math.max(d,Math.min(u,e))}}),L.Evented=L.Class.extend({on:function(e,t,i){if("object"==typeof e)for(var a in e)this._on(a,e[a],t);else{e=L.Util.splitWords(e);for(var o=0,n=e.length;o<n;o++)this._on(e[o],t,i)}return this},off:function(e,t,i){if(e)if("object"==typeof e)for(var a in e)this._off(a,e[a],t);else{e=L.Util.splitWords(e);for(var o=0,n=e.length;o<n;o++)this._off(e[o],t,i)}else delete this._events;return this},_on:function(e,i,a){this._events=this._events||{};var o=this._events[e];o||(o=[],this._events[e]=o),a===this&&(a=t);for(var n={fn:i,ctx:a},r=o,s=0,l=r.length;s<l;s++)if(r[s].fn===i&&r[s].ctx===a)return;r.push(n)},_off:function(e,i,a){var o,n,r;if(this._events&&(o=this._events[e])){if(!i){for(n=0,r=o.length;n<r;n++)o[n].fn=L.Util.falseFn;return void delete this._events[e]}if(a===this&&(a=t),o)for(n=0,r=o.length;n<r;n++){var s=o[n];if(s.ctx===a&&s.fn===i)return s.fn=L.Util.falseFn,this._firingCount&&(this._events[e]=o=o.slice()),void o.splice(n,1)}}},fire:function(e,t,i){if(!this.listens(e,i))return this;var a=L.Util.extend({},t,{type:e,target:this});if(this._events){var o=this._events[e];if(o){this._firingCount=this._firingCount+1||1;for(var n=0,r=o.length;n<r;n++){var s=o[n];s.fn.call(s.ctx||this,a)}this._firingCount--}}return i&&this._propagateEvent(a),this},listens:function(e,t){var i=this._events&&this._events[e];if(i&&i.length)return!0;if(t)for(var a in this._eventParents)if(this._eventParents[a].listens(e,t))return!0;return!1},once:function(e,t,i){if("object"==typeof e){for(var a in e)this.once(a,e[a],t);return this}var o=L.bind(function(){this.off(e,t,i).off(e,o,i)},this);return this.on(e,t,i).on(e,o,i)},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[L.stamp(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[L.stamp(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,L.extend({layer:e.target},e),!0)}});var k=L.Evented.prototype;k.addEventListener=k.on,k.removeEventListener=k.clearAllEventListeners=k.off,k.addOneTimeEventListener=k.once,k.fireEvent=k.fire,k.hasEventListeners=k.listens,L.Mixin={Events:k},function(){return L.Control?(L.Editable.VertexIcon.prototype.options.iconSize=new L.Point(14,14),L.Control.UxEdition=L.Control.extend({options:{position:"topleft",addPolygonText:"",addPolylineText:"",addMarkerText:"",deleteGeomText:"",onFeatureCommited:null,cssClass:""},onAdd:function(e){var t=L.DomUtil.create("div","leaflet-control leaflet-bar"),i=[L.NewPolygonControl,L.DeleteGeomControl];this._buttons=[];for(var a=0;a<i.length;a++){var o=i[a],n=new o;n.onFeatureCommitedListener=this.options.onFeatureCommited,this._buttons.push(n),t.appendChild(n._createLink(e))}return t},setLayer:function(e){for(var t=0;t<this._buttons.length;t++)this._buttons[t].layerGroup=e;for(var i in e){var a=e[i];a.enableEdit&&(a.enableEdit(),a.on("dblclick",L.DomEvent.stop).on("dblclick",this.toggleEdit))}}}),L.BaseEditControl=L.Control.extend({options:{position:"topleft",title:"Edit control",innerText:"o"},_commitedAction:"added",layerGroup:t,onAdd:function(e){this._map=e;var t=L.DomUtil.create("div","leaflet-control leaflet-bar"),i=this._createLink(e);return t.appendChild(i),t},isActive:function(){return this._link&&this._link.classList.contains("active")},setActive:function(t){if(t){this._link.setAttribute("title",this.options.cancelTitle),this._link.classList.add("active");var i=e.getComputedStyle(this._link).color;this._link.style.backgroundColor=i,this._link.style.color="#ffffff"}else this._link.setAttribute("title",this.options.title),this._link.classList.remove("active"),this._link.style.backgroundColor="",this._link.style.color=""},_createLink:function(e){var t=L.DomUtil.create("a",this.options.cssClass||"");t.href="#",t.title=this.options.title,t.innerHTML=this.options.innerText,this._link=t;var i=this;return L.DomEvent.on(t,"click",L.DomEvent.stop).on(t,"click",function(){var t=i._onClick(e),a=t&&t._leaflet_id;a&&(i.layerGroup[a]=t)}),this._link=t,t},_onClick:null,_toggle:function(){var e=!this.isActive();return this.setActive(e),console.debug("starting tool from: "+this.options.title),e},_featureCommitted:function(e){e.action=this._commitedAction,console.info("feature commited ",e),this.onFeatureCommitedListener&&this.onFeatureCommitedListener(e)},onFeatureCommitedListener:null,_featureCanceled:function(e){var t=e._leaflet_id;if(!e._deleting){e._deleting=!0;var i=e._map;i.removeLayer(e),i._onResize(),delete this.layerGroup[t]}}}),L.DeleteGeomControl=L.BaseEditControl.extend({options:{title:"Delete geometries",cancelTitle:"Stop deletiing",innerText:"Ôá∏",cssClass:"delete-edit-control"},_commitedAction:"deleted",_onClick:function(e){var t=this._toggle();for(var i in this.layerGroup){var a=this.layerGroup[i];t?this._addOnclick(a):this._removeOnclick(a)}},_addOnclick:function(e){if(e.editor){var i=this;e.on("click",L.DomEvent.stop).on("click",function(){var e=this._leaflet_id;if(e!==t){var a=this._map;a.removeLayer(this),a._onResize(),delete i.layerGroup[e],i._featureCommitted({layer:this}),console.debug("deleted feature "+e)}else console.warn("clicked object is not a leaflet layer: "+this)},e)}},_removeOnclick:function(e){e.editor&&e.off("click",L.DomEvent.stop).off("click")}}),L.NewLineControl=L.BaseEditControl.extend({options:{title:"Create a new line",cancelTitle:"Cancel line",innerText:"\\/\\",cssClass:"newline-edit-control"},_onClick:function(e){this._toggle();return e.editTools.startPolyline()}}),L.NewPolygonControl=L.BaseEditControl.extend({options:{title:"Create a new polygon",cancelTitle:"Cancel polygon",innerText:"‚ñ∞",cssClass:"newpolygon-edit-control"},_onClick:function(e){var t=this._toggle();if(t){var i=e.editTools.startPolygon();return i.on("editable:drawing:commit",this._featureCommitted,this),i.on("editable:drawing:commit",function(e){this.setActive(!1)},this),i.on("editable:drawing:cancel",function(e){this.setActive(!1),this._featureCanceled(i)},this),i}e.editTools.stopDrawing()}}),void(L.NewMarkerControl=L.BaseEditControl.extend({options:{title:"Add a new marker",cancelTitle:"Cancel marker",innerText:"üñà",cssClass:"newmarker-edit-control"},_onClick:function(e){this._toggle();return e.editTools.startMarker()}}))):void console.error("L.Control.Edition requires Leaflet")}(),L.Class.prototype.toString=function(){return"Class: "+this._clazzName},L.Map.prototype._clazzName="Map",L.Polygon.prototype._clazzName="Polygon",L.Polygon.prototype.toString=function(){return L.Polyline.prototype.toString.call(this)+" "+JSON.stringify(this._latlng)},L.Circle.prototype._clazzName="Circle",L.Point.prototype._clazzName="Point",L.Path.prototype._clazzName="Path",L.Marker.prototype._clazzName="Marker",L.Polyline.prototype._clazzName="Polyline",L.Browser.svg?L.Path.include({_resetTransform:function(){this._container.setAttributeNS(null,"transform","")},_applyTransform:function(e){this._container.setAttributeNS(null,"transform","matrix("+e.join(" ")+")")}}):L.Path.include({_resetTransform:function(){this._skew&&(this._skew.on=!1,this._container.removeChild(this._skew),this._skew=null)},_applyTransform:function(e){var t=this._skew;t||(t=this._createElement("skew"),this._container.appendChild(t),t.style.behavior="url(#default#VML)",this._skew=t);var i=e[0].toFixed(8)+" "+e[1].toFixed(8)+" "+e[2].toFixed(8)+" "+e[3].toFixed(8)+" 0 0",a=Math.floor(e[4]).toFixed()+", "+Math.floor(e[5]).toFixed(),o=this._container.style,n=parseFloat(o.left),r=parseFloat(o.top),s=parseFloat(o.width),l=parseFloat(o.height);isNaN(n)&&(n=0),isNaN(r)&&(r=0),!isNaN(s)&&s||(s=1),!isNaN(l)&&l||(l=1);var c=(-n/s-.5).toFixed(8)+" "+(-r/l-.5).toFixed(8);t.on="f",t.matrix=i,t.origin=c,t.offset=a,t.on=!0}}),L.Path.include({_onMouseClick:function(e){this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(e)}}),L.Handler.PathDrag=L.Handler.extend({initialize:function(e){this._path=e,this._matrix=null,this._startPoint=null,this._dragStartPoint=null},addHooks:function(){this._path.on("mousedown",this._onDragStart,this),L.DomUtil.addClass(this._path._container,"leaflet-path-draggable")},removeHooks:function(){this._path.off("mousedown",this._onDragStart,this),L.DomUtil.removeClass(this._path._container,"leaflet-path-draggable")},moved:function(){return this._path._dragMoved},_onDragStart:function(e){this._startPoint=e.containerPoint.clone(),this._dragStartPoint=e.containerPoint.clone(),this._matrix=[1,0,0,1,0,0],this._path._map.on("mousemove",this._onDrag,this).on("mouseup",this._onDragEnd,this),this._path._dragMoved=!1},_onDrag:function(e){var t=e.containerPoint.x,i=e.containerPoint.y,a=t-this._startPoint.x,o=i-this._startPoint.y;this._path._dragMoved||!a&&!o||(this._path._dragMoved=!0,this._path.fire("dragstart")),this._matrix[4]+=a,this._matrix[5]+=o,this._startPoint.x=t,this._startPoint.y=i,this._path._applyTransform(this._matrix),this._path.fire("drag"),L.DomEvent.stop(e.originalEvent)},_onDragEnd:function(e){L.DomEvent.stop(e),this._path._resetTransform(),this._transformPoints(this._matrix),this._path._map.off("mousemove",this._onDrag,this).off("mouseup",this._onDragEnd,this),this._path.fire("dragend",{distance:Math.sqrt(L.LineUtil._sqDist(this._dragStartPoint,e.containerPoint))}),this._matrix=null,this._startPoint=null,this._dragStartPoint=null},_transformPoints:function(e){var t,i,a,o=this._path,n=L.point(e[4],e[5]),r=o._map.options.crs,s=r.transformation,l=r.scale(o._map.getZoom()),c=r.projection,d=s.untransform(n,l).subtract(s.untransform(L.point(0,0),l));if(o._point)o._latlng=c.unproject(c.project(o._latlng)._add(d)),o._point._add(n);else if(o._originalPoints)for(t=0,i=o._originalPoints.length;t<i;t++)a=o._latlngs[t],o._latlngs[t]=c.unproject(c.project(a)._add(d)),o._originalPoints[t]._add(n);if(o._holes)for(t=0,i=o._holes.length;t<i;t++)for(var u=0,p=o._holes[t].length;u<p;u++)a=o._holes[t][u],o._holes[t][u]=c.unproject(c.project(a)._add(d)),o._holePoints[t][u]._add(n);o._updatePath()}}),L.Path.prototype.__initEvents=L.Path.prototype._initEvents,L.Path.prototype._initEvents=function(){this.__initEvents(),this.options.draggable?this.dragging?this.dragging.enable():(this.dragging=new L.Handler.PathDrag(this),this.dragging.enable()):this.dragging&&this.dragging.disable()},function(){function e(e,t,i){for(var a=0,o=e.length;a<o;a++){var n=e[a];n.prototype["_"+t]=n.prototype[t],n.prototype[t]=i}}L.FeatureGroup.EVENTS+=" dragstart";var t={addLayer:function(e){return this.hasLayer(e)?this:(e.on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._addLayer.call(this,e))},removeLayer:function(e){return this.hasLayer(e)?(e.off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._removeLayer.call(this,this)):this}};e([L.MultiPolygon,L.MultiPolyline],"addLayer",t.addLayer),e([L.MultiPolygon,L.MultiPolyline],"removeLayer",t.removeLayer);var i={_onDrag:function(e){var t=e.target;this.eachLayer(function(e){e!==t&&e._applyTransform(t.dragging._matrix)}),this._propagateEvent(e)},_onDragEnd:function(e){var t=e.target;this.eachLayer(function(e){e!==t&&(e._resetTransform(),e.dragging._transformPoints(t.dragging._matrix))}),this._propagateEvent(e)}};L.MultiPolygon.include(i),L.MultiPolyline.include(i)}(),L.Polygon.include({getCenter:function(){var e,t,i,a,o,n,r,s,l,c=this._parts[0];for(r=s=l=0,e=0,i=c.length,t=i-1;e<i;t=e++)a=c[e],o=c[t],n=a.y*o.x-o.y*a.x,s+=(a.x+o.x)*n,l+=(a.y+o.y)*n,r+=3*n;return this._map.layerPointToLatLng([s/r,l/r])}}),L.EditToolbar.Edit.MOVE_MARKERS=!1,L.EditToolbar.Edit.include({initialize:function(e,t){L.EditToolbar.Edit.MOVE_MARKERS=!!t.selectedPathOptions.moveMarkers,this._initialize(e,t)},_initialize:L.EditToolbar.Edit.prototype.initialize}),L.Edit.SimpleShape.include({_updateMoveMarker:function(){this._moveMarker&&this._moveMarker.setLatLng(this._getShapeCenter())},_getShapeCenter:function(){return this._shape.getBounds().getCenter()},_createMoveMarker:function(){L.EditToolbar.Edit.MOVE_MARKERS&&(this._moveMarker=this._createMarker(this._getShapeCenter(),this.options.moveIcon))}}),L.Edit.SimpleShape.mergeOptions({moveMarker:!1}),L.Edit.Circle.include({addHooks:function(){this._shape._map&&(this._map=this._shape._map,this._markerGroup||(this._enableDragging(),this._initMarkers()),this._shape._map.addLayer(this._markerGroup))},removeHooks:function(){if(this._shape._map){for(var e=0,t=this._resizeMarkers.length;e<t;e++)this._unbindMarker(this._resizeMarkers[e]);this._disableDragging(),this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},_createMoveMarker:L.Edit.SimpleShape.prototype._createMoveMarker,_resize:function(e){var t=this._shape.getLatLng(),i=t.distanceTo(e);this._shape.setRadius(i),this._updateMoveMarker()},_enableDragging:function(){this._shape.dragging||(this._shape.dragging=new L.Handler.PathDrag(this._shape)),this._shape.dragging.enable(),this._shape.on("dragstart",this._onStartDragFeature,this).on("dragend",this._onStopDragFeature,this)},_disableDragging:function(){this._shape.dragging.disable(),this._shape.off("dragstart",this._onStartDragFeature,this).off("dragend",this._onStopDragFeature,this)},_onStartDragFeature:function(){this._shape._map.removeLayer(this._markerGroup),this._shape.fire("editstart")},_onStopDragFeature:function(){var e=this._shape.getLatLng();this._resizeMarkers[0].setLatLng(this._getResizeMarkerPoint(e)),this._shape._map.addLayer(this._markerGroup),this._updateMoveMarker(),this._fireEdit()}}),L.Edit.Rectangle.include({addHooks:function(){this._shape._map&&(this._markerGroup||(this._enableDragging(),this._initMarkers()),this._shape._map.addLayer(this._markerGroup))},removeHooks:function(){this._shape._map&&(this._shape._map.removeLayer(this._markerGroup),this._disableDragging(),delete this._markerGroup,delete this._markers)},_resize:function(e){this._shape.setBounds(L.latLngBounds(e,this._oppositeCorner)),this._updateMoveMarker()},_onMarkerDragEnd:function(e){this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,e)},_enableDragging:function(){this._shape.dragging||(this._shape.dragging=new L.Handler.PathDrag(this._shape)),this._shape.dragging.enable(),this._shape.on("dragstart",this._onStartDragFeature,this).on("dragend",this._onStopDragFeature,this)},_disableDragging:function(){this._shape.dragging.disable(),this._shape.off("dragstart",this._onStartDragFeature,this).off("dragend",this._onStopDragFeature,this)},_onStartDragFeature:function(){this._shape._map.removeLayer(this._markerGroup),this._shape.fire("editstart")},_onStopDragFeature:function(){for(var e=this._shape,t=0,i=e._latlngs.length;t<i;t++){var a=this._resizeMarkers[t];a.setLatLng(e._latlngs[t]),a._origLatLng=e._latlngs[t],a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next))}this._shape._map.addLayer(this._markerGroup),this._updateMoveMarker(),this._repositionCornerMarkers(),this._fireEdit()}}),L.Edit.PolyVerticesEdit.include({__createMarker:L.Edit.PolyVerticesEdit.prototype._createMarker,__removeMarker:L.Edit.PolyVerticesEdit.prototype._removeMarker,addHooks:function(){var e=this._poly;e.setStyle(e.options.editing),this._poly._map&&(this._markerGroup||(this._enableDragging(),this._initMarkers(),this._createMoveMarker()),this._poly._map.addLayer(this._markerGroup))},_createMoveMarker:function(){L.EditToolbar.Edit.MOVE_MARKERS&&this._poly instanceof L.Polygon&&(this._moveMarker=new L.Marker(this._getShapeCenter(),{icon:this.options.moveIcon}),this._moveMarker.on("mousedown",this._delegateToShape,this),this._markerGroup.addLayer(this._moveMarker))},_delegateToShape:function(e){var t=this._shape||this._poly,i=e.target;t.fire("mousedown",L.Util.extend(e,{containerPoint:L.DomUtil.getPosition(i._icon).add(t._map._getMapPanePos())}))},_getShapeCenter:function(){return this._poly.getCenter()},removeHooks:function(){var e=this._poly;e.setStyle(e.options.original),this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),this._disableDragging(),delete this._markerGroup,delete this._markers)},_enableDragging:function(){this._poly.dragging||(this._poly.dragging=new L.Handler.PathDrag(this._poly)),this._poly.dragging.enable(),this._poly.on("dragstart",this._onStartDragFeature,this).on("dragend",this._onStopDragFeature,this)},_disableDragging:function(){this._poly.dragging.disable(),this._poly.off("dragstart",this._onStartDragFeature,this).off("dragend",this._onStopDragFeature,this)},_onStartDragFeature:function(e){this._poly._map.removeLayer(this._markerGroup),this._poly.fire("editstart")},_onStopDragFeature:function(e){for(var t=0,i=this._latlngs.length;t<i;t++){var a=this._markers[t];a.setLatLng(this._latlngs[t]),a._origLatLng=this._latlngs[t],a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next))}this._poly._map.addLayer(this._markerGroup),L.Edit.SimpleShape.prototype._updateMoveMarker.call(this),this._fireEdit()},_updateMoveMarker:L.Edit.SimpleShape.prototype._updateMoveMarker,_createMarker:function(e,t){var i=this.__createMarker(e,t);return i.on("dragstart",this._hideMoveMarker,this).on("dragend",this._showUpdateMoveMarker,this),i},_removeMarker:function(e){this.__removeMarker(e),e.off("dragstart",this._hideMoveMarker,this).off("dragend",this._showUpdateMoveMarker,this)},_hideMoveMarker:function(){this._moveMarker&&this._markerGroup.removeLayer(this._moveMarker)},_showUpdateMoveMarker:function(){this._moveMarker&&(this._markerGroup.addLayer(this._moveMarker),this._updateMoveMarker())}}),L.Edit.PolyVerticesEdit.prototype.options.moveIcon=new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),L.Edit.PolyVerticesEdit.mergeOptions({moveMarker:!1}),L.Util.saveAs=function(e){function i(){return e.URL||e.webkitURL||e}function a(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)}function o(e){var t=function(){"string"==typeof e?i().revokeObjectURL(e):e.remove()};setTimeout(t,p)}function n(e,t,i){t=[].concat(t);for(var o=t.length;o--;){var n=e["on"+t[o]];if("function"==typeof n)try{n.call(e,i||e)}catch(r){a(r)}}}function r(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function s(a,s,l){function p(){n(f,"writestart progress write writeend".split(" "))}l||(a=r(a));var h,f=this,m=a.type,g=m===u;f.readyState=f.INIT;var v=e.document,y=v.createElementNS("http://www.w3.org/1999/xhtml","a"),b="download"in y;if(b)return h=i().createObjectURL(a),void setTimeout(function(){y.href=h,y.download=s;var e=new MouseEvent("click");y.dispatchEvent(e),p(),o(h),f.readyState=f.DONE});if((d||g&&c)&&e.FileReader){var _=new FileReader;return _.onloadend=function(){var i=d?_.result:_.result.replace(/^data:[^;]*;/,"data:attachment/file;"),a=e.open(i,"_blank");a||(e.location.href=i),i=t,f.readyState=f.DONE,p()},_.readAsDataURL(a),void(f.readyState=f.INIT)}if(h||(h=i().createObjectURL(a)),g)e.location.href=h;else{var L=e.open(h,"_blank");L||(e.location.href=h)}f.readyState=f.DONE,p(),o(h)}function l(e,t,i){return new s(e,t||e.name||"download",i)}if(!("undefined"==typeof e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var c=/constructor/i.test(e.HTMLElement)||e.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent),u="application/octet-stream",p=4e4;if("undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob)return function(e,t,i){return t=t||e.name||"download",i||(e=r(e)),navigator.msSaveOrOpenBlob(e,t)};var h=s.prototype;return h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,l}}("undefined"!=typeof self&&self||"undefined"!=typeof e&&e),angular.module("opengate-angular-js").service("$schemaFormUtils",["$provisionDatastreamsUtils","$api","$q",function(e,i,a){function o(e,t){if(!e)throw new Error("First parameter field must be a string or object");if(!Array.isArray(t))throw new Error("Second parameter form must be an array")}function n(e,t){return o(e,t),t=t.filter(function(t){if("string"==typeof t){if("string"==typeof e)return t!==e;var i=Array.isArray(e.key)?e.key[0]:e.key;return t!==i}if("string"==typeof e){var a=Array.isArray(t.key)?t.key[0]:t.key;return e!==a}var o=Array.isArray(e.key)?e.key[0]:e.key,n=Array.isArray(t.key)?t.key[0]:t.key;return o!==n})}function r(e,t){return o(e,t),t.push("string"==typeof e?{key:"['"+e+"']"}:e),t}function s(){function e(e,i,a){var n=e.identifier;e.required&&l.required.push(n),e.modifiable||(e.schema.readOnly=e.schema.readOnly||!i||e.calculated),e.schema.description=e.description,e.title=(e.name||n)+(e.unit&&e.unit.label?" ("+e.unit.label+")":""),e.schema.title=e.title,t(e.schema,a),o(n),d=r(n,d),l.properties[n]=e.schema}function t(e,i){var a=Object.keys(e);a.forEach(function(a){var o=e[a];i||"string"===o&&"undefined"==typeof e.format&&"undefined"==typeof e["enum"]&&(e.format="helperdialog"),angular.isObject(o)&&t(o,i)})}function o(e){c.indexOf(e)===-1&&c.push(e)}var s=this,l={type:"object",properties:{},required:[]},c=[],d=[];this.updateForm=function(e){e=angular.copy(e)},this.addField=function(t,o,n){var r=a.defer(),s=r.promise;if("string"==typeof t.schema.$ref){var l="$."+t.schema.$ref.split("#")[1];l=l.replace(/[\/]/g,"."),i().basicTypesSearchBuilder().withPath(l).execute().then(function(i){t.schema=i.data,e(t,o,n),r.resolve()})["catch"](function(e){console.error(e),r.reject(e)})}else e(t,o,n),r.resolve();return s},this.addFields=function(e,t,i){var o=[];if(Array.isArray(e)&&e.length>0)return e.forEach(function(e){o.push(s.addField(e,t,i))}),a.all(o)["catch"](function(e){console.error(e)});throw new Error("fields must be an array")},this.removeField=function(e){delete l.properties[e],l.required.splice(l.required.indexOf(e),1),c.splice(c.indexOf(e),1),d=n(e,d)},this.getSchema=function(){return l},this.getForm=function(){return d},this.getIdentifiers=function(){return c}}return{addFieldToForm:r,removeFieldToForm:n,getSchemaFormCreator:function(){return new s},getSchemaFormCreatorFromDatamodel:function(o){var n=o.customFields,r=o.allowedResourceTypes,l=o.organization,c=o.creationMode,d=o.fromAllDatamodels,u=o.withoutHelper,p=d?{and:[]}:e.getFilter(),h=a.defer(),f=h.promise;Array.isArray(n)&&n.length>0?p.and.push({"in":{"datamodels.categories.datastreams.identifier":n}}):h.reject("First parameter must be an array of datastreams identifier");var m=new s({creationMode:c});return r&&p.and.push({"in":{"datamodels.allowedResourceTypes":r}}),l&&p.and.push({eq:{"datamodels.organizationName":l}}),i().datamodelsSearchBuilder().filter(p).build().execute().then(function(i){var o=i.data.datamodels;d||(o=e.filterForCoreDatamodelsCatalog(o));var r=o.reduce(function(e,t){var i=[];return t.categories?e.concat(t.categories.reduce(function(e,t){return e.concat(t.datastreams)},i)):e},[]),s=r.reduce(function(e,t){return e[t.identifier]=t,e},[]),l=[];n.forEach(function(e){var i=s[e];"undefined"==typeof i?console.error("Datastream "+e+" no exists or not is custom."):l.push(m.addField(i,t,u))}),l.length>0&&a.all(l).then(function(){h.resolve(m)})["catch"](function(e){console.error(e),h.reject(e)})})["catch"](function(e){console.error(e),h.reject(e)}),f}}}]),angular.module("opengate-angular-js").config(["schemaFormProvider","schemaFormDecoratorsProvider","sfPathProvider","sfBuilderProvider",function(e,t,i,a){var o=function(t,a,o){var n;if("string"!==a.type||"helperdialog"!==a.format&&"date"!==a.format&&"time"!==a.format&&"datetime"!==a.format&&"date-time"!==a.format?"object"!==a.type||"date"!==a.format&&"time"!==a.format&&"datetime"!==a.format&&"date-time"!==a.format?"boolean"===a.type&&(n=e.stdFormObj(t,a,o),n.key=o.path,n.type="boolean"):(n=e.stdFormObj(t,a,o),n.key=o.path,"date"===a.format?n.type="date":"datetime"===a.format||"date-time"===a.format?n.type="datetime":"time"===a.format&&(n.type="time")):(n=e.stdFormObj(t,a,o),n.key=o.path,"helperdialog"===a.format?n.type="helperdialog":"date"===a.format?n.type="date":"datetime"===a.format||"date-time"===a.format?n.type="datetime":"time"===a.format&&(n.type="time")),n)return o.lookup[i.stringify(o.path)]=n,n};e.defaults.string.unshift(o),e.defaults.object.unshift(o),e.defaults["boolean"].unshift(o),t.defineAddOn("bootstrapDecorator","helperdialog","schema-form/views/schema.form.helper.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","boolean","schema-form/views/schema.form.helper.boolean.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","checkboxes","schema-form/views/schema.form.helper.checkboxes.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","radios","schema-form/views/schema.form.helper.radios.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","radiobuttons","schema-form/views/schema.form.helper.radiobuttons.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","radios-inline","schema-form/views/schema.form.helper.radiosinline.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","datetime","schema-form/views/schema.form.helper.datetime.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","date-time","schema-form/views/schema.form.helper.datetime.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","date","schema-form/views/schema.form.helper.datetime.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","time","schema-form/views/schema.form.helper.datetime.template.html",a.stdBuilders);var n=function(t,a,o){if("string"===a.type&&"customuiselect"===a.format){var n=e.stdFormObj(t,a,o);return n.key=o.path,n.type=a.properties&&a.properties.type?a.properties.type:"string",o.lookup[i.stringify(o.path)]=n,n}};e.defaults.string.unshift(n),t.defineAddOn("bootstrapDecorator","entity","schema-form/views/schema.form.entity.template.html",a.stdBuilders),t.defineAddOn("bootstrapDecorator","datastream","schema-form/views/schema.form.datastream.template.html",a.stdBuilders)}]);var C=angular.module("opengate-angular-js");C.controller("helperDialogController",["$scope","$element","$attrs","$uibModal",function(e,t,i,a){var o=this,n=angular.element('<style title="helper-dialog-style">helper-dialog .row-eq-height,.helper-dialog .row-eq-height {display: -webkit-box;display: -webkit-flex;display: -ms-flexbox;display: flex;}helper-dialog .vcenter,.helper-dialog .vcenter {display: -webkit-box;display: -webkit-flex;display: -ms-flexbox;display: flex;flex-direction: column;justify-content: center;}.helper-dialog .top-buffer {margin-top: 25px;}.helper-dialog .custom-ui-select-label {display: none;}.helper-dialog .without-padding-top .form-group {margin-top: 0 !important;}.helper-dialog .without-padding-top.modal-body h4 {padding-bottom: 0px;}</style>'),r=angular.element("html head");
0===r.find('style[title="helper-dialog-style"]').length&&r.append(n),o.mode="default",o.helperTitle?(o.mode="title",o.helperButton&&(o.mode="title_button")):o.helperButton&&(o.mode="button"),o.open=function(){var e=a.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"helper.view.modal.html",controller:"helperDialogModalController",controllerAs:"$ctrl",windowClass:"helper-dialog",resolve:{helper_id:function(){return o.componentsIds&&1===o.componentsIds.length?o.componentsIds[0]:o.helperId},helper_exclusive:function(){return"true"===o.helperExclusive},specific_type:function(){return o.specificType},helper_extra:function(){return o.helperExtra},helper_selected:function(){return o.helperExtra&&o.helperExtra.selected?o.helperExtra.selected:o.selected}}});e.result.then(function(e){e?(o.selected=angular.fromJson(e),o.onCopy&&o.onCopy({$helper_keys:e}),o.onMulti&&angular.isArray(o.onMulti)&&angular.forEach(o.onMulti,function(t,i){angular.isFunction(t)&&t({$helper_keys:e})})):console.warn("Nothing selected on modal")},function(){})}}]),C.controller("helperDialogModalController",["$scope","$uibModalInstance","helper_id","helper_exclusive","specific_type","helper_extra","helper_selected","Upload","mapUxService",function(e,t,i,a,o,n,r,s,l){function c(e,t,i){d.helper_keys.map={latitude:e,longitude:t,zoom:i}}var d=this;if(d.helper_extra=n,i){var u=/(\w|0-9)+/g;i=u.exec(i.toLowerCase())[0],d.helper_id=i,d[i+"IsOpen"]=!0,d[i+"IsExclusive"]=d.helper_exclusive=a}d.helper_keys={},d.specific_type=o;var p=[],h=l.getDefaultOptions();if(delete h.l_gohome,delete h.l_print,d.map=l.createNgOptions(h),angular.extend(d.map,{center:{lat:r&&r.latitude?r.latitude:40.095,lng:r&&r.longitude?r.longitude:-3.823,zoom:r&&r.zoom?r.zoom:4},markers:{},events:{markers:{enable:["dragend","click"],logic:"emit"},map:{enable:["click"],logic:"emit"}}}),r&&r.latitude&&(d.map.markers={marker:{lat:r.latitude,lng:r.longitude,draggable:!0,focus:!0,message:"Drag me to move. Click me to remove"}},c(r.latitude,r.longitude,r.zoom)),n){if(n.map){var f={marker:{draggable:!0,focus:!0,message:"Drag me to move. Click me to remove"}};d.map=_.merge(d.map,n.map,f)}n.area&&(d.area=n.area)}p.push(e.$on("leafletDirectiveMarker.map-marker.click",function(e,t){delete d.helper_keys.map,d.map.markers={}}),e.$on("leafletDirectiveMap.map-marker.click",function(e,t){var i=t.leafletEvent.latlng;d.map.markers={marker:{lat:i.lat,lng:i.lng,draggable:!0,focus:!0,message:"Drag me to move. Click me to remove"}},c(i.lat,i.lng,t.leafletObject._zoom)}),e.$on("leafletDirectiveMarker.map-marker.dragend",function(e,t){var i=t.leafletEvent.target._leaflet_events.dragend[0].context._latlng;c(i.lat,i.lng,t.leafletObject._zoom)})),d.domain={},r&&r.name&&(d.helper_keys.domain={name:r.name},d.datastream={selected:[{name:r.name}]}),d.onSelectDomainKey=function(e,t){d.helper_keys.domain={name:e.name}},d.onDeleteDomainKey=function(){delete d.helper_keys.name},d.datastream={},r&&r.datastreamId&&(d.helper_keys.datastream={datastreamId:r.datastreamId},d.datastream={selected:[{identifier:r.datastreamId}]}),d.onSelectDatastreamKey=function(e,t){d.helper_keys.datastream={datastreamId:e.identifier}},d.onDeleteDatastreamKey=function(){delete d.helper_keys.datastream},d.entity={},r&&r.entityKey&&(d.helper_keys.entity={entityKey:r.entityKey},d.entity={selected:[{provision:{administration:{identifier:{_current:{value:r.entityKey}}}}}]}),d.onSelectEntityKey=function(e,t){d.helper_keys.entity={entityKey:e.provision.administration.identifier._current.value}},d.onDeleteEntityKey=function(){delete d.helper_keys.entity},d.subscriber={},r&&r.subscriberKey&&(d.helper_keys.subscriberKey={subscriberKey:r.subscriberKey},d.subscriber={selected:[{provision:{subscriber:{identifier:{_current:{value:r.subscriberKey}}}}}]}),d.onSelectSubscriberKey=function(e,t){d.helper_keys.subscriber=e},d.onDeleteSubscriberKey=function(){delete d.helper_keys.subscriber},d.subscription={},r&&r.subscriptionKey&&(d.helper_keys.subscriptionKey={subscriptionKey:r.subscriptionKey},d.subscription={selected:[{provision:{subscription:{identifier:{_current:{value:r.subscriptionKey}}}}}]}),d.onSelectSubscriptionKey=function(e,t){d.helper_keys.subscription=e},d.onDeleteSubscriptionKey=function(){delete d.helper_keys.subscription},d.area?delete d.area.selected:d.area={},r&&r.area&&(d.helper_keys.area={area:r.area},d.area.selected=[{identifier:r.area}]),d.onSelectAreaKey=function(e,t){d.helper_keys.area={area:e.identifier}},d.onDeleteAreaKey=function(){delete d.helper_keys.area},d.canApply=function(){return Object.keys(d.helper_keys).length>0},d.bundle?delete d.bundle.selected:d.bundle={},r&&r.bundle&&(d.helper_keys.bundle={bundle:r.bundle},d.bundle.selected=[{id:r.bundle}]),d.onSelectBundleKey=function(e,t){d.helper_keys.bundle={bundleId:e.id,bundleName:e.name,bundleVersion:e.version}},d.onDeleteBundleKey=function(){delete d.helper_keys.bundle},r&&r.image&&(d.helper_keys.image={image:r.image}),d.imageSelected=function(e){e?s.base64DataUrl(e).then(function(e){d.helper_keys.image={image:e}}):d.removeDataFile()},d.removeDataFile=function(){delete d.helper_keys.image},d.canApply=function(){return Object.keys(d.helper_keys).length>0},d.ok=function(e){if(e)t.close(d.helper_keys[e]);else{var i={};angular.forEach(d.helper_keys,function(e,t){if("subscriber"===t.trim().toLowerCase()||"subscription"===t.trim().toLowerCase()){var a=e.provision[t.trim().toLowerCase()].identifier._current.value;i[t.trim().toLowerCase()+"Key"]=a}else angular.forEach(e,function(e,t){i[t]=e})}),t.close(i)}},d.cancel=function(){t.dismiss("cancel")},e.$on("destroy",function(){for(var e in p)e()})}]),C.component("helperDialog",{transclude:!0,templateUrl:"helper/views/helper.view.html",controller:"helperDialogController",controllerAs:"$helper",bindings:{onCopy:"&",helperId:"@",specificType:"@",helperButton:"@",helperTitle:"@",helperExclusive:"@",helperExtra:"<",modalTemplate:"@",modalController:"@",onMulti:"<"}}),angular.module("opengate-angular-js").controller("helperUiSelectController",["$scope","$element","$attrs",function(e,t,i){var a=this;a.$helper_keys={},a.labelError=a.labelError?a.labelError:"Parameter is required",a.labelText=a.labelText?a.labelText:"Parameter",a.helperTagTransform=function(e){return{key:"custom",value:e}},a._onCopy=function(e){a.$helper_keys=e.$helper_keys,a.have_helper_keys=!0,a.helperModel&&a.helperModel.length>0&&(a.$helper_keys["'"+a.labelText+"' default"]=a.helperModel)},a.$onChanges=function(e){e&&e.selectedKeys&&e.selectedKeys.currentValue&&(Object.keys(e.selectedKeys.currentValue).length>0?(a.$helper_keys=e.selectedKeys.currentValue,a.have_helper_keys=!0):(a.$helper_keys={},a.have_helper_keys=!1))},a.$onInit=function(){a.helperCtrl.onMulti||(a.helperCtrl.onMulti=[]),a.helperCtrl.onMulti.push(a._onCopy),a.helperCtrl.componentsIds||(a.helperCtrl.componentsIds=[]),a.helperCtrl.componentsIds.push(a.labelText),a.have_helper_keys=!1}}]),angular.module("opengate-angular-js").component("helperUiSelect",{templateUrl:"helper/views/custom.ui.select.helper.html",transclude:{input:"?helperUiSelectInput"},require:{helperCtrl:"^^helperDialog"},controller:"helperUiSelectController",bindings:{id:"@",name:"@",labelText:"@",helperModel:"=",required:"=",multiple:"<",labelError:"@",selectedKeys:"<"}}),angular.module("opengate-angular-js").directive("customUiSelect",["$compile","Filter",function(e,t){var i=angular.element('<div title="Toggle Advanced/Basic filter search" ng-click="complex()" style="cursor:pointer" class="custom-ui-select-button input-group-addon"><i class="fa fa-filter"></i><i class="filter-icon fa fa-bold text-muted"></i></div>'),a=angular.element('<div class="custom-ui-select-container input-group"></div>'),o=angular.element('<style title="custom-ui-select-no-multiple">.custom-ui-select-no-multiple .ui-select-search[placeholder=""]{display:none}</style>'),n=function(e,t){var i=e.querySelectorAll("ui-select-choices");i.attr("refresh",t),i.attr("refresh-delay","0")};return{require:"uiSelect",scope:!0,bindToController:!0,controller:["$scope","$element","$attrs","$q","$timeout",function(e,i,a,o,n){function r(e){if(d.prefilter){var t={and:[]};return t.and.push(d.prefilter),t.and.push(e),t}return e}function s(){var t=a.customUiSelectConfig.split(".");if(1===t.length)return e[a.customUiSelectConfig];var i=e;return t.forEach(function(e){i=i[e]}),i}function l(e){u&&clearTimeout(u),u=setTimeout(function(){c(e)},500)}function c(t){function i(e){var t=[];angular.isArray(e)?angular.copy(e,t):angular.forEach(e,function(e,i){t.push(e)}),angular.copy(t,d.collection)}var o=d.builder,n=d.rootKey;p&&angular.equals(p,t)||(p=angular.copy(t),a.$$button.querySelectorAll(".filter-icon").removeClass("fa-bold").removeClass("fa-font").addClass("fa-spinner").addClass("fa-spin"),o.limit(1e3).filter(t).build().execute().then(function(t){if(e._complex?a.$$button.querySelectorAll(".filter-icon").removeClass("fa-spinner").removeClass("fa-spin").addClass("fa-font"):a.$$button.querySelectorAll(".filter-icon").removeClass("fa-spinner").removeClass("fa-spin").addClass("fa-bold"),200===t.statusCode){var o=t.data[n];angular.isFunction(d.processingData)?d.processingData(t,o).then(i):i(o),e.$apply()}else d.collection.splice(0,d.collection.length),204!==t.statusCode?console.error(JSON.stringify(t)):console.log(JSON.stringify(t)),e.$apply()})["catch"](function(e){console.error(e),a.$$button.querySelectorAll(".filter-icon").removeClass("fa-spinner").removeClass("fa-spin").addClass("fa-filter")}))}var d=s();e.complexfilter=function(e){t.parseQuery(e||"").then(function(e){var t=e.filter;Object.keys(t).length>0?(l(r(t)),console.log("Final filter: "+t)):d.collection.splice(0,d.collection.length)})["catch"](function(e){console.error(e),d.collection.splice(0,d.collection.length)})},e.asyncfilter=function(e){l(r(d.filter(e)))},e._complex=a.$$button.querySelectorAll(".fa-filter").hasClass("text-primary"),e.complex=function(){e._complex=!e._complex,e._complex?(i.css("display","").removeClass("custom-ui-select-hide"),a.$$cloneElement.css("display","none").addClass("custom-ui-select-hide"),a.$$button.querySelectorAll(".filter-icon").removeClass("fa-bold").removeClass("text-muted").addClass("fa-font").addClass("text-primary")):(i.css("display","none").addClass("custom-ui-select-hide"),a.$$cloneElement.css("display","").removeClass("custom-ui-select-hide"),a.$$button.querySelectorAll(".filter-icon").removeClass("fa-font").addClass("text-muted").addClass("fa-bold").removeClass("text-primary"))},e.customUiTagTransform=function(e){return null};var u=null,p=null}],compile:function(r,s){s.$$button=i.clone(),s.$$container=a.clone();var l="true"!==s.multiple,c=s.tagging;console.log("isSimple: "+l),l&&(r.attr("limit","1"),s.limit="1",s.searchEnabled="!$select.selected || $select.selected.length === 0",r.attr("search-enabled","!$select.selected || $select.selected.length === 0"),r.addClass("custom-ui-select-no-multiple"),s.$$style=o.clone()),c&&0!==c.trim().length||(r.attr("tagging","customUiTagTransform"),s.tagging="customUiTagTransform");var d="asyncfilter($select.search);",u="complexfilter($select.search);";if(s.customMassAutocompleteItem){n(r,u);var p=angular.element(r.clone());p.removeAttr("custom-ui-select"),n(p,d),s.$$templateElement=p}else n(r,d);return function(i,a,o,n){function r(){var e=o.customMassAutocompleteItem.split(".");if(1===e.length)return i[o.customMassAutocompleteItem];var t=i;return e.forEach(function(e){t=t[e]}),t}var s="mass-autocomplete-ui-select",l="async-ui-select",c=angular.element("html head");if(o.$$style&&0===c.find('style[title="custom-ui-select-no-multiple"]').length&&c.append(o.$$style),o.customMassAutocompleteItem){a.addClass(s);var d=r();d.suggest||(d.suggest=t.suggest_field_delimited);var u=a.querySelectorAll("input.ui-select-search");u.attr("mass-autocomplete-item",o.customMassAutocompleteItem),e(u)(i),o.$$container.empty(),a.before(o.$$container),a.detach(),o.$$container.append(a);var p=o.$$templateElement.clone(),h=e(p)(i,function(e,t){o.$$container.append(e)});h.addClass(l),o.$$cloneElement=h,e(o.$$button)(i),o.$$container.append(o.$$button),a.css("display","none").addClass("custom-ui-select-hide");var f=[];o.$$container.bind("keydown",function(e){f.push(e.keyCode)}),o.$$container.bind("keyup",function(e){f.length>0&&(angular.equals(f,[17,18,70])&&i.complex(),f.splice(0,f.length))})}else a.addClass(l)}}}}]),angular.module("opengate-angular-js").controller("uiSelectResourceTypeController",["$scope","$element","$attrs","$api",function(e,t,i,a){var o=this;o.ownConfig={builder:a().resourceTypeSearchBuilder(),filter:function(e){},rootKey:"resourceType",collection:[],customSelectors:a().resourceTypeSearchBuilder()},o.resourceTypeSelected=function(e,t){var i={};i.$item=e,i.$model=t,o.onSelectItem(i)},o.resourceTypeRemove=function(e,t){o.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("uiSelectResourceType",{templateUrl:"custom-ui-select/views/ui.select.resourceType.html",controller:"uiSelectResourceTypeController",bindings:{onSelectItem:"&",onRemove:"&",resourceType:"=",multiple:"<",required:"="}}),angular.module("opengate-angular-js").controller("customUiSelectTicketController",["$scope","$element","$attrs","$api",function(e,t,i,a){var o=this;o.ownConfig={builder:a().ticketsSearchBuilder(),filter:function(e){return{or:[{like:{"provision.administration.identifier":e}},{like:{"provision.ticket.specificType":e}},{like:{"provision.ticket.name":e}},{like:{"provision.ticket.type":e}},{like:{"provision.ticket.entity":e}}]}},rootKey:"tickets",collection:[],customSelectors:a().ticketsSearchBuilder()},o.ticketSelected=function(e,t){var i={};i.$item=e,i.$model=t,o.onSelectItem(i)},o.ticketRemove=function(e,t){o.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectTicket",{templateUrl:"custom-ui-select/views/custom.ui.select.ticket.html",controller:"customUiSelectTicketController",bindings:{onSelectItem:"&",onRemove:"&",ticket:"=",multiple:"<",required:"="}}),angular.module("opengate-angular-js").controller("customUiSelectSubscriptionController",["$scope","$element","$attrs","$api","$entityExtractor",function(e,t,i,a,o){var n=this;n.ownConfig={builder:a().subscriptionsSearchBuilder().provisioned(),filter:function(e){var t={or:[{like:{"provision.device.communicationModules[].subscription.identifier":e}},{like:{"device.communicationModules[].subscription.identifier":e}}]};return n.specificType&&(t={and:[t,{or:[{eq:{"device.communicationModules[].subscription.specificType":n.specificType}},{eq:{"provision.device.communicationModules[].subscription.specificType":n.specificType}}]}]}),t},rootKey:"devices",collection:[],customSelectors:a().subscriptionsSearchBuilder().provisioned(),processingData:o.extractSubscriptions},n.entitySelected=function(e,t){var i={};i.$item=e,i.$model=t,n.onSelectItem(i)},n.entityRemove=function(e,t){n.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectSubscription",{templateUrl:"custom-ui-select/views/custom.ui.select.subscription.html",controller:"customUiSelectSubscriptionController",bindings:{onSelectItem:"&",onRemove:"&",entity:"=",specificType:"@",multiple:"<",required:"="}}),angular.module("opengate-angular-js").controller("customUiSelectSubscriberController",["$scope","$element","$attrs","$api","$entityExtractor",function(e,t,i,a,o){var n=this;n.ownConfig={builder:a().subscribersSearchBuilder().provisioned(),filter:function(e){var t={or:[{like:{"provision.device.communicationModules[].subscriber.identifier":e}},{like:{"device.communicationModules[].subscriber.identifier":e}},{like:{"provision.device.communicationModules[].subscriber.mobile.icc":e}}]};return n.specificType&&(t={and:[t,{or:[{eq:{"device.communicationModules[].subscriber.specificType":n.specificType}},{eq:{"provision.device.communicationModules[].subscriber.specificType":n.specificType}}]}]}),t},rootKey:"devices",collection:[],customSelectors:a().subscribersSearchBuilder().provisioned(),processingData:o.extractSubscribers},n.entitySelected=function(e,t){var i={};i.$item=e,i.$model=t,n.onSelectItem(i)},n.entityRemove=function(e,t){n.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectSubscriber",{templateUrl:"custom-ui-select/views/custom.ui.select.subscriber.html",controller:"customUiSelectSubscriberController",bindings:{onSelectItem:"&",onRemove:"&",entity:"=",specificType:"@",multiple:"<",required:"="}}),angular.module("opengate-angular-js").controller("customUiSelectProvisionDatastreamController",["$scope","$element","$attrs","$api","$q","$http","$provisionDatastreamsUtils",function(e,t,i,a,o,n,r){var s=this;s.filter="provision.",s.ownConfig={builder:a().datamodelsSearchBuilder(),filter:function(e){s.lastSearch=e;var t=r.getFilter();if(s.allowedResourceTypes){var i=s.allowedResourceTypes.replace("s*,s*",",").split(",");t.and.push({"in":{"datamodels.allowedResourceTypes":i}})}if(s.organization&&s.organization.length>0&&(t.and||(t.and=[]),t.and.push({eq:{"datamodels.organizationName":s.organization}})),e){var a={or:[{like:{"datamodels.categories.datastreams.identifier":e}},{like:{"datamodels.categories.datastreams.name":e}}]};t.and.push(a)}return t},rootKey:"datamodels",collection:[],processingData:function(e,t){return o(function(i){var a=[],o=e.data.datamodels;o=r.filterForCoreDatamodelsCatalog(o),angular.forEach(o,function(e,t){var i=e.categories,o={identifier:e.identifier,description:e.description,name:e.name,organization:e.organizationName};angular.forEach(i,function(e,t){var i=e.datastreams,n={identifier:e.identifier};angular.forEach(i.filter(function(e){return!!/^(provision\.).*/.test(e.identifier)&&(e.identifier.indexOf(s.lastSearch)>-1&&!!s.lastSearch.length||!s.lastSearch)}),function(e,t){var i=angular.copy(e);i.datamodel=o,i.category=n,a.push(i)})})}),angular.copy(a,t),i(t)})},customSelectors:a().datamodelsSearchBuilder()},s.datastreamSelected=function(e,t){var i={};i.$item=e,i.$model=t,s.onSelectItem(i)},s.datastreamRemove=function(e,t){var i={};i.$item=e,i.$model=t,s.onRemove(i)}}]),angular.module("opengate-angular-js").component("customUiSelectProvisionDatastream",{templateUrl:"custom-ui-select/views/custom.ui.select.datastream.html",controller:"customUiSelectProvisionDatastreamController",bindings:{onSelectItem:"&",onRemove:"&",datastream:"=",multiple:"<",required:"=",organization:"=",allowedResourceTypes:"="}}),angular.module("opengate-angular-js").controller("customUiSelectEntityController",["$scope","$element","$attrs","$api",function(e,t,i,a){var o=this;o.ownConfig={builder:a().entitiesSearchBuilder(),filter:function(e){return{or:[{like:{"provision.administration.identifier":e}},{like:{"provision.device.specificType":e}},{like:{"device.specificType":e}},{like:{"provision.asset.specificType":e}},{like:{"provision.device.communicationModules[].subscriber.identifier":e}},{like:{"device.communicationModules[].subscriber.identifier":e}},{like:{"provision.device.communicationModules[].subscriber.mobile.icc":e}},{like:{"device.communicationModules[].subscriber.specificType":e}},{like:{"provision.device.communicationModules[].subscriber.specificType":e}}]}},rootKey:"entities",collection:[],customSelectors:a().entitiesSearchBuilder()},o.entitySelected=function(e,t){var i={};i.$item=e,i.$model=t,o.onSelectItem(i)},o.entityRemove=function(e,t){o.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectEntity",{templateUrl:"custom-ui-select/views/custom.ui.select.entity.html",controller:"customUiSelectEntityController",bindings:{onSelectItem:"&",onRemove:"&",entity:"=",multiple:"<",required:"="}}),angular.module("opengate-angular-js").controller("customUiSelectDomainController",["$scope","$element","$attrs","$api",function(e,t,i,a){var o=this;o.ownConfig={builder:a().domainsSearchBuilder(),rootKey:"domains",collection:[],filter:function(e){return{or:[{like:{"domain.name":e}},{like:{"domain.description":e}}]}},customSelectors:a().domainsSearchBuilder()},o.domainSelected=function(e,t){var i={};i.$item=e,i.$model=t,o.onSelectItem(i)},o.domainRemove=function(e,t){o.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectDomain",{templateUrl:"custom-ui-select/views/custom.ui.select.domain.html",controller:"customUiSelectDomainController",bindings:{onSelectItem:"&",onRemove:"&",domain:"=",multiple:"<",required:"=",label:"="}}),angular.module("opengate-angular-js").controller("customUiSelectDeviceController",["$scope","$element","$attrs","$api",function(e,t,i,a){var o=this;o.ownConfig={builder:a().devicesSearchBuilder(),filter:function(e){return{or:[{like:{"provision.administration.identifier":e}},{like:{"provision.device.specificType":e}},{like:{"device.specificType":e}}]}},rootKey:"devices",collection:[],customSelectors:a().devicesSearchBuilder()},o.deviceSelected=function(e,t){var i={};i.$item=e,i.$model=t,o.onSelectItem(i)},o.deviceRemove=function(e,t){o.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectDevice",{templateUrl:"custom-ui-select/views/custom.ui.select.device.html",controller:"customUiSelectDeviceController",bindings:{onSelectItem:"&",onRemove:"&",device:"=",multiple:"<",required:"="}}),angular.module("opengate-angular-js").controller("customUiSelectDatastreamController",["$scope","$element","$attrs","$api","$q",function(e,t,i,a,o){var n=this;n.ownConfig={builder:a().datamodelsSearchBuilder(),filter:function(e){n.lastSearch=e;var t={};if(n.resourceTypes&&angular.isArray(n.resourceTypes)&&n.resourceTypes.length>0&&(t.and=[{"in":{"datamodels.allowedResourceTypes":n.resourceTypes}}]),n.organization&&n.organization.length>0&&(t.and||(t.and=[]),t.and.push({eq:{"datamodels.organizationName":n.organization}})),e){var i={or:[{like:{"datamodels.categories.datastreams.identifier":e}},{like:{"datamodels.categories.datastreams.name":e}},{like:{"datamodels.identifier":e}},{like:{"datamodels.name":e}},{like:{"datamodels.description":e}},{like:{"datamodels.version":e}}]};return t.and?(t.and.push(i),t):i}return t},rootKey:"datamodels",collection:[],processingData:function(e,t){return o(function(i){var a=[],o=e.data.datamodels;angular.forEach(o,function(e,t){var i=e.categories,o={identifier:e.identifier,description:e.description,name:e.name,organization:e.organizationName};angular.forEach(i,function(e,t){var i=e.datastreams,r={identifier:e.identifier};angular.forEach(i.filter(function(e){return e.identifier.toLowerCase().indexOf(n.lastSearch.toLowerCase())>-1&&!!n.lastSearch.length||!n.lastSearch}),function(e,t){var i=angular.copy(e);if(i.datamodel=o,i.category=r,n.postFilter){var s=n.postFilter(i);s||a.push(i)}else a.push(i)})})}),angular.copy(a,t),i(t)})},customSelectors:a().datamodelsSearchBuilder()},n.datastreamSelected=function(e,t){var i={};i.$item=e,i.$model=t,n.onSelectItem(i)},n.datastreamRemove=function(e,t){var i={};i.$item=e,i.$model=t,n.onRemove(i)},n.maxResults||(n.maxResults=100)}]),angular.module("opengate-angular-js").component("customUiSelectDatastream",{templateUrl:"custom-ui-select/views/custom.ui.select.datastream.html",controller:"customUiSelectDatastreamController",bindings:{onSelectItem:"&",onRemove:"&",datastream:"=",multiple:"<",maxResults:"<",required:"=",postFilter:"<",resourceTypes:"=",organization:"=",placeholder:"="}}),angular.module("opengate-angular-js").controller("customUiSelectBundleController",["$scope","$element","$attrs","$api","$q",function(e,t,i,a,o){var n=this;n.ownConfig={builder:a().bundlesSearchBuilder(),filter:function(e){return n.lastSearch=e,e?{or:[{like:{"bundles.name":e}},{like:{"bundles.version":e}},{like:{"bundles.description":e}}]}:{}},rootKey:"bundles",collection:[],customSelectors:a().bundlesSearchBuilder()},n.bundleSelected=function(e,t){var i={};i.$item=e,i.$model=t,n.onSelectItem(i)},n.bundleRemove=function(e,t){var i={};i.$item=e,i.$model=t,n.onRemove(i)}}]),angular.module("opengate-angular-js").component("customUiSelectBundle",{templateUrl:"custom-ui-select/views/custom.ui.select.bundle.html",controller:"customUiSelectBundleController",bindings:{onSelectItem:"&",onRemove:"&",bundle:"=",multiple:"<",required:"="}}),angular.module("opengate-angular-js").controller("customUiSelectAssetController",["$scope","$element","$attrs","$api",function(e,t,i,a){var o=this;o.ownConfig={builder:a().assetsSearchBuilder(),filter:function(e){return{or:[{like:{"provision.administration.identifier":e}},{like:{"provision.asset.specificType":e}}]}},rootKey:"assets",collection:[],customSelectors:a().assetsSearchBuilder()},o.assetSelected=function(e,t){var i={};i.$item=e,i.$model=t,o.onSelectItem(i)},o.assetRemove=function(e,t){o.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectAsset",{templateUrl:"custom-ui-select/views/custom.ui.select.asset.html",controller:"customUiSelectAssetController",bindings:{onSelectItem:"&",onRemove:"&",asset:"=",multiple:"<",required:"="}}),angular.module("opengate-angular-js").controller("customUiSelectAreaController",["$scope","$element","$attrs","$api","$q",function(e,t,i,a,o){var n,r=this;r.organization&&(n=[{eq:{"areas.organization":r.organization}}]),r.ownConfig={builder:a().areasSearchBuilder(),filter:function(e){return r.lastSearch=e,n?(e&&n.push({or:[{like:{"areas.name":e}},{like:{"areas.organization":e}}]}),{and:n}):e?{or:[{like:{"areas.name":e}},{like:{"areas.organization":e}}]}:{}},rootKey:"areas",collection:[],customSelectors:a().areasSearchBuilder()},r.areaSelected=function(e,t){var i={};i.$item=e,i.$model=t,r.onSelectItem(i)},r.areaRemove=function(e,t){var i={};i.$item=e,i.$model=t,r.onRemove(i)}}]),angular.module("opengate-angular-js").component("customUiSelectArea",{templateUrl:"custom-ui-select/views/custom.ui.select.area.html",controller:"customUiSelectAreaController",bindings:{onSelectItem:"&",onRemove:"&",area:"=",multiple:"<",required:"=",organization:"<"}}),angular.module("opengate-angular-js").service("$provisionDatastreamsUtils",[function(){function e(e){return e.filter(function(e){return a.indexOf(e.identifier)===-1})}function t(){return angular.copy(o)}function i(){return angular.copy(a)}var a=["internal","provisionSubscriber","provisionGeneric","provisionDevice","provisionAsset","provisionSubscription","ticket","provisionGenericChannel","provisionGenericOrganization","provisionGenericIdentifier"],o={and:[{like:{"datamodels.categories.datastreams.identifier":"^(provision.).*"}}]};return{getCoreDatamodelsCatalog:i,filterForCoreDatamodelsCatalog:e,getFilter:t}}]),angular.module("opengate-angular-js").service("$oguxThemes",[function(){var e="light",i="orange",a=e+" "+i,o=[{name:"default"},{name:"light"}],n={red:{id:"red",sample:"#f44336",sampleType:"normal",rgba:"rgba(244, 67, 54, 0.5)",name:"COLOR.RED",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_red.css"]},"neon-red":{id:"neon-red",sample:"#f44336",sampleType:"neon",rgba:"rgba(244, 67, 54, 0.5)",name:"COLOR.NEON_RED",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-red.css"]},"darkneon-red":{id:"darkneon-red",sample:"#f44336",sampleType:"neon",rgba:"rgba(244, 67, 54, 0.5)",name:"COLOR.DARK_NEON_RED",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-red.css"]},pink:{id:"pink",sample:"#e91e63",rgba:"rgba(233, 30, 99, 0.5)",name:"COLOR.PINK",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_pink.css"]},purple:{id:"purple",sample:"#9c27b0",rgba:"rgba(156, 39, 176, 0.5)",name:"COLOR.PURPLE",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_purple.css"]},deeppurple:{id:"deeppurple",sample:"#673ab7",rgba:"rgba(103, 10, 183, 0.5)",name:"COLOR.DEEP_PURPLE",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_deeppurple.css"]},indigo:{id:"indigo",sample:"#3f51b5",rgba:"rgba(63, 81, 181, 0.5)",name:"COLOR.INDIGO",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_indigo.css"]},blue:{id:"blue",sample:"#2196f3",rgba:"rgba(33, 150, 243, 0.5)",name:"COLOR.BLUE",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_blue.min.css"]},"neon-blue":{id:"neon-blue",sample:"#2196f3",sampleType:"neon",rgba:"rgba(33, 150, 243, 0.5)",name:"COLOR.NEON_BLUE",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-blue.css"]},"darkneon-blue":{id:"darkneon-blue",sample:"#2196f3",sampleType:"neon",rgba:"rgba(33, 150, 243, 0.5)",name:"COLOR.DARK_NEON_BLUE",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-blue.css"]},lightblue:{id:"lightblue",sample:"#03a9f4",rgba:"rgba(3, 169, 244, 0.5)",name:"COLOR.LIGTH_BLUE",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_lightblue.css"]},cyan:{id:"cyan",sample:"#00bcd4",rgba:"rgba(0, 188, 212, 0.5)",name:"COLOR.CYAN",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_cyan.min.css"]},teal:{id:"teal",sample:"#009688",rgba:"rgba(0, 150, 136, 0.5)",name:"COLOR.TEAL",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_teal.min.css"]},"neon-teal":{id:"neon-teal",sample:"#009688",sampleType:"neon",rgba:"rgba(0, 150, 136, 0.5)",name:"COLOR.NEON_TEAL",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-teal.css"]},"darkneon-teal":{id:"darkneon-teal",sample:"#009688",sampleType:"neon",rgba:"rgba(0, 150, 136, 0.5)",name:"COLOR.DARK_NEON_TEAL",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-teal.css"]},green:{id:"green",sample:"#4caf50",rgba:"rgba(76, 175, 80, 0.5)",name:"COLOR.GREEN",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_green.min.css"]},"neon-green":{id:"neon-green",sample:"#4caf50",sampleType:"neon",rgba:"rgba(76, 175, 80, 0.5)",name:"COLOR.NEON_GREEN",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-green.css"]},"darkneon-green":{id:"darkneon-green",sample:"#4caf50",sampleType:"neon",rgba:"rgba(76, 175, 80, 0.5)",name:"COLOR.DARK_NEON_GREEN",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-green.css"]},lightgreen:{id:"lightgreen",sample:"#8bc34a",rgba:"rgba(139, 195, 74, 0.5)",name:"COLOR.LIGHT_GREEN",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_lightgreen.min.css"]},lime:{id:"lime",sample:"#cddc39",rgba:"rgba(205, 220, 57, 0.5)",name:"COLOR.LIME",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_lime.min.css"]},yellow:{id:"yellow",sample:"#ffeb3b",rgba:"rgba(255, 235, 59, 0.5)",name:"COLOR.YELLOW",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_yellow.min.css"]},amber:{id:"amber",sample:"#ffc107",rgba:"rgba(255, 193, 7, 0.5)",name:"COLOR.AMBER",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_amber.min.css"]},"neon-orange":{id:"neon-orange",sample:"#ff9800",sampleType:"neon",rgba:"rgba(255, 152, 0, 0.5)",name:"COLOR.NEON_ORANGE",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-orange.css"]},"darkneon-orange":{id:"darkneon-orange",sample:"#ff9800",sampleType:"neon",rgba:"rgba(255, 152, 0, 0.5)",name:"COLOR.DARK_NEON_ORANGE",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-orange.css"]},orange:{id:"orange",sample:"#ff9800",rgba:"rgba(255, 152, 0, 0.5)",name:"COLOR.ORANGE",theme:["light","default","fresh","freshdark","traversed","traversed-dark"]
},deeporange:{id:"deeporange",sample:"#ff5722",rgba:"rgba(255, 87, 34, 0.5)",name:"COLOR.DEEP_ORANGE",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_deeporange.min.css"]},brown:{id:"brown",sample:"#795548",rgba:"rgba(121, 85, 72, 0.5)",name:"COLOR.BROWN",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_brown.min.css"]},grey:{id:"grey",sample:"#9e9e9e",rgba:"rgba(33, 150, 243, 1)",name:"COLOR.GREY",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_grey.min.css"]},"neon-grey":{id:"neon-grey",sample:"#9e9e9e",sampleType:"neon",rgba:"rgba(33, 150, 243, 1)",name:"COLOR.NEON_GREY",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-grey.css"]},"darkneon-grey":{id:"darkneon-grey",sample:"#9e9e9e",sampleType:"neon",rgba:"rgba(33, 150, 243, 1)",name:"COLOR.DARK_NEON_GREY",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-grey.css"]},bluegrey:{id:"bluegrey",sample:"#607d8b",rgba:"rgba(96, 125, 139, 0.5)",name:"COLOR.BLUE_GREY",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_bluegrey.min.css"]},darkgrey:{id:"darkgrey",sample:"#2D2D2D",rgba:"rgba(45, 45, 45, 0.5)",name:"COLOR.DARK_GREY",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_darkgrey.min.css"]}};return{setThemeComposition:function(t){a=t;var o=a.split(" ");e=o[0],i=o[1]},colors:function(){var e={};return angular.forEach(n,function(t,i){t.hidden||(e[i]=t)}),e},themes:function(){return o},getColorConfig:function(e){return n[e]?n[e]:t},getColorsKeys:function(){return Object.keys(n)},colorsByTheme:function(e){var t=[];return angular.forEach(n,function(i,a){i.hidden||i.theme.indexOf(e)===-1||t.push(i)}),t},getThemeFromThemeComposition:function(){return e},getColorFromThemeComposition:function(){return n[i]},getColorsCombinationFromTheme:function(){var e=new ColorScheme;return e.from_hex(n[i].sample.substring(1)),e.scheme("analogic"),e.distance(1),e.add_complement(!0),e.variation("light"),e.colors()}}}]),angular.module("opengate-angular-js").service("$ogapi",function(){function i(){var i;this.api=function(){if("undefined"!=typeof i)return i;throw new Error("Must invoke create([options]) function before api() function")},this.create=function(t){return i=new e.OpenGateAPI(t)},this.release=function(){return i=t,this}}return new i}),angular.module("opengate-angular-js").service("$ogapiErrorParser",["jsonPath",function(e){return{toString:function(t,i){for(var a="",o=e(t,"$..message"),n=0;n<o.length;n++)a+=o[n]+(i?i:"\n");return a},toStringArray:function(t){var i=e(t,"$..message");return i}}}]),angular.module("opengate-angular-js").service("$jsonFinderHelper",["jsonPath",function(e){return n.prototype.jsonPath=e,{administration:new n,provisioned:new s,collected:new r,subscriber:{collected:new f,provisioned:new h},subscription:{collected:new m,provisioned:new g},asset:{collected:new l,provisioned:new c},human:{collected:new u,provisioned:new p},ticket:{provisioned:new d}}}]),n.prototype.getOriginalPath=function(e){if(!this.fields[e])throw new Error("Field <"+e+"> not found. Available:"+JSON.stringify(Object.keys(this.fields)));return this.fields[e]},n.prototype.getPath=function(e){return this.getOriginalPath(e).replace("[]","[*]")},n.prototype.getAmpliaPath=function(e){if(!this.fields[e])throw new Error("Field <"+e+"> not found. Available:"+JSON.stringify(Object.keys(this.fields)));return this.fields[e]},n.prototype.findOne=function(e,t){return this.findAll(e,t)[0]},n.prototype.findAll=function(e,t){return this.jsonPath(e,this.getPath(t)+"._current.value")||[]},r.prototype=new n,s.prototype=new r,s.prototype.getPath=function(e){var t=n.prototype.getPath.call(this,e);return t.startsWith("provision.")||(t="provision."+t),t},s.prototype.getAmpliaPath=function(e){var t=n.prototype.getAmpliaPath.call(this,e);return t.startsWith("provision.")||(t="provision."+t),t},s.prototype.getOriginalPath=function(e){var t=n.prototype.getOriginalPath.call(this,e);return t.startsWith("provision.")||(t="provision."+t),t},f.prototype=new r,f.prototype.getPath=function(e){var t=r.prototype.getPath.call(this,e);return t.replace("device.communicationModules[*].subscriber","")},f.prototype.getOriginalPath=function(e){var t=r.prototype.getOriginalPath.call(this,e);return t.replace("device.communicationModules[].subscriber","")},h.prototype=new s,h.prototype.getPath=function(e){var t=s.prototype.getPath.call(this,e);return t.replace("device.communicationModules[*].subscriber","")},h.prototype.getOriginalPath=function(e){var t=s.prototype.getOriginalPath.call(this,e);return t.replace("device.communicationModules[].subscriber","")},m.prototype=new r,m.prototype.getPath=function(e){var t=r.prototype.getPath.call(this,e);return t.replace("device.communicationModules[*].subscription","")},m.prototype.getOriginalPath=function(e){var t=r.prototype.getOriginalPath.call(this,e);return t.replace("device.communicationModules[].subscription","")},g.prototype=new s,g.prototype.getPath=function(e){var t=s.prototype.getPath.call(this,e);return t.replace("device.communicationModules[*].subscription","")},g.prototype.getOriginalPath=function(e){var t=s.prototype.getOriginalPath.call(this,e);return t.replace("device.communicationModules[*].subscription","")},l.prototype=new r,l.prototype.getPath=function(e){var t=r.prototype.getPath.call(this,e);return t.replace("device.","asset.")},l.prototype.getOriginalPath=function(e){var t=r.prototype.getOriginalPath.call(this,e);return t.replace("device.","asset.")},c.prototype=new s,c.prototype.getPath=function(e){var t=s.prototype.getPath.call(this,e);return t.replace("device.","asset.")},c.prototype.getOriginalPath=function(e){var t=s.prototype.getOriginalPath.call(this,e);return t.replace("device.","asset.")},d.prototype=new s,d.prototype.getPath=function(e){var t=s.prototype.getPath.call(this,e);return t.replace("device.","ticket.")},d.prototype.getOriginalPath=function(e){var t=s.prototype.getOriginalPath.call(this,e);return t.replace("device.","ticket.")},u.prototype=new l,u.prototype.getPath=function(e){var t=l.prototype.getPath.call(this,e),i=t.replace("asset.","human.");return i.replace("device.","human.")},u.prototype.getOriginalPath=function(e){var t=l.prototype.getOriginalPath.call(this,e),i=t.replace("asset.","human.");return i.replace("device.","human.")},p.prototype=new c,p.prototype.getPath=function(e){var t=c.prototype.getPath.call(this,e),i=t.replace("asset.","human.");return i.replace("device.","human.")},p.prototype.getOriginalPath=function(e){var t=c.prototype.getOriginalPath.call(this,e),i=t.replace("asset.","human.");return i.replace("device.","human.")},angular.module("opengate-angular-js").service("$faIcons",[function(){var e=["fa-500px","fa-address-book","fa-address-book-o","fa-address-card","fa-address-card-o","fa-adjust","fa-adn","fa-align-center","fa-align-justify","fa-align-left","fa-align-right","fa-amazon","fa-ambulance","fa-american-sign-language-interpreting","fa-anchor","fa-android","fa-angellist","fa-angle-double-down","fa-angle-double-left","fa-angle-double-right","fa-angle-double-up","fa-angle-down","fa-angle-left","fa-angle-right","fa-angle-up","fa-apple","fa-archive","fa-area-chart","fa-arrow-circle-down","fa-arrow-circle-left","fa-arrow-circle-o-down","fa-arrow-circle-o-left","fa-arrow-circle-o-right","fa-arrow-circle-o-up","fa-arrow-circle-right","fa-arrow-circle-up","fa-arrow-down","fa-arrow-left","fa-arrow-right","fa-arrow-up","fa-arrows","fa-arrows-alt","fa-arrows-h","fa-arrows-v","fa-asl-interpreting","fa-assistive-listening-systems","fa-asterisk","fa-at","fa-audio-description","fa-automobile","fa-backward","fa-balance-scale","fa-ban","fa-bandcamp","fa-bank","fa-bar-chart","fa-bar-chart-o","fa-barcode","fa-bars","fa-bath","fa-bathtub","fa-battery","fa-battery-0","fa-battery-1","fa-battery-2","fa-battery-3","fa-battery-4","fa-battery-empty","fa-battery-full","fa-battery-half","fa-battery-quarter","fa-battery-three-quarters","fa-bed","fa-beer","fa-behance","fa-behance-square","fa-bell","fa-bell-o","fa-bell-slash","fa-bell-slash-o","fa-bicycle","fa-binoculars","fa-birthday-cake","fa-bitbucket","fa-bitbucket-square","fa-bitcoin","fa-black-tie","fa-blind","fa-bluetooth","fa-bluetooth-b","fa-bold","fa-bolt","fa-bomb","fa-book","fa-bookmark","fa-bookmark-o","fa-braille","fa-briefcase","fa-btc","fa-bug","fa-building","fa-building-o","fa-bullhorn","fa-bullseye","fa-bus","fa-buysellads","fa-cab","fa-calculator","fa-calendar","fa-calendar-check-o","fa-calendar-minus-o","fa-calendar-o","fa-calendar-plus-o","fa-calendar-times-o","fa-camera","fa-camera-retro","fa-car","fa-caret-down","fa-caret-left","fa-caret-right","fa-caret-square-o-down","fa-caret-square-o-left","fa-caret-square-o-right","fa-caret-square-o-up","fa-caret-up","fa-cart-arrow-down","fa-cart-plus","fa-cc","fa-cc-amex","fa-cc-diners-club","fa-cc-discover","fa-cc-jcb","fa-cc-mastercard","fa-cc-paypal","fa-cc-stripe","fa-cc-visa","fa-certificate","fa-chain","fa-chain-broken","fa-check","fa-check-circle","fa-check-circle-o","fa-check-square","fa-check-square-o","fa-chevron-circle-down","fa-chevron-circle-left","fa-chevron-circle-right","fa-chevron-circle-up","fa-chevron-down","fa-chevron-left","fa-chevron-right","fa-chevron-up","fa-child","fa-chrome","fa-circle","fa-circle-o","fa-circle-o-notch","fa-circle-thin","fa-clipboard","fa-clock-o","fa-clone","fa-close","fa-cloud","fa-cloud-download","fa-cloud-upload","fa-cny","fa-code","fa-code-fork","fa-codepen","fa-codiepie","fa-coffee","fa-cog","fa-cogs","fa-columns","fa-comment","fa-comment-o","fa-commenting","fa-commenting-o","fa-comments","fa-comments-o","fa-compass","fa-compress","fa-connectdevelop","fa-contao","fa-copy","fa-copyright","fa-creative-commons","fa-credit-card","fa-credit-card-alt","fa-crop","fa-crosshairs","fa-css3","fa-cube","fa-cubes","fa-cut","fa-cutlery","fa-dashboard","fa-dashcube","fa-database","fa-deaf","fa-deafness","fa-dedent","fa-delicious","fa-desktop","fa-deviantart","fa-diamond","fa-digg","fa-dollar","fa-dot-circle-o","fa-download","fa-dribbble","fa-drivers-license","fa-drivers-license-o","fa-dropbox","fa-drupal","fa-edge","fa-edit","fa-eercast","fa-eject","fa-ellipsis-h","fa-ellipsis-v","fa-empire","fa-envelope","fa-envelope-o","fa-envelope-open","fa-envelope-open-o","fa-envelope-square","fa-envira","fa-eraser","fa-etsy","fa-eur","fa-euro","fa-exchange","fa-exclamation","fa-exclamation-circle","fa-exclamation-triangle","fa-expand","fa-expeditedssl","fa-external-link","fa-external-link-square","fa-eye","fa-eye-slash","fa-eyedropper","fa-fa","fa-facebook","fa-facebook-f","fa-facebook-official","fa-facebook-square","fa-fast-backward","fa-fast-forward","fa-fax","fa-feed","fa-female","fa-fighter-jet","fa-file","fa-file-archive-o","fa-file-audio-o","fa-file-code-o","fa-file-excel-o","fa-file-image-o","fa-file-movie-o","fa-file-o","fa-file-pdf-o","fa-file-photo-o","fa-file-picture-o","fa-file-powerpoint-o","fa-file-sound-o","fa-file-text","fa-file-text-o","fa-file-video-o","fa-file-word-o","fa-file-zip-o","fa-files-o","fa-film","fa-filter","fa-fire","fa-fire-extinguisher","fa-firefox","fa-first-order","fa-flag","fa-flag-checkered","fa-flag-o","fa-flash","fa-flask","fa-flickr","fa-floppy-o","fa-folder","fa-folder-o","fa-folder-open","fa-folder-open-o","fa-font","fa-font-awesome","fa-fonticons","fa-fort-awesome","fa-forumbee","fa-forward","fa-foursquare","fa-free-code-camp","fa-frown-o","fa-futbol-o","fa-gamepad","fa-gavel","fa-gbp","fa-ge","fa-gear","fa-gears","fa-genderless","fa-get-pocket","fa-gg","fa-gg-circle","fa-gift","fa-git","fa-git-square","fa-github","fa-github-alt","fa-github-square","fa-gitlab","fa-gittip","fa-glass","fa-glide","fa-glide-g","fa-globe","fa-google","fa-google-plus","fa-google-plus-circle","fa-google-plus-official","fa-google-plus-square","fa-google-wallet","fa-graduation-cap","fa-gratipay","fa-grav","fa-group","fa-h-square","fa-hacker-news","fa-hand-grab-o","fa-hand-lizard-o","fa-hand-o-down","fa-hand-o-left","fa-hand-o-right","fa-hand-o-up","fa-hand-paper-o","fa-hand-peace-o","fa-hand-pointer-o","fa-hand-rock-o","fa-hand-scissors-o","fa-hand-spock-o","fa-hand-stop-o","fa-handshake-o","fa-hard-of-hearing","fa-hashtag","fa-hdd-o","fa-header","fa-headphones","fa-heart","fa-heart-o","fa-heartbeat","fa-history","fa-home","fa-hospital-o","fa-hotel","fa-hourglass","fa-hourglass-1","fa-hourglass-2","fa-hourglass-3","fa-hourglass-end","fa-hourglass-half","fa-hourglass-o","fa-hourglass-start","fa-houzz","fa-html5","fa-i-cursor","fa-id-badge","fa-id-card","fa-id-card-o","fa-ils","fa-image","fa-imdb","fa-inbox","fa-indent","fa-industry","fa-info","fa-info-circle","fa-inr","fa-instagram","fa-institution","fa-internet-explorer","fa-intersex","fa-ioxhost","fa-italic","fa-joomla","fa-jpy","fa-jsfiddle","fa-key","fa-keyboard-o","fa-krw","fa-language","fa-laptop","fa-lastfm","fa-lastfm-square","fa-leaf","fa-leanpub","fa-legal","fa-lemon-o","fa-level-down","fa-level-up","fa-life-bouy","fa-life-buoy","fa-life-ring","fa-life-saver","fa-lightbulb-o","fa-line-chart","fa-link","fa-linkedin","fa-linkedin-square","fa-linode","fa-linux","fa-list","fa-list-alt","fa-list-ol","fa-list-ul","fa-location-arrow","fa-lock","fa-long-arrow-down","fa-long-arrow-left","fa-long-arrow-right","fa-long-arrow-up","fa-low-vision","fa-magic","fa-magnet","fa-mail-forward","fa-mail-reply","fa-mail-reply-all","fa-male","fa-map","fa-map-marker","fa-map-o","fa-map-pin","fa-map-signs","fa-mars","fa-mars-double","fa-mars-stroke","fa-mars-stroke-h","fa-mars-stroke-v","fa-maxcdn","fa-meanpath","fa-medium","fa-medkit","fa-meetup","fa-meh-o","fa-mercury","fa-microchip","fa-microphone","fa-microphone-slash","fa-minus","fa-minus-circle","fa-minus-square","fa-minus-square-o","fa-mixcloud","fa-mobile","fa-mobile-phone","fa-modx","fa-money","fa-moon-o","fa-mortar-board","fa-motorcycle","fa-mouse-pointer","fa-music","fa-navicon","fa-neuter","fa-newspaper-o","fa-object-group","fa-object-ungroup","fa-odnoklassniki","fa-odnoklassniki-square","fa-opencart","fa-openid","fa-opera","fa-optin-monster","fa-outdent","fa-pagelines","fa-paint-brush","fa-paper-plane","fa-paper-plane-o","fa-paperclip","fa-paragraph","fa-paste","fa-pause","fa-pause-circle","fa-pause-circle-o","fa-paw","fa-paypal","fa-pencil","fa-pencil-square","fa-pencil-square-o","fa-percent","fa-phone","fa-phone-square","fa-photo","fa-picture-o","fa-pie-chart","fa-pied-piper","fa-pied-piper-alt","fa-pied-piper-pp","fa-pinterest","fa-pinterest-p","fa-pinterest-square","fa-plane","fa-play","fa-play-circle","fa-play-circle-o","fa-plug","fa-plus","fa-plus-circle","fa-plus-square","fa-plus-square-o","fa-podcast","fa-power-off","fa-print","fa-product-hunt","fa-puzzle-piece","fa-qq","fa-qrcode","fa-question","fa-question-circle","fa-question-circle-o","fa-quora","fa-quote-left","fa-quote-right","fa-ra","fa-random","fa-ravelry","fa-rebel","fa-recycle","fa-reddit","fa-reddit-alien","fa-reddit-square","fa-refresh","fa-registered","fa-remove","fa-renren","fa-reorder","fa-repeat","fa-reply","fa-reply-all","fa-resistance","fa-retweet","fa-rmb","fa-road","fa-rocket","fa-rotate-left","fa-rotate-right","fa-rouble","fa-rss","fa-rss-square","fa-rub","fa-ruble","fa-rupee","fa-s15","fa-safari","fa-save","fa-scissors","fa-scribd","fa-search","fa-search-minus","fa-search-plus","fa-sellsy","fa-send","fa-send-o","fa-server","fa-share","fa-share-alt","fa-share-alt-square","fa-share-square","fa-share-square-o","fa-shekel","fa-sheqel","fa-shield","fa-ship","fa-shirtsinbulk","fa-shopping-bag","fa-shopping-basket","fa-shopping-cart","fa-shower","fa-sign-in","fa-sign-language","fa-sign-out","fa-signal","fa-signing","fa-simplybuilt","fa-sitemap","fa-skyatlas","fa-skype","fa-slack","fa-sliders","fa-slideshare","fa-smile-o","fa-snapchat","fa-snapchat-ghost","fa-snapchat-square","fa-snowflake-o","fa-soccer-ball-o","fa-sort","fa-sort-alpha-asc","fa-sort-alpha-desc","fa-sort-amount-asc","fa-sort-amount-desc","fa-sort-asc","fa-sort-desc","fa-sort-down","fa-sort-numeric-asc","fa-sort-numeric-desc","fa-sort-up","fa-soundcloud","fa-space-shuttle","fa-spinner","fa-spoon","fa-spotify","fa-square","fa-square-o","fa-stack-exchange","fa-stack-overflow","fa-star","fa-star-half","fa-star-half-empty","fa-star-half-full","fa-star-half-o","fa-star-o","fa-steam","fa-steam-square","fa-step-backward","fa-step-forward","fa-stethoscope","fa-sticky-note","fa-sticky-note-o","fa-stop","fa-stop-circle","fa-stop-circle-o","fa-street-view","fa-strikethrough","fa-stumbleupon","fa-stumbleupon-circle","fa-subscript","fa-subway","fa-suitcase","fa-sun-o","fa-superpowers","fa-superscript","fa-support","fa-table","fa-tablet","fa-tachometer","fa-tag","fa-tags","fa-tasks","fa-taxi","fa-telegram","fa-television","fa-tencent-weibo","fa-terminal","fa-text-height","fa-text-width","fa-th","fa-th-large","fa-th-list","fa-themeisle","fa-thermometer","fa-thermometer-0","fa-thermometer-1","fa-thermometer-2","fa-thermometer-3","fa-thermometer-4","fa-thermometer-empty","fa-thermometer-full","fa-thermometer-half","fa-thermometer-quarter","fa-thermometer-three-quarters","fa-thumb-tack","fa-thumbs-down","fa-thumbs-o-down","fa-thumbs-o-up","fa-thumbs-up","fa-ticket","fa-times","fa-times-circle","fa-times-circle-o","fa-times-rectangle","fa-times-rectangle-o","fa-tint","fa-toggle-down","fa-toggle-left","fa-toggle-off","fa-toggle-on","fa-toggle-right","fa-toggle-up","fa-trademark","fa-train","fa-transgender","fa-transgender-alt","fa-trash","fa-trash-o","fa-tree","fa-trello","fa-tripadvisor","fa-trophy","fa-truck","fa-try","fa-tty","fa-tumblr","fa-tumblr-square","fa-turkish-lira","fa-tv","fa-twitch","fa-twitter","fa-twitter-square","fa-umbrella","fa-underline","fa-undo","fa-universal-access","fa-university","fa-unlink","fa-unlock","fa-unlock-alt","fa-unsorted","fa-upload","fa-usb","fa-usd","fa-user","fa-user-circle","fa-user-circle-o","fa-user-md","fa-user-o","fa-user-plus","fa-user-secret","fa-user-times","fa-users","fa-vcard","fa-vcard-o","fa-venus","fa-venus-double","fa-venus-mars","fa-viacoin","fa-viadeo","fa-viadeo-square","fa-video-camera","fa-vimeo","fa-vimeo-square","fa-vine","fa-vk","fa-volume-control-phone","fa-volume-down","fa-volume-off","fa-volume-up","fa-warning","fa-wechat","fa-weibo","fa-weixin","fa-whatsapp","fa-wheelchair","fa-wheelchair-alt","fa-wifi","fa-wikipedia-w","fa-window-close","fa-window-close-o","fa-window-maximize","fa-window-minimize","fa-window-restore","fa-windows","fa-won","fa-wordpress","fa-wpbeginner","fa-wpexplorer","fa-wpforms","fa-wrench","fa-xing","fa-xing-square","fa-y-combinator","fa-y-combinator-square","fa-yahoo","fa-yc","fa-yc-square","fa-yelp","fa-yen","fa-yoast","fa-youtube","fa-youtube-play","fa-youtube-square"];return{list:function(){return e},exists:function(t){return e.indexOf(t)>-1}}}]),angular.module("opengate-angular-js").factory("Filter",["$window","$sce","$q",function(e,i,a){function o(e,t){var a,o,n,s=[];if(e&&0!==e.trim().length){var l=e.toLowerCase().trim();for(a=0;a<t.length&&s.length<8;a++)if(o=t[a],o.toLowerCase().indexOf(l)>-1){var c=s.find(function(e){return e.value===o});c||s.push({label:i.trustAsHtml(r(o,e)),value:o})}for(a=0;a<p.length&&s.length<12;a++)n=p[a],n.toLowerCase().indexOf(l)>-1&&s.push({label:i.trustAsHtml(r(n,e)),value:n})}else{for(a=0;a<t.length&&s.length<8;a++){o=t[a];var c=s.find(function(e){return e.value===o});c||s.push({label:i.trustAsHtml(r(o,e)),value:o})}for(a=0;a<p.length&&s.length<12;a++)n=p[a],s.push({label:i.trustAsHtml(r(n,e)),value:n})}return s}function n(e,i,n){var r=a.defer();return n.findFields(e).then(function(a){var n=a,s=-1;if(i.selectionStart?s=i.selectionStart-1:i.prop&&(s=i.prop("selectionStart")-1),!(s<0)){var l;if(e!==t&&""!==e){for(var c=-1;s>=0&&c===-1;s--)h.indexOf(e[s])>-1?c=s+1:0===s&&(c=s);var d=c;for(s=c;s<e.length&&d===c;s++)h.indexOf(e[s])>-1?d=s+1:s===e.length-1&&(d=s+1);l=o(e.substring(c,d),n)}else l=o();l.forEach(function(e){e.value=e.value}),r.resolve(l)}})["catch"](function(e){console.error(e),r.reject(e)}),r.promise}function r(e,t){var i=new RegExp("("+t+")","gi");return e.replace(i,'<span class="text-info">$1</span>')}function s(t){var i=a.defer(),o=i.promise,n=null,r={text:[],offsets:[],filter:{}};try{e.jsep.addBinaryOp("and",1),e.jsep.addBinaryOp("&&",1),e.jsep.addBinaryOp("||",2),e.jsep.addBinaryOp("or",2),e.jsep.addBinaryOp("in",2),e.jsep.addBinaryOp("within",2),e.jsep.addBinaryOp("~",6),e.jsep.addBinaryOp("=",6),e.jsep.addBinaryOp("like",6),e.jsep.addBinaryOp("gt",6),e.jsep.addBinaryOp("lte",6),e.jsep.addBinaryOp("gte",6),e.jsep.addBinaryOp("eq",6),e.jsep.addBinaryOp("neq",6),e.jsep.addBinaryOp(",",6),n=e.jsep(t),r.filter[n.operator]=[],r.filter=l(n),i.resolve(r)}catch(s){var c=s;s.description&&(c=s.description),i.reject(c)}return o}function l(e){var t,i,a,o={};if("BinaryExpression"===e.type&&/\eq|\neq|\like|\gt|\lt|\gte|\lte|\=|\'<'|\'>'|\~|\!/.test(e.operator)){t=d(e.left).split(".").reverse().join("."),t=t.replace(".undefined","[]");var n=e.right;if("UnaryExpression"===n.type&&n.prefix){var r=n.operator+n.argument.value;i=isNaN(r)?r:1*r}else i=n.name||n.value;a=u(e.operator),o[a]={},o[a][t]=i}else if("BinaryExpression"===e.type&&/or|and/.test(e.operator))o[e.operator]=[],o[e.operator].push(l(e.left)),o[e.operator].push(l(e.right));else if("BinaryExpression"===e.type&&/\within/.test(e.operator))"ArrayExpression"===e.right.type&&e.right.elements[0].left&&e.right.elements[0].right&&(t=d(e.left).split(".").reverse().join("."),t=t.replace(".undefined","[]"),a=u(e.operator),o[a]={},o[a][t]=[e.right.elements[0].left.value,e.right.elements[0].right.value]);else if("BinaryExpression"===e.type&&/\in/.test(e.operator)){t=d(e.left).split(".").reverse().join("."),t=t.replace(".undefined","[]"),a=u(e.operator),o[a]={};var s=c(e.right);console.log(s),o[a][t]=s}return o}function c(e){var t=[];switch(e.type){case"Identifier":t.push(e.name);break;case"Literal":t.push(e.value);break;case"BinaryExpression":if(/\,/.test(e.operator)){var i=c(e.left),a=c(e.right);t=i.concat(a)}}return t}function d(e){var t="";return"Identifier"===e.type?t=e.name:"MemberExpression"===e.type&&(t=e.property.name+"."+d(e.object)),t}function u(e){return"=="===e?"eq":"="===e?"eq":"!="===e?"neq":"~"===e?"like":">"===e?"gt":"<"===e?"lt":">="===e?"gte":"<="===e?"lte":e}var p=[],h=[" ","\n","!","=","~",">","<","&","or","and",")","in",",","neq","like","within"];return{suggest_field_delimited:function(e,t,i){var a=n(e,t,i);return a},parseQuery:function(e){var t=s(e);return t}}}]),angular.module("opengate-angular-js").service("$entityQratingUtils",[function(){function e(e){var t=0,i=0,a=0,o=0,n=0,r=0;return angular.forEach(e,function(e){var n=jsonPath(e,"_value._current.scoring");if(n){t+=n[0].performance;var r=n[0].qrating.max_score;r>0&&(o+=r*n[0].performance/100,a+=r),i++}}),i>0&&t>0&&a>0?(r=t/i,n=100*o/a,{qPerformance:n,avgPerformance:r,medidas:i,maxScore:a,score:o}):null}function t(e){var t=0,i=0,a=0,o=0,n=0,r=0;return angular.forEach(e,function(e,n){if(e._value&&e._value._current&&e._value._current.scoring&&e._value._current.scoring.qrating&&e._value._current.scoring.performance){var r=e._value._current.scoring;t+=r.performance;var s=r.qrating.max_score;s>0&&(o+=s*r.performance/100,a+=s),i++}}),i>0&&t>0&&a>0?(r=t/i,n=100*o/a,{qPerformance:n,avgPerformance:r,medidas:i,maxScore:a,score:o}):null}return{calculate:e,calculateFlattened:t}}]),angular.module("opengate-angular-js").service("$entityFlattenedExtractor",["$jsonFinderHelper",function(e){function t(t,i){var a=[];if(t&&t.length>0){var o={};angular.forEach(t,function(t,a){(t[e.provisioned.getAmpliaPath(i+"Identifier")]||t[e.collected.getAmpliaPath(i+"Identifier")])&&angular.forEach(t,function(e,n){n.startsWith("provision.device.communicationModules[]."+i)||n.startsWith("device.communicationModules[]."+i)?angular.forEach(e,function(e,i){e._index&&(o[a]||(o[a]={},o[a].$device=t),o[a][n]=e)}):(n.startsWith("provision.administration")||"resourceType"===n)&&(o[a]||(o[a]={},o[a].$device=t),o[a][n]=e)})}),angular.forEach(o,function(e,t){a.push(e)})}return a}function i(e,i){var a=t(e,"subscriber");return i&&(i=a),a}function a(e,i){var a=t(e,"subscription");return i&&(i=a),a}return{extractSubscribers:i,extractSubscriptions:a}}]).service("$entityExtractor",["$q",function(e){function t(e,t){var i=[];return(e&&e.length>0||e&&e.length>0)&&angular.forEach(e,function(e,a){var o=null,n=null;e.provision.device&&e.provision.device.communicationModules&&e.provision.device.communicationModules.length>0&&angular.forEach(e.provision.device.communicationModules,function(e,i){e[t]&&(o?o.provision||(o.provision={}):o={provision:{}},o.provision[t]=e[t],o.provision[t].identifier&&(n=angular.copy(o.provision[t].identifier)))}),e.device&&e.device.communicationModules&&e.device.communicationModules.length>0&&angular.forEach(e.device.communicationModules,function(e,i){e[t]&&(o||(o={}),o[t]=e[t])}),(o[t]||o.provision[t])&&(o.$device=e,e.provision.administration&&(o.provision||(o.provision={}),o.provision.administration=e.provision.administration,n&&(o.provision.administration.identifier=n))),o&&i.push(o)}),i}function i(i,a){var o;i&&i.devices?o=t(i.devices,"subscriber"):i&&i.data&&i.data.devices&&(o=t(i.data.devices,"subscriber")),a&&angular.copy(o,a);var n={subscribers:o};return e(function(e){e(a||n)})}function a(i,a){var o;i&&i.devices?o=t(i.devices,"subscription"):i&&i.data&&i.data.devices&&(o=t(i.data.devices,"subscription")),a&&angular.copy(o,a);var n={subscriptions:o};return e(function(e){e(a||n)})}return{extractSubscribers:i,extractSubscriptions:a}}]),angular.module("opengate-angular-js").service("$dataFormatter",[function(){return new v}]),v.prototype.format=function(e){return this.isDataUrl(e)?(new y).format(e):e},y.prototype=new v,y.prototype.format=function(e){return'<img alt="image" class="datastreamImage" src="'+e+'"/>'},angular.module("opengate-angular-js").filter("communicationsInterface",function(){return function(e){var t=e;switch(t){case"COMMUNICATIONS_MODULE":return"Communications module";case"SUBSCRIPTION":return"Mobile line";case"SUBSCRIBER":return"SIM";case"HOME_OPERATOR":return"Home Operator";case"REGISTER_OPERATOR":return"Register Operator";case"ADDRESS":return"IP";case"SOFTWARE":return"Software";case"HARDWARE":return"Hardware";case"entityKey":return"Identifier";default:return t}}}).filter("dateNames",function(){var e={MON:"Monday",TUE:"Tuesday",WED:"Wednesday",THU:"Thursday",FRI:"Friday",SAT:"Saturday",SUN:"Sunday"},t={JAN:"January",FEB:"February",MAR:"March",APR:"April",MAY:"May",JUN:"June",JUL:"July",AUG:"August",SEP:"September",OCT:"October",NOV:"November",DEC:"December"};return function(i){return e[i]||t[i]||i}}).filter("icons",function(){return function(e,t,i){var a="fa fa-info";return"list"===e&&(a="fa fa-list"),"ban"===e&&(a="fa fa-ban"),"laptop"===e&&(a="fa fa-laptop"),"spin"===e&&(a="fa fa-spinner fa-spin"),"unit"===e&&(a="fa fa-plus-square"),"tags"===e&&(a="fa fa-tags"),a}}).filter("codeErrors",function(){var e={1004:"At least one valid reference to an entity is required",1005:"At least one valid reference to an entity is required",1017:"Tag is not valid. Please, check it."};return function(t){return{code:t.code,message:e[t.code]||t.message}}}).filter("wapiErrors",function(){var e={"-1":"Connection problems",413:"Upload size exceeded"};return function(t,i){var a="";return a=angular.isUndefined(i)?e[t]?e[t]:"Code: "+t:i+" ("+(e[t]?e[t]:"Code: "+t)+")"}}).filter("textlength",function(){return function(e,t){var i=30;return t&&angular.isNumber(t)&&(i=t),e&&e.length>i?e.substring(0,i)+"...":e}}).filter("compactid",function(){return function(e){return e&&e.indexOf(".")>-1?e.substring(e.lastIndexOf(".")+1):e}}),angular.module("opengate-angular-js").directive("showErrors",["$timeout","$interpolate",function(e,t){var i=function(i,a,o,n){var r,s,l,c,d,u,p=!1,h=!1;if(c=i.$eval(o.showErrors)||{},d=c.showSuccess||!1,r=a[0].querySelector(".form-control[name]")||a[0].querySelector("[name]"),l=angular.element(r),s=t(l.attr("name")||"")(i),!s)throw"show-errors element has no child input elements with a 'name' attribute class";var f=function(){return e(function(){a.removeClass("has-error"),a.removeClass("has-success"),h=!1},0,!1)};i.$watch(function(){return n[s]&&n[s].$invalid},function(e){return u(e)}),i.$on("show-errors-check-validity",function(e,t){if(angular.isUndefined(t)||n.$name===t)return p=!0,h=!0,u(n[s].$invalid)}),i.$on("show-errors-reset",function(e,t){if(angular.isUndefined(t)||n.$name===t)return f()}),u=function(e){if(a.toggleClass("has-error",h&&e),d)return a.toggleClass("has-success",h&&!e)}};return{restrict:"A",require:"^form",compile:function(e,t){if(t.showErrors.indexOf("skipFormGroupCheck")===-1&&!e.hasClass("form-group")&&!e.hasClass("input-group"))throw"show-errors element does not have the 'form-group' or 'input-group' class";return i}}}]),angular.module("opengate-angular-js").directive("elemReady",["$parse",function(e){return{restrict:"A",link:function(t,i,a){i.ready(function(){t.$apply(function(){var i=e(a.elemReady);i(t)})})}}}]),angular.module("opengate-angular-js").directive("disallowSpaces",function(){return{restrict:"A",link:function(t,i){i.bind("input",function(){e.$(this).val(e.$(this).val().replace(/ /g,""))})}}}),angular.module("opengate-angular-js").controller("fieldOptionsController",["$scope","$element","$attrs",function(e,t,i){}]),angular.module("opengate-angular-js").component("fieldOptions",{templateUrl:"components/views/fieldOptions.html",controller:"fieldOptionsController",bindings:{multiple:"<",required:"<"}})}(window);