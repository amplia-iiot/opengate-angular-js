!function(e,t){"use strict";function i(e){function t(e){return e}var i=this,n={},a=new L.OsmGeocodingService(e,n),o={house_number:{"Num casa":!0},road:{Calle:!0},suburb:{Suburb:!1},city:{Ciudad:!0},county:{Provincia:!0},state_district:{Suburb:!1},state:{Estado:!1},postcode:{CP:!1},country:{"Pa√≠s":!0},country_code:{cc:!1}};i.search=function(e,t,i){var n=e;!t&&"2"||t.limit||"3";a.search(n,t,i)},i.reverseSearch=function(e,i,n,r,s,l){$.extend({},o);s=$.extend({},s),a.reverseSearch(e,i,n,function(e,i){if(e)r(e);else{var n=t(i);r(null,n)}},s,l)}}function n(e,t,i,n,a){var o=L.UxMap||L.Map;return{restrict:"EA",replace:!0,scope:{center:"=",lfCenter:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"=",markersWatchOptions:"=",geojsonWatchOptions:"="},transclude:!0,template:"<div class='angular-leaflet-map'><div ng-transclude></div></div>",controller:["$scope",function(t){this._leafletMap=e.defer(),this.getMap=function(){return this._leafletMap.promise},this.getLeafletScope=function(){return t}}],link:function(e,r,s,l){function c(){isNaN(s.width)?r.css("width",s.width):r.css("width",s.width+"px")}function d(){isNaN(s.height)?r.css("height",s.height):r.css("height",s.height+"px")}var u,p=n.isDefined,m=i.setDefaults(e.defaults,s.id),h=a.getAvailableMapEvents(),f=a.addEvents;e.mapId=s.id,t.setDirectiveControls({},s.id),p(s.width)&&(c(),e.$watch(function(){return r[0].getAttribute("width")},function(){c(),u.invalidateSize()})),p(s.height)&&(d(),e.$watch(function(){return r[0].getAttribute("height")},function(){d(),u.invalidateSize()}));var g=i.getMapCreationDefaults(s.id);if(u=new o(r[0],g),l._leafletMap.resolve(u),p(s.center)||p(s.lfCenter)||u.setView([m.center.lat,m.center.lng],m.center.zoom),!p(s.tiles)&&!p(s.layers)){var v=L.tileLayer(m.tileLayer,m.tileLayerOptions);v.addTo(u),t.setTiles(v,s.id)}if(p(u.zoomControl)&&p(m.zoomControlPosition)&&u.zoomControl.setPosition(m.zoomControlPosition),p(u.zoomControl)&&m.zoomControl===!1&&u.zoomControl.removeFrom(u),p(u.zoomsliderControl)&&p(m.zoomsliderControl)&&m.zoomsliderControl===!1&&u.zoomsliderControl.removeFrom(u),!p(s.eventBroadcast)){var y="broadcast";f(u,h,"eventName",e,y)}u.whenReady(function(){t.setMap(u,s.id)}),e.$on("$destroy",function(){i.reset(),u.remove(),t.unresolveMap(s.id)}),e.$on("invalidateSize",function(){u.invalidateSize()})}}}function a(){}function o(){Object.defineProperty(this,"fields",{value:{identifier:"provision.administration.identifier",organization:"provision.administration.organization",serviceGroup:"provision.administration.serviceGroup",channel:"provision.administration.channel",feed:"provision.administration.defaultFeed",plan:"provision.administration.plan",resourceType:"resourceType"},writable:!1})}function r(){Object.defineProperty(this,"fields",{value:{specificType:"device.specificType",location:"device.location",entityLocation:"entity.location",name:"device.name",description:"device.description",operationalStatus:"device.operationalStatus",serialNumber:"device.serialNumber",topologyPath:"device.topology.path",clock:"device.clock",identifier:"device.identifier",model:"device.model",software:"device.software",trustedBoot:"device.trustedBoot",image:"device.image",related:"device.related",commsModule:"provision.device.communicationModules[]",commsModuleIdentifier:"provision.device.communicationModules[].identifier",commsModuleSpecificType:"provision.device.communicationModules[].specificType",commsModuleImei:"provision.device.communicationModules[].mobile.imei",imei:"provision.device.communicationModules[].mobile.imei",pac:"provision.device.communicationModules[].sigfox.pac",subscriberIdentifier:"device.communicationModules[].subscriber.identifier",subscriberSerialNumber:"device.communicationModules[].subscriber.serialNumber",subscriberSpecificType:"device.communicationModules[].subscriber.specificType",subscriberName:"device.communicationModules[].subscriber.name",subscriberDescription:"device.communicationModules[].subscriber.description",subscriptionIdentifier:"device.communicationModules[].subscription.identifier",subscriptionSpecificType:"device.communicationModules[].subscription.specificType",subscriptionName:"device.communicationModules[].subscription.name",subscriptionDescription:"device.communicationModules[].subscription.description",subscriptionImsi:"device.communicationModules[].subscription.mobile.imsi",imsi:"device.communicationModules[].subscription.mobile.imsi",subscriptionMsisdn:"device.communicationModules[].subscription.mobile.msisdn",msisdn:"device.communicationModules[].subscription.mobile.msisdn",subscriptionMsisdnVoice:"device.communicationModules[].subscription.mobile.voice.msisdn",subscriptionAddress:"device.communicationModules[].subscription.address",address:"device.communicationModules[].subscription.address",subscriptionHomeOperator:"device.communicationModules[].subscription.mobile.homeOperator",homeOperator:"device.communicationModules[].subscription.mobile.homeOperator",subscriptionRegisteredOperator:"device.communicationModules[].subscription.mobile.registeredOperator",registereOperator:"device.communicationModules[].subscription.mobile.registeredOperator",sigfoxDeviceType:"device.communicationModules[].subscription.sigfox.deviceType"},writable:!1})}function s(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{adState:"provision.device.administrativeState",certificates:"provision.device.certificates",subscriberAdState:"device.communicationModules[].subscriber.administrativeState",subscriptionAdState:"device.communicationModules[].subscription.administrativeState",subscriberIcc:"provision.device.communicationModules[].subscriber.mobile.icc",icc:"provision.device.communicationModules[].subscriber.mobile.icc"}),writable:!1})}function l(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{image:"asset.image"}),writable:!1})}function c(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{image:"provision.asset.image"}),writable:!1})}function d(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{identifier:"provision.ticket.identifier",name:"provision.ticket.name",label:"provision.ticket.label",type:"provision.ticket.type",severity:"provision.ticket.severity",priority:"provision.ticket.priority",reporter:"provision.ticket.reporter",owner:"provision.ticket.owner",assignee:"provision.ticket.assignee",status:"provision.ticket.status",section:"provision.ticket.section",entity:"provision.ticket.entity",creationDate:"provision.ticket.creationDate",reporterDate:"provision.ticket.reporterDate",assignedDate:"provision.ticket.assignedDate",answeredDate:"provision.ticket.answeredDate",updatedDate:"provision.ticket.updatedDate",restorationDate:"provision.ticket.restorationDate",resolutionDate:"provision.ticket.resolutionDate",closedDate:"provision.ticket.closedDate",specificType:"provision.ticket.specificType"}),writable:!1})}function u(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{surname:"human.surname",surname2:"human.surname2",birthdate:"human.birthdate"}),writable:!1})}function p(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{surname:"provision.human.surname",surname2:"provision.human.surname2",birthdate:"provision.human.birthdate"}),writable:!1})}function m(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{adState:"device.communicationModules[].subscriber.administrativeState",identifier:"device.communicationModules[].subscriber.identifier",specificType:"device.communicationModules[].subscriber.specificType"}),writable:!1})}function h(){}function f(){}function g(){Object.defineProperty(this,"fields",{value:Object.assign({},this.fields,{adState:"device.communicationModules[].subscription.administrativeState",identifier:"device.communicationModules[].subscription.identifier",specificType:"device.communicationModules[].subscription.specificType"}),writable:!1})}function v(e){function t(e){return e?(e=name+"",e.startsWith(".fa-")===!1&&(e=e.startsWith("fa-")?"."+e:".fa-"+e),o[name]||""):""}function i(e){for(var t=document.styleSheets,i=0;i<t.length;i++){var a=document.styleSheets[i];if(a.href&&a.href.indexOf(e)>0)try{n(a.href)}catch(o){console.error("WARN: Error httpRequesting file from "+a.href,o)}}}function n(t){e({method:"GET",url:t}).then(function(e){var t=a(e);o=angular.extend(o,t)},function(e){console.error("WARN: Error retrieving file from "+t,e)})}function a(e){for(var t={},i=e.data||"",n=i.split("}"),a=0;a<n.length;a++){var o=n[a],r=o.split("{");if(2===r.length){var s=r[1];if(s.indexOf("content")!==-1){var l=s.split('"');if(3===l.length)for(var c=l[1].substring(1),d=r[0].trim(),u=d.split(","),p=0;p<u.length;p++){var m=u[p].split(":")[0].trim();m.startsWith(".fa-")&&(t[m.substring(1)]=c)}}}}return t}var o={},r="font-awesome";return i(r),{getStyles:function(){return o},getChar:t}}function y(){this.dataurl_regex=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i,this.isDataUrl=function(e){return"string"==typeof e&&!!e.match(this.dataurl_regex)}}function b(){}if(angular.module("uxleaflet",[]),angular.module("opengate-angular-js",["schemaForm","uxleaflet","ui-leaflet"]),angular.module("opengate-angular-js").run(["$templateCache",function(e){e.put("components/views/action.button.html",'<div class=input-group><div ng-repeat="action in $ctrl.actions" class=input-group-addon permission permission-only=action.permissions><a title={{action.title}} style=cursor:pointer ng-click=$ctrl.onAction(action) class="custom-ui-select-button btn btn-xs no-margin {{(action.disable && action.disable()) ? \'disabled\' : \'\'}}"><i class="text-primary {{action.icon}}"></i>&nbsp;<small>{{action.title}}</small></a></div></div>'),e.put("components/views/custom.ui.map.html",'<div class=no-margin><div class="col-xs-12 no-padding"><label class=custom-ui-select-label>{{ ($ctrl.label?$ctrl.label:\'FORM.LABEL.ENTITY_KEY\') | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple loading=$ctrl.reloadingInfo></field-options></label></div><div class=row ng-if=!$ctrl.disabled><div class="col-xs-3 form-group no-margin"><input ng-required=$ctrl.required type=number class=form-control title="{{ \'FORM.TITLE.LATITUDE\' | translate }}" placeholder="{{ \'FORM.TITLE.LATITUDE\' | translate }}" ng-model=$ctrl.coordsObj.new.lat></div><div class="col-xs-3 form-group no-margin"><input ng-required=$ctrl.required type=number class=form-control title="{{ \'FORM.TITLE.LONGITUDE\' | translate }}" placeholder="{{ \'FORM.TITLE.LONGITUDE\' | translate }}" ng-model=$ctrl.coordsObj.new.lng></div><div class="col-xs-2 form-group no-margin"><button type=button ng-disabled="$ctrl.coordsObj.current.lat === $ctrl.coordsObj.new.lat && $ctrl.coordsObj.current.lng === $ctrl.coordsObj.new.lng" class="btn btn-info no-margin" ng-click=$ctrl.searchCoords()><i class="fa fa-search"></i></button> <button type=button ng-if=!$ctrl.disabled class="btn btn-default no-margin" ng-click=$ctrl.applyCoords()><i class="fa fa-map-marker"></i></button></div></div><div class=col-xs-12><small>{{ $ctrl.display_name }}&nbsp;</small></div><leaflet ng-if=$ctrl.showMap id="{{ $ctrl.map.id }}" lf-center=$ctrl.map.center layers=$ctrl.map.layers controls=$ctrl.map.controls event-broadcast=$ctrl.map.events markers=$ctrl.map.markers width=100% height=150px></leaflet><div class=row ng-if="!$ctrl.disabled && !$ctrl.onlyMap"><div class="col-xs-12 col-md-5 form-group no-margin"><input ng-required=$ctrl.required type=text class=form-control title="{{ \'FORM.TITLE.ADDRESS\' | translate }}" placeholder="{{ \'FORM.TITLE.ADDRESS\' | translate }}" ng-model=$ctrl.location.address></div><div class="col-xs-12 col-md-5 form-group no-margin"><input ng-required=$ctrl.required type=text class=form-control title="{{ \'FORM.TITLE.TOWN\' | translate }}" placeholder="{{ \'FORM.TITLE.TOWN\' | translate }}" ng-model=$ctrl.location.town></div><div class="col-xs-12 col-md-2 form-group no-margin"><input ng-required=$ctrl.required type=text class=form-control title="{{ \'FORM.TITLE.POSTAL_CODE\' | translate }}" placeholder="{{ \'FORM.TITLE.POSTAL_CODE\' | translate }}" ng-model=$ctrl.location.postal></div></div><div class=row ng-if="!$ctrl.disabled && !$ctrl.onlyMap"><div class="col-xs-12 col-md-5 form-group no-margin"><input ng-required=$ctrl.required type=text class=form-control title="{{ \'FORM.TITLE.PROVINCE\' | translate }}" placeholder="{{ \'FORM.TITLE.PROVINCE\' | translate }}" ng-model=$ctrl.location.province></div><div class="col-xs-12 col-md-5 form-group no-margin"><input ng-required=$ctrl.required type=text class=form-control title="{{ \'FORM.TITLE.REGION\' | translate }}" placeholder="{{ \'FORM.TITLE.REGION\' | translate }}" ng-model=$ctrl.location.region></div><div class="col-xs-12 col-md-2 form-group no-margin"><input ng-required=$ctrl.required type=text class=form-control title="{{ \'FORM.TITLE.COUNTRY.NAME\' | translate }}" placeholder="{{ \'FORM.TITLE.COUNTRY.NAME\' | translate }}" ng-model=$ctrl.location.country></div></div></div>'),e.put("components/views/fieldOptions.html",'<small class=ux-txt-danger ng-if=$ctrl.required title="{{ \'FORM.FIELD.REQUIRED\' | translate }}">*</small> <small class=ux-txt-warning ng-if=$ctrl.optional title="{{ \'FORM.FIELD.OPTIONAL\' | translate }}">(-)</small> <small class=ux-txt-info ng-if=$ctrl.multiple title="{{ \'FORM.FIELD.MULTIPLE\' | translate }}"><span class=fa-stack style=font-size:0.5em;><i class="fa fa-clone fa-stack-2x"></i> <i class="fa fa-check fa-stack-1x"></i></span></small> <small class=ux-txt-info ng-if=$ctrl.loading><span class="fa fa-spinner fa-spin" style=font-size:1.2em;></span></small>'),e.put("custom-ui-select/views/custom.ui.select.area.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.AREA\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=area ng-model=$ctrl.area theme=bootstrap title="{{ \'FORM.PLACEHOLDER.AREA_MULTI\' | translate }}" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.areaSelected($item, $model)" on-remove="$ctrl.areaRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.AREA_MULTI\' | translate }}" allow-clear=true>{{$item.identifier}}</ui-select-match><ui-select-choices repeat="area in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="area.identifier | highlight: $select.search"></span> - <span ng-bind-html="area.name | highlight: $select.search"></span><br><span ng-bind-html="area.organization | highlight: $select.search"></span></div></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.AREA\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=area ng-model=$ctrl.area theme=bootstrap title="Choose an area" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.areaSelected($item, $model)" on-remove="$ctrl.areaRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.AREA\' | translate }}" allow-clear=true>{{$item.identifier}}</ui-select-match><ui-select-choices repeat="area in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="area.identifier | highlight: $select.search"></span> - <span ng-bind-html="area.name | highlight: $select.search"></span><br><span ng-bind-html="area.organization | highlight: $select.search"></span></div></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.asset.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label ng-if=$ctrl.label class=custom-ui-select-label>{{ $ctrl.label | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig ng-disabled=$ctrl.disabled name=asset ng-model=$ctrl.asset theme=bootstrap title="Choose a asset" custom-ui-select custom-ui-select-action=$ctrl.action multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.assetSelected($item, $model)" on-remove="$ctrl.assetRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="assetData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="assetData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=assetData.provision.asset.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="assetData.provision.asset.specificType._current.value | highlight: $select.search"></span></div><div ng-if=assetData.provision.asset.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+assetData.provision.asset.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label ng-if=$ctrl.label class=custom-ui-select-label>{{ $ctrl.label | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig ng-disabled=$ctrl.disabled name=asset ng-model=$ctrl.asset theme=bootstrap title="Choose an asset" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.assetSelected($item, $model)" on-remove="$ctrl.assetRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="assetData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="assetData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=assetData.provision.asset.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="assetData.provision.asset.specificType._current.value | highlight: $select.search"></span></div><div ng-if=assetData.provision.asset.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+assetData.provision.asset.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><action-button ng-if="$ctrl.actions && !$ctrl.disabled" actions=$ctrl.actions></action-button>'),e.put("custom-ui-select/views/custom.ui.select.bundle.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.BUNDLE_NAME\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=bundle ng-model=$ctrl.bundle theme=bootstrap title="{{ \'FORM.PLACEHOLDER.BUNDLE_MULTI\' | translate }}" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.bundleSelected($item, $model)" on-remove="$ctrl.bundleRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.BUNDLE_MULTI\' | translate }}" allow-clear=true>{{$item.name}} (v{{$item.version}})</ui-select-match><ui-select-choices repeat="bundle in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="bundle.name | highlight: $select.search"></span> - <span ng-bind-html="bundle.version | highlight: $select.search"></span><br><span ng-bind-html="bundle.description | highlight: $select.search"></span></div></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.BUNDLE_NAME\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=bundle ng-model=$ctrl.bundle theme=bootstrap title="Choose an bundle" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.bundleSelected($item, $model)" on-remove="$ctrl.bundleRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.BUNDLE\' | translate }}" allow-clear=true>{{$item.name}} (v{{$item.version}})</ui-select-match><ui-select-choices repeat="bundle in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="bundle.name | highlight: $select.search"></span> (v<span ng-bind-html="bundle.version | highlight: $select.search"></span>)<br><span ng-bind-html="bundle.description | highlight: $select.search"></span></div></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.datastream.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ \'FORM.LABEL.DATASTREAM_ID\' | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig ng-disabled=$ctrl.disabled name=datastream ng-model=$ctrl.datastream theme=bootstrap title="{{ ($ctrl.placeholder?$ctrl.placeholder:\'FORM.PLACEHOLDER.DATASTREAM\') | translate }}" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.datastreamSelected($item, $model)" on-remove="$ctrl.datastreamRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ ($ctrl.placeholder?$ctrl.placeholder:\'FORM.PLACEHOLDER.DATASTREAM\') | translate }}" allow-clear=true>{{$item.identifier}}</ui-select-match><ui-select-choices repeat="ds in $ctrl.ownConfig.collection | limitTo:$ctrl.maxResults track by $index"><div><span ng-bind-html="ds.identifier | highlight: $select.search"></span> - <span ng-bind-html="ds.name | highlight: $select.search"></span></div><small><div ng-if=ds.category.name>{{ \'FORM.LABEL.CATEGORY\' | translate }} <span ng-bind-html="ds.category.name | highlight: $select.search"></span></div><div ng-if=ds.feed>{{ \'FORM.LABEL.FEED\' | translate }}: <span ng-bind-html="ds.feed | highlight: $select.search"></span></div><div ng-if=ds.datamodel><div>{{ \'FORM.LABEL.DATAMODEL\' | translate }}:</div><div>- {{ \'FORM.LABEL.ID\' | translate }}: <span ng-bind-html="ds.datamodel.identifier | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.ORGANIZATION\' | translate }}: <span ng-bind-html="ds.datamodel.organization | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="ds.datamodel.name | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.DESCRIPTION\' | translate }}: <span ng-bind-html="ds.datamodel.description | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.VERSION\' | translate }}: <span ng-bind-html="ds.datamodel.version | highlight: $select.search"></span></div></div></div></div></div></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.DATASTREAM_ID\' | translate}}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig ng-disabled=$ctrl.disabled name=datastream ng-model=$ctrl.datastream theme=bootstrap title="{{ ($ctrl.placeholder?$ctrl.placeholder:\'FORM.PLACEHOLDER.DATASTREAM\') | translate }}" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.datastreamSelected($item, $model)" on-remove="$ctrl.datastreamRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ ($ctrl.placeholder?$ctrl.placeholder:\'FORM.PLACEHOLDER.DATASTREAM\') | translate }}" allow-clear=true>{{$item.identifier}}</ui-select-match><ui-select-choices repeat="ds in $ctrl.ownConfig.collection | limitTo:$ctrl.maxResults track by $index"><div><span ng-bind-html="ds.identifier | highlight: $select.search"></span> - <span ng-bind-html="ds.name | highlight: $select.search"></span></div><small><div ng-if=ds.category.name>{{ \'FORM.LABEL.CATEGORY\' | translate }} <span ng-bind-html="ds.category.name | highlight: $select.search"></span></div><div ng-if=ds.feed>{{ \'FORM.LABEL.FEED\' | translate }}: <span ng-bind-html="ds.feed | highlight: $select.search"></span></div><div ng-if=ds.datamodel><div>{{ \'FORM.LABEL.DATAMODEL\' | translate }}:</div><div>- {{ \'FORM.LABEL.ID\' | translate }}: <span ng-bind-html="ds.datamodel.identifier | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.ORGANIZATION\' | translate }}: <span ng-bind-html="ds.datamodel.organization | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="ds.datamodel.name | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.DESCRIPTION\' | translate }}: <span ng-bind-html="ds.datamodel.description | highlight: $select.search"></span><div>- {{ \'FORM.LABEL.VERSION\' | translate }}: <span ng-bind-html="ds.datamodel.version | highlight: $select.search"></span></div></div></div></div></div></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.device.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ ($ctrl.label?$ctrl.label:\'FORM.LABEL.ENTITY_KEY\') | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig ng-disabled=$ctrl.disabled name=device ng-model=$ctrl.device theme=bootstrap title="Choose a entity" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.deviceSelected($item, $model)" on-remove="$ctrl.deviceRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="entityData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=entityData.provision.device.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.operationalStatus._current.value>{{ \'FORM.LABEL.OP_STATUS\' | translate }}: <span ng-bind-html="\'\'+entityData.provision.device.operationalStatus._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].subscriber && entityData.provision.device.communicationModules[0].subscriber.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].subscriber.specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].subscription && entityData.provision.device.communicationModules[0].subscription.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].subscription.specificType._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{ ($ctrl.label?$ctrl.label:\'FORM.LABEL.ENTITY_KEY\') | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig ng-disabled=$ctrl.disabled name=device ng-model=$ctrl.device theme=bootstrap title="Choose a entity" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.deviceSelected($item, $model)" on-remove="$ctrl.deviceRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="entityData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=entityData.provision.device.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.operationalStatus._current.value>{{ \'FORM.LABEL.OP_STATUS\' | translate }}: <span ng-bind-html="\'\'+entityData.provision.device.operationalStatus._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].subscriber && entityData.provision.device.communicationModules[0].subscriber.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].subscriber.specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].subscription && entityData.provision.device.communicationModules[0].subscription.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].subscription.specificType._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><action-button ng-if="$ctrl.actions && !$ctrl.disabled" actions=$ctrl.actions></action-button>'),
e.put("custom-ui-select/views/custom.ui.select.domain.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label for=domain class=custom-ui-select-label>{{ ($ctrl.label?$ctrl.label:\'FORM.LABEL.DOMAIN\') | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select name=domain custom-ui-select-config=$ctrl.ownConfig ng-model=$ctrl.domain theme=bootstrap title="Choose a domaion" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.domainSelected($item, $model)" on-remove="$ctrl.domainRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.DOMAIN\' | translate }}" allow-clear=true>{{$item.name}}</ui-select-match><ui-select-choices repeat="domainData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="domainData.name | highlight: $select.search"></span></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label for=domain class=custom-ui-select-label>{{ ($ctrl.label?$ctrl.label:\'FORM.LABEL.DOMAIN\') | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=domain ng-model=$ctrl.domain theme=bootstrap title="Choose a domain" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.domainSelected($item, $model)" on-remove="$ctrl.domainRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.DOMAIN\' | translate }}" allow-clear=true>{{$item.name}}</ui-select-match><ui-select-choices repeat="domainData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="domainData.name | highlight: $select.search"></span></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.entity.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{ ($ctrl.label?$ctrl.label:\'FORM.LABEL.ENTITY_KEY\') | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig ng-disabled=$ctrl.disabled name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select custom-ui-select-action=$ctrl.action multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="entityData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=entityData.resourceType._current.value>{{ \'FORM.LABEL.RESOURCE_TYPE\' | translate }}: <span ng-bind-html="entityData.resourceType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.asset.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.asset.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.operationalStatus._current.value>{{ \'FORM.LABEL.OP_STATUS\' | translate }}: <span ng-bind-html="\'\'+entityData.provision.device.operationalStatus._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].subscriber && entityData.provision.device.communicationModules[0].subscriber.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].subscriber.specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].subscription && entityData.provision.device.communicationModules[0].subscription.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].subscription.specificType._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{($ctrl.label?$ctrl.label:\'FORM.LABEL.ENTITY_KEY\') | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig ng-disabled=$ctrl.disabled name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select custom-ui-select-action=$ctrl.action multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.ENTITY\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="entityData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=entityData.resourceType._current.value>{{ \'FORM.LABEL.RESOURCE_TYPE\' | translate }}: <span ng-bind-html="entityData.resourceType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.asset.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.asset.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.specificType._current.value | highlight: $select.search"></span></div><div ng-if=entityData.provision.device.operationalStatus._current.value>{{ \'FORM.LABEL.OP_STATUS\' | translate }}: <span ng-bind-html="\'\'+entityData.provision.device.operationalStatus._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].subscriber && entityData.provision.device.communicationModules[0].subscriber.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].subscriber.specificType._current.value | highlight: $select.search"></span></div><div ng-if="!entityData.provision.device.specificType && entityData.provision.device.communicationModules && entityData.provision.device.communicationModules[0] && entityData.provision.device.communicationModules[0].subscription && entityData.provision.device.communicationModules[0].subscription.specificType._current.value">{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="entityData.provision.device.communicationModules[0].subscription.specificType._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.subscriber.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate}}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="Choose a entity" allow-clear=true>{{$item.provision.subscriber.identifier._current.value}}</ui-select-match><ui-select-choices repeat="subscriberData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="subscriberData.provision.subscriber.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=subscriberData.provision.subscriber.name._current.value>Name: <span ng-bind-html="\'\'+subscriberData.provision.subscriber.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate}}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="Choose a entity" allow-clear=true>{{$item.provision.subscriber.identifier._current.value}}</ui-select-match><ui-select-choices repeat="subscriberData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="subscriberData.provision.subscriber.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=subscriberData.provision.subscriber.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+subscriberData.provision.subscriber.name._current.value | highlight: $select.search"></span></div><div ng-if=subscriberData.provision.subscriber.mobile.icc._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+subscriberData.provision.subscriber.mobile.icc.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/custom.ui.select.subscription.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="Choose a entity" allow-clear=true>{{$item.provision.subscription.identifier._current.value}}</ui-select-match><ui-select-choices repeat="subscriptionData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="subscriptionData.provision.subscription.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=subscriptionData.provision.subscription.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+subscriptionData.provision.subscription.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.ENTITY_KEY\' | translate }}<field-options required=$ctrl.ngRequired multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.entity theme=bootstrap title="Choose a entity" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.entitySelected($item, $model)" on-remove="$ctrl.entityRemove($item, $model)" ng-required=$ctrl.ngRequired><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="Choose a entity" allow-clear=true>{{$item.provision.subscription.identifier._current.value}}</ui-select-match><ui-select-choices repeat="subscriptionData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="subscriptionData.provision.subscription.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=subscriptionData.provision.subscription.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="\'\'+subscriptionData.provision.subscription.name._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><action-button ng-if="$ctrl.actions && !$ctrl.disabled" actions=$ctrl.actions></action-button>'),e.put("custom-ui-select/views/custom.ui.select.ticket.html",'<div class="form-group no-margin" mass-autocomplete ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.TICKET\' | translate}}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.ticket theme=bootstrap title="Choose a ticket" custom-ui-select multiple=true custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.ticketSelected($item, $model)" on-remove="$ctrl.ticketRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.TICKET\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="ticketData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="ticketData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=ticketData.provision.ticket.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.name._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.type._current.value>{{ \'FORM.LABEL.TYPE\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.type._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.specificType._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.status._current.value>{{ \'FORM.LABEL.STATUS\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.status._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div><div class="form-group no-margin" mass-autocomplete ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.TICKET\' | translate}}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=entity ng-model=$ctrl.ticket theme=bootstrap title="Choose a ticket" custom-ui-select multiple=false custom-mass-autocomplete-item=$ctrl.ownConfig on-select="$ctrl.ticketSelected($item, $model)" on-remove="$ctrl.ticketRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.TICKET\' | translate }}" allow-clear=true>{{$item.provision.administration.identifier._current.value || $item.identifier}}</ui-select-match><ui-select-choices repeat="ticketData in $ctrl.ownConfig.collection track by $index"><span ng-bind-html="ticketData.provision.administration.identifier._current.value | highlight: $select.search"></span> <small><div ng-if=ticketData.provision.ticket.name._current.value>{{ \'FORM.LABEL.NAME\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.name._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.type._current.value>{{ \'FORM.LABEL.TYPE\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.type._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.specificType._current.value>{{ \'FORM.LABEL.SPECIFIC_TYPE\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.specificType._current.value | highlight: $select.search"></span></div><div ng-if=ticketData.provision.ticket.status._current.value>{{ \'FORM.LABEL.STATUS\' | translate }}: <span ng-bind-html="ticketData.provision.ticket.status._current.value | highlight: $select.search"></span></div></small></ui-select-choices></ui-select></div>'),e.put("custom-ui-select/views/ui.select.icon.html",'<div class="form-group no-margin"><label ng-if=$ctrl.label for=icon translate>FORM.LABEL.ICON</label><div class="{{$ctrl.allowClear ? \'input-group\' : \'\'}}"><ui-select id=icon name=icon ng-model=$ctrl.icon theme=bootstrap ng-required=$ctrl.required title=$ctrl.title ng-disabled=$ctrl.disabled on-remove="$ctrl.iconRemove($item, $model)" on-select="$ctrl.iconSelected($item, $model)" allow-clear=$ctrl.allowClear uis-open-close=$ctrl.onOpenClose(isOpen)><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.ICON.CHOOSE\' | translate }}" allow-clear=$ctrl.allowClear><i class="fa {{$select.selected.key}} fa-2x"></i> <span>{{$select.selected.key}}</span></ui-select-match><ui-select-choices class=oux-icon-selector repeat="icon.key as (key, icon) in $ctrl.availableIcons | filter: $select.search | limitTo: $ctrl.maxIcons"><i class="fa fa-4x" ng-class=icon.key title={{icon.key}}></i><br><span ng-bind-html="icon.key| highlight: $select.search"></span></ui-select-choices></ui-select><span class=input-group-btn ng-if=$ctrl.allowClear><button type=button ng-click="$ctrl.icon = undefined" class="btn btn-default"><span class="glyphicon glyphicon-trash"></span></button></span></div></div>'),e.put("custom-ui-select/views/ui.select.resourceType.html",'<div class="form-group no-margin" ng-if=$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.RESOURCE_TYPE\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=resourceType ng-model=$ctrl.resourceType theme=bootstrap title="{{ \'FORM.PLACEHOLDER.RESOURCE_TYPE_MULTI\' | translate }}" custom-ui-select multiple=true on-select="$ctrl.resourceTypeSelected($item, $model)" on-remove="$ctrl.resourceTypeRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.RESOURCE_TYPE\' | translate }}" allow-clear=true>{{$item.identifier | translate}}</ui-select-match><ui-select-choices repeat="resourceType in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="resourceType.identifier | translate | highlight: $select.search"></span></div></ui-select-choices></ui-select></div><div class="form-group no-margin" ng-if=!$ctrl.multiple><label class=custom-ui-select-label>{{\'FORM.LABEL.RESOURCE_TYPE\' | translate }}<field-options required=$ctrl.required multiple=$ctrl.multiple></field-options></label><ui-select custom-ui-select-config=$ctrl.ownConfig name=resourceType ng-model=$ctrl.resourceType theme=bootstrap title="Choose an resourceType" custom-ui-select multiple=false on-select="$ctrl.resourceTypeSelected($item, $model)" on-remove="$ctrl.resourceTypeRemove($item, $model)" ng-required=$ctrl.required><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="{{ \'FORM.PLACEHOLDER.RESOURCE_TYPE\' | translate }}" allow-clear=true>{{$item.identifier | translate}}</ui-select-match><ui-select-choices repeat="resourceType in $ctrl.ownConfig.collection | filter:$select.search track by $index"><div><span ng-bind-html="resourceType.identifier | translate | highlight: $select.search"></span></div></ui-select-choices></ui-select></div>'),e.put("helper/views/custom.ui.select.helper.html",'<div class=form-group ng-hide=$ctrl.have_helper_keys ng-transclude=input><label for={{$ctrl.id}}>{{$ctrl.labelText | translate }}<field-options required=$ctrl.required></field-options></label> <input class=form-control name={{$ctrl.name}} type=text id={{$ctrl.id}} ng-model=$ctrl.helperModel ng-required=$ctrl.required> <span class=help-inline ng-show="!$ctrl.helperModel && $ctrl.required">{{$ctrl.labelError}}</span></div><div class=form-group ng-hide=!$ctrl.have_helper_keys><label for={{$ctrl.id}}>{{$ctrl.labelText | translate }}<field-options required=$ctrl.required></field-options></label><ui-select id={{$ctrl.id}} name={{$ctrl.name}} ng-model=$ctrl.helperModel theme=bootstrap title="Choose an option" ng-required=$ctrl.required tagging=$ctrl.helperTagTransform tagging-label=false><ui-select-match class={{$ctrl.uiSelectMatchClass}} placeholder="Choose an option"><span ng-if="$select.selected && $select.selected.key !== \'image\'">{{$select.selected.value}}</span> <img ng-if="$select.selected && $select.selected.key === \'image\'" src="{{ $select.selected.value }}" style=max-height:30px;></ui-select-match><ui-select-choices repeat="parameter.value as (key, parameter) in $ctrl.$helper_keys | filter: $select.search"><span ng-bind-html="parameter.key | highlight: $select.search"></span>: <small ng-if="parameter.key !== \'image\'" ng-bind-html="parameter.value | highlight: $select.search"></small> <img ng-if="parameter.key === \'image\'" src="{{ parameter.value }}" style=max-height:30px;></ui-select-choices></ui-select></div>'),e.put("helper/views/helper.view.html",'<div class="container col-md-12 col-xs-12" style=padding-left:0;padding-right:0 ng-transclude></div><div class="col-xs-12 col-md-12 text-right no-margin no-padding"><a class="btn btn-default btn-xs ux-txt-info pointer oux-button-margin" ng-href ng-click=$helper.open() ng-switch=$helper.mode><span ng-switch-when=button><i ng-class=$helper.helperButton aria-hidden=true></i></span> <span ng-switch-when=title>{{$helper.helperTitle}}</span> <span ng-switch-when=title_button><i ng-class=$helper.helperButton aria-hidden=true></i>{{$helper.helperTitle}}</span> <span ng-switch-default><i ng-if="!$helper.helperTitle && !$helper.helperButton" class="fa fa-lg fa-search-plus" title="{{ \'FORM.HELPER.TITLE\' | translate }}" aria-hidden=true></i></span></a></div><script type=text/ng-template id=helper.view.modal.html><div class="modal-header"> <h4 class="modal-title">{{ \'FORM.HELPER.TITLE\' | translate }}</h4> </div> <div class="modal-body without-padding-top"> <uib-accordion close-others="true"> <div uib-accordion-group is-open="$ctrl.mapIsOpen" ng-hide="$ctrl.helper_exclusive ? !$ctrl.mapIsExclusive : false" class="map-option"> <div uib-accordion-heading>Map</div> <div class="row" ng-if="$ctrl.mapIsOpen"> <div class="col-xs-12"> <div class="form-group leaflet-container"> <leaflet id="map-marker" lf-center="$ctrl.map.center" layers="$ctrl.map.layers" controls="$ctrl.map.controls" event-broadcast="$ctrl.map.events" markers="$ctrl.map.markers" width="100% " height="300px"></leaflet> </div> </div> <div class="col-xs-12 text-right" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.map}" ng-click="$ctrl.ok(\'map\')" ng-disabled="!$ctrl.helper_keys.map"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.entityIsOpen" ng-hide="$ctrl.helper_exclusive ? !$ctrl.entityIsExclusive: false" class="entity-option"> <div uib-accordion-heading>{{ \'FORM.ENTITY\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-entity on-select-item="$ctrl.onSelectEntityKey($item, $model)" on-remove="$ctrl.onDeleteEntityKey()" entity="$ctrl.entity.selected" multiple="false"> </custom-ui-select-entity> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.entity}" ng-click="$ctrl.ok(\'entity\')" ng-disabled="!$ctrl.helper_keys.entity"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.deviceIsOpen" ng-hide="$ctrl.helper_exclusive ? (!$ctrl.entityIsExclusive && !$ctrl.deviceIsExclusive): false" class="device-option"> <div uib-accordion-heading>{{ \'FORM.DEVICES\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-device on-select-item="$ctrl.onSelectDeviceKey($item, $model)" on-remove="$ctrl.onDeleteDeviceKey()" device="$ctrl.device.selected" multiple="false" specific-type="{{$ctrl.specific_type}}"> </custom-ui-select-device> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.device}" ng-click="$ctrl.ok(\'device\')" ng-disabled="!$ctrl.helper_keys.device"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.assetIsOpen" ng-hide="$ctrl.helper_exclusive ? (!$ctrl.entityIsExclusive && !$ctrl.assetIsExclusive): false" class="asset-option"> <div uib-accordion-heading>{{ \'FORM.ASSETS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-asset on-select-item="$ctrl.onSelectAssetKey($item, $model)" on-remove="$ctrl.onDeleteAssetKey()" asset="$ctrl.asset.selected" multiple="false" specific-type="{{$ctrl.specific_type}}"></custom-ui-select-asset> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.asset}" ng-click="$ctrl.ok(\'asset\')" ng-disabled="!$ctrl.helper_keys.asset"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.subscriberIsOpen" class="subscriber-option" ng-hide="$ctrl.helper_exclusive ? (!$ctrl.entityIsExclusive && !$ctrl.subscriberIsExclusive): false"> <div uib-accordion-heading>{{ \'FORM.SUBSCRIBERS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-subscriber on-select-item="$ctrl.onSelectSubscriberKey($item, $model)" specific-type="{{$ctrl.specific_type}}" exclude-devices="$ctrl.exclude_devices" on-remove="$ctrl.onDeleteSubscriberKey()" entity="$ctrl.subscriber.selected" multiple="false"> </custom-ui-select-subscriber> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.subscriber}" ng-click="$ctrl.ok(\'subscriber\')" ng-disabled="!$ctrl.helper_keys.subscriber"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.subscriptionIsOpen" class="subscription-option" ng-hide="$ctrl.helper_exclusive ? (!$ctrl.entityIsExclusive && !$ctrl.subscriptionIsExclusive): false"> <div uib-accordion-heading>{{ \'FORM.SUBSCRIPTIONS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-subscription on-select-item="$ctrl.onSelectSubscriptionKey($item, $model)" specific-type="{{$ctrl.specific_type}}" exclude-devices="$ctrl.exclude_devices" on-remove="$ctrl.onDeleteSubscriptionKey()" entity="$ctrl.subscription.selected" multiple="false"> </custom-ui-select-subscription> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.subscription}" ng-click="$ctrl.ok(\'subscription\')" ng-disabled="!$ctrl.helper_keys.subscription"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.datastreamIsOpen" ng-hide="$ctrl.helper_exclusive ? !$ctrl.datastreamIsExclusive: false" class="datastream-option"> <div uib-accordion-heading>{{ \'FORM.DATASTREAM\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-datastream on-select-item="$ctrl.onSelectDatastreamKey($item, $model)" on-remove="$ctrl.onDeleteDatastreamKey()" datastream="$ctrl.datastream.selected" multiple="false"> </custom-ui-select-datastream> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.datastream}" ng-click="$ctrl.ok(\'datastream\')" ng-disabled="!$ctrl.helper_keys.datastream"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.domainIsOpen" class="domain-option" ng-hide="$ctrl.helper_exclusive ? !$ctrl.domainIsExclusive: false"> <div uib-accordion-heading>{{ \'FORM.DOMAINS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-domain on-select-item="$ctrl.onSelectDomainKey($item, $model)" on-remove="$ctrl.onDeleteDomainKey()" domain="$ctrl.domain.selected" multiple="false"> </custom-ui-select-domain> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.domain}" ng-click="$ctrl.ok(\'domain\')" ng-disabled="!$ctrl.helper_keys.domain"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.areaIsOpen" class="area-option" ng-hide="$ctrl.helper_exclusive ? !$ctrl.areaIsExclusive: false"> <div uib-accordion-heading>{{ \'FORM.AREAS\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-area on-select-item="$ctrl.onSelectAreaKey($item, $model)" on-remove="$ctrl.onDeleteAreaKey()" area="$ctrl.area.selected" organization="$ctrl.area.organization" multiple="false"> </custom-ui-select-area> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.area}" ng-click="$ctrl.ok(\'area\')" ng-disabled="!$ctrl.helper_keys.area"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.bundleIsOpen" class="bundle-option" ng-hide="$ctrl.helper_exclusive ? !$ctrl.bundleIsExclusive: false"> <div uib-accordion-heading>{{ \'FORM.BUNDLES\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-10"> <custom-ui-select-bundle on-select-item="$ctrl.onSelectBundleKey($item, $model)" on-remove="$ctrl.onDeleteBundleKey()" bundle="$ctrl.bundle.selected" multiple="false"> </custom-ui-select-bundle> </div> <div class="col-xs-2 vcenter no-padding" ng-if="$ctrl.helper_exclusive"> <a class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.bundle}" ng-click="$ctrl.ok(\'bundle\')" ng-disabled="!$ctrl.helper_keys.bundle"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> <div uib-accordion-group is-open="$ctrl.imageIsOpen" class="image-option" ng-hide="$ctrl.helper_exclusive ? !$ctrl.imageIsExclusive: false"> <div uib-accordion-heading>{{ \'FORM.IMAGE\' | translate }}</div> <div class="row row-eq-height"> <div class="col-xs-12 col-md-8"> <div name="image" ng-if="!$ctrl.helper_keys.image && !$ctrl.helper_keys.image.image" ngf-drop="$ctrl.imageSelected($file)" ng-model="$ctrl.image" ngf-max-size="1MB" ngf-select="$ctrl.imageSelected($file)" class="drop-box pointer" ngf-drag-over-class="\'dragover\'" ngf-multiple="false" ng-required="$ctrl.helper_keys.image" ngf-accept="\'image/*\'" ngf-pattern="\'image/*\'">{{ \'FORM.DRAG_DROP\' | translate }} <br>{{ \'FORM.MAX_SIZE\' | translate }}</div> <img ng-if="$ctrl.helper_keys.image && $ctrl.helper_keys.image.image" src="{{ $ctrl.helper_keys.image.image }}" style="max-height:200px;" name="image" /> </div> <div class="col-xs-12 col-md-4"> <button id="idRemoveFileLink" ng-if="$ctrl.helper_keys.image && $ctrl.helper_keys.image.image" ng-click="$ctrl.removeDataFile()" class="btn btn-warning ux-txt-warning pointer"> <i class="fa fa-trash" aria-hidden="true"></i> {{ \'BUTTON.TITLE.REMOVE\' | translate }}</button> <a ng-if="$ctrl.helper_exclusive" class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.helper_keys.bundle}" ng-click="$ctrl.ok(\'bundle\')" ng-disabled="!$ctrl.helper_keys.bundle"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> </a> </div> </div> </div> </uib-accordion> </div> <div class="modal-footer"> <a ng-if="!$ctrl.helper_exclusive" class="top-buffer btn btn-default ux-txt-success pointer" ng-class="{\'disabled\': !$ctrl.canApply()}" ng-click="$ctrl.ok()" ng-disabled="!$ctrl.canApply()"> <i class="fa fa-lg fa-files-o" aria-hidden="true"></i> {{\'BUTTON.TITLE.ALL\' | translate }} </a> <button class="btn btn-warning" type="button" ng-click="$ctrl.cancel()">{{\'BUTTON.TITLE.CANCEL\' | translate}}</button> </div></script>'),
e.put("schema-form/views/schema.form.asset.template.html",'<div ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }" class="form-group {{form.htmlClass}}"><custom-ui-select-asset label=form.title specific-type={{form.specificType}} on-select-item="evalExpr(form.onselectitem, {$item: $$value$$, $model: $model})" on-remove="evalExpr(form.onremove, {$item: $$value$$, $model: $model})" ng-model=$$value$$ identifier=$$value$$ multiple=form.multiple sf-field-model=replaceAll ui-select-match-class=form.uiSelectMatchClass asset=form.dummy ng-required=form.required></custom-ui-select-asset></div>'),e.put("schema-form/views/schema.form.datastream.template.html",'<div ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }" class="form-group {{form.htmlClass}}"><custom-ui-select-datastream on-select-item="evalExpr(form.onselectitem, {$item: $$value$$, $model: $model})" on-remove="evalExpr(form.onremove, {$item: $$value$$, $model: $model})" ng-model=$$value$$ datastream=form.dummy identifier=$$value$$ multiple=form.multiple sf-field-model=replaceAll ng-required=form.required ui-select-match-class=form.uiSelectMatchClass></custom-ui-select-datastream></div>'),e.put("schema-form/views/schema.form.device.template.html",'<div ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }" class="form-group {{form.htmlClass}}"><custom-ui-select-device label=form.title specific-type={{form.specificType}} on-select-item="evalExpr(form.onselectitem, {$item: $$value$$, $model: $model})" on-remove="evalExpr(form.onremove, {$item: $$value$$, $model: $model})" identifier=$$value$$ multiple=form.multiple sf-field-model=replaceAll device=form.dummy ng-model=$$value$$ ng-required=form.required ui-select-match-class=form.uiSelectMatchClass></custom-ui-select-device></div>'),e.put("schema-form/views/schema.form.entity.template.html",'<div ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }" class="form-group {{form.htmlClass}}"><custom-ui-select-entity label=form.title on-select-item="evalExpr(form.onselectitem, {$item: $$value$$, $model: $model})" on-remove="evalExpr(form.onremove, {$item: $$value$$, $model: $model})" entity=form.dummy identifier=$$value$$ multiple=form.multiple sf-field-model=replaceAll ng-model=$$value$$ ng-required=form.required ui-select-match-class=form.uiSelectMatchClass></custom-ui-select-entity></div>'),e.put("schema-form/views/schema.form.helper.boolean.template.html","<div class=form-group><div class=checkbox ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false }\"><label><input type=checkbox id=$$value$$ name=$$value$$ ng-model=$$value$$ sf-field-model=replaceAll sf-changed=form ng-model-options=form.ngModelOptions schema-validate=form> <span class=checkbox-material><span class=check></span></span> <span ng-bind-html=form.title class=text-left></span></label></div><div class=help-inline sf-message=form.description ng-bind-html=form.description></div></div>"),e.put("schema-form/views/schema.form.helper.checkboxes.template.html","<div class=\"{{form.schema?form.schema.htmlClass:''}}\"><div class=form-group sf-array=form ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false }\"><label>{{ form.title }}</label><br><div class=checkbox ng-if=form.titleMap ng-repeat=\"val in titleMapValues track by $index\"><label><input type=checkbox id=$$value$$ ng-disabled=form.readonly sf-changed=form name=$$value$$ ng-model=titleMapValues[$index]> <span class=checkbox-material><span class=check></span></span> <span ng-bind-html=form.titleMap[$index].name class=text-left></span></label></div><div ng-if=form.description class=help-inline ng-bind-html=form.description></div></div></div>"),e.put("schema-form/views/schema.form.helper.datetime.template.html",'<div class="form-group {{form.htmlClass}}"><label class=control-label ng-show=showTitle()>{{form.title}}<field-options required=form.required multiple=form.multiple></field-options></label><datetime-select id={{form.id}} name={{form.name}} ng-model=$$value$$ sf-changed=form schema-validate=form sf-field-model=replaceAll ng-disabled=form.readonly ng-required=form.required placeholder="{{form.date.placeholder }}" mode={{form.type}} format={{form.date.format}} ng-value=form.value><div class=help-block sf-message=form.description></div></datetime-select></div>'),e.put("schema-form/views/schema.form.helper.radiobuttons.template.html","<div class=\"{{form.schema?form.schema.htmlClass:''}}\"><div class=form-group ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false }\"><label for=$$value$$ ng-model=$$value$$>{{ form.title }}</label><br><div class=btn-group><label ng-repeat=\"data in form.titleMap track by $index\" class=\"btn btn-sm\" ng-class=\"{ 'btn-primary': data.value === $$value$$, 'btn-default': data.value !== $$value$$ }\" sf-field-model=replaceAll><input type=radio id=$$value$$ name=$$value$$ ng-model=$$value$$ sf-field-model=replaceAll ng-value=data.value style=display:none; sf-changed=form> <span ng-bind-html=data.name class=text-left></span></label></div><div ng-if=form.description class=help-inline ng-bind-html=form.description></div></div></div>"),e.put("schema-form/views/schema.form.helper.radios.template.html","<div class=\"{{form.schema?form.schema.htmlClass:''}}\"><div class=form-group ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false }\"><label for={{$$value$$}} ng-model=$$value$$>{{ form.title }}</label><br><div class=\"radio radio-primary\" ng-if=form.titleMap ng-repeat=\"data in form.titleMap track by $index\"><label><input type=radio id=$$value$$ name=$$value$$ ng-model=$$value$$ sf-field-model=replaceAll value={{data.value}} sf-changed=form ng-disabled=form.readonly schema-validate=form ng-model-options=form.ngModelOptions> <span class=circle></span> <span class=check></span><p ng-bind-html=data.name class=text-left></p></label></div><div ng-if=form.description class=help-inline ng-bind-html=form.description></div></div></div>"),e.put("schema-form/views/schema.form.helper.radiosinline.template.html",'<div class="{{form.schema?form.schema.htmlClass:\'\'}}"><div class=form-group ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }"><label for={{$$value$$}} ng-model=$$value$$ sf-field-model=replaceAll>{{ form.title }}</label><br><div class="radio radio-primary" ng-if=form.titleMap ng-repeat="data in form.titleMap track by $index" style="display: inline;"><label><input type=radio id="{{$$value$$ + \'_\' + $index}}" name={{$$value$$}} ng-model=$$value$$ sf-field-model=replaceAll value={{data.value}} sf-changed=form ng-disabled=form.readonly schema-validate=form ng-model-options=form.ngModelOptions> <span class=circle></span> <span class=check></span><p ng-bind-html=data.name class=text-left></p></label></div><div ng-if=form.description class=help-inline ng-bind-html=form.description></div></div></div>'),e.put("schema-form/views/schema.form.helper.template.html","<div class=\"{{form.schema?form.schema.htmlClass:''}}\"><div class=form-group ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false }\"><helper-dialog helper-id={{form.helperid}} helper-exclusive={{form.exclusive}} helper-type={{form.helperType}} specific-type={{form.specificType}} required=form.required><helper-ui-select id={{form.id}} name={{form.name}} label-text={{form.title}} helper-model=$$value$$ sf-field-model=replaceAll label-error={{form.labelerror}} required=form.required><helper-ui-select-input><label for={{form.name}}>{{form.title}} {{form.helperid}} {{form.exclusive}}<field-options required=form.required></field-options></label> <input class=form-control name={{form.name}} type=text id={{form.id}} ng-model=$$value$$ sf-field-model=replaceAll ng-required=form.required></helper-ui-select-input></helper-ui-select></helper-dialog></div></div>"),e.put("schema-form/views/schema.form.map.template.html",'<div ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }" class="form-group {{form.htmlClass}}"><custom-ui-map label=form.title required=form.required only-map=form.onlyMap disabled=form.disabled on-select-item="evalExpr(form.onselectitem, {$item: $$value$$, $model: $model})" on-remove="evalExpr(form.onremove, {$item: $$value$$, $model: $model})" location=$$value$$ sf-field-model=replaceAll></custom-ui-map></div>'),e.put("window-time-select/views/datetime.select.view.html",'<p class="datetime-container input-group form-group no-margin"><input readonly type=text class="form-control text-left no-margin" ng-model=rawdata ng-required=required ng-disabled=ngDisabled button-bar=customButtonBar ng-click=openCalendar() datetime-picker={{visibleFormat}} is-open=calendarOpen datepicker-options=pickerOptions.datePicker timepicker-options=pickerOptions.timePicker popup-placement="auto top-right" enable-date=enableDate enable-time=enableTime datepicker-append-to-body=true placeholder={{placeholder}} ng-change=changedRawdata()> <span class=input-group-btn><button class="btn btn-default no-padding fa" ng-class="{\'fa-calendar\' : enableDate, \'fa-clock-o\' : !enableDate && enableTime}" ng-click=openCalendar() aria-hidden=true></button></span></p>'),e.put("window-time-select/views/window-time.select.view.html",'<div permission permission-only="\'dateFilter\'" class=window-time-container><button type=button class="btn btn-xs" ng-class=oneDayClass ng-click=oneDay() translate>BUTTON.TITLE.LAST_DAY</button> <button type=button class="btn btn-xs" ng-class=oneWeekClass ng-click=oneWeek() translate=BUTTON.TITLE.LAST_NUMBER_DAY translate-values="{ number: \'7\' }"></button> <button type=button class="btn btn-xs" ng-class=oneMonthClass ng-click=oneMonth() translate=BUTTON.TITLE.LAST_NUMBER_DAY translate-values="{ number: \'30\' }"></button> <button type=button class="btn btn-xs" ng-class=customClass ng-click=custom() translate>BUTTON.TITLE.CUSTOM</button> <button type=button class="btn btn-xs btn-info" ng-if=filterApplied ng-click=clear() translate>BUTTON.TITLE.CLEAR</button><div ng-if=customEnabled class="window-time-body panel panel-body"><div class=col-xs-12><div class=row><div class="col-xs-6 text-left"><label translate>BUTTON.TITLE.CUSTOM</label></div><div class="col-xs-6 text-right"><button type=button class="btn btn-xs oux-button-margin btn-success" ng-disabled="!!errorCustomWindow || fromCalendarOpen || toCalendarOpen" ng-click=applyCustom() translate>BUTTON.TITLE.APPLY</button></div></div><div class=row><div class="col-xs-12 col-md-2 text-left"><label class=control-label><i class="fa fa-calendar" aria-hidden=true></i> {{ \'FORM.LABEL.FROM\' | translate }}: {{fromDate | date:\'fullDate\'}}</label></div><div class="col-xs-12 col-md-4"><input readonly type=text class="form-control text-left no-margin" ng-model=date.from button-bar=customButtonBar ng-click=openCalendarFrom() ng-required=true datetime-picker={{format}} is-open=fromCalendarOpen datepicker-options=fromOptions.datePicker timepicker-options=fromOptions.timePicker when-closed=fromChange(args) popup-placement="auto top-right" datepicker-append-to-body=true></div><div class="col-xs-12 col-md-2 text-left"><label class=control-label><i class="fa fa-calendar" aria-hidden=true></i> {{ \'FORM.LABEL.TO\' | translate }}: {{fromDate | date:\'fullDate\'}}</label></div><div class="col-xs-12 col-md-4"><input readonly type=text class="form-control text-left no-margin" ng-model=date.to button-bar=customButtonBar ng-click=openCalendarTo() ng-required=true datetime-picker={{format}} is-open=toCalendarOpen datepicker-options=toOptions.datePicker timepicker-options=toOptions.timePicker when-closed=toChange(args) popup-placement="auto top-right" datepicker-append-to-body=true></div></div></div><alert type=danger ng-show=errorCustomWindow class=text-danger style="display: block;text-align: center;"><span ng-bind=errorCustomWindow></span></alert></div></div>')}]),angular.module("uxleaflet").constant("defaultMapOptions",{l_gohome:{center:[40.4,-3.7],zoom:5},l_fullscreen:{position:"topleft"},l_placefinder:{text:"Place name or coordinates"},l_print:{title:"Print current map view",position:"topleft"},l_minimap:{layer:"$main",toggleDisplay:!0},l_search:{placeholder:"Enter device ID",timeAutoclose:2e3},l_boxselection:localStorage.testselection&&{position:"topleft"},l_measure:!1,l_mouseposition:{position:"bottomleft",numDigits:4},l_scale:!1,l_magnifying:{scale:3,radius:180},l_localtiles:!1,baseLayers:["osm","dark2","ogWorld","googleTerrain","googleHybrid","googleRoadmap","googleSatellite"],baseLayerDefault:"osm",overlays:{},mapOptions:{editPointSize:10}}).constant("allNgBaseLayers",{osm:{name:"OpenStreetMap",url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz",layerParams:{attribution:"OpenStreet Map",maxZoom:19,subdomains:["a","b","c"]}},dark2:{name:"Dark Map",url:"//{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",layerParams:{attribution:"Cartocdn Dark Map",maxZoom:19},type:"xyz"},ogWorld:{name:"OpenGate Maps",url:"//maps.opengate.es/osm_tiles/{z}/{x}/{y}.png",layerParams:{attribution:"OpenGate Maps",maxZoom:19},type:"xyz"},googleTerrain:{name:"Google Terrain",layerType:"TERRAIN",type:"google",layerParams:{maxZoom:20}},googleHybrid:{name:"Google Hybrid",layerType:"HYBRID",type:"google",layerParams:{maxZoom:20}},googleRoadmap:{name:"Google Streets",layerType:"ROADMAP",type:"google",layerParams:{maxZoom:20}},googleSatellite:{name:"Google Satellite",layerType:"SATELLITE",type:"google",layerParams:{maxZoom:20}}}).run(["$http","allNgBaseLayers","defaultMapOptions",function(e,t,i){e.get("//a.tile.openstreetmap.org/0/0/0.png").error(function(e){delete t.osm,i.baseLayers.splice(i.baseLayers.indexOf("osm"),1)}),e.get("//a.basemaps.cartocdn.com/dark_all/0/0/0.png").error(function(e){delete t.dark2,i.baseLayers.splice(i.baseLayers.indexOf("dark2"),1)}),e.get("//maps.opengate.es/osm_tiles/0/0/0.png").error(function(e){delete t.ogWorld,i.baseLayers.splice(i.baseLayers.indexOf("ogWorld"),1)})}]).service("mapUxService",["$timeout","leafletData","mapExtraApiService","geomUxService","defaultMapOptions","allNgBaseLayers","$translate",function(i,n,a,o,r,s,l){function c(e,t,i){var n;if(e.split){var a=e,o=a.split(":");if("local"===o[0]){var r=o[1],s=o[2]||"Local "+r;n={name:s,url:"file://_$local_"+r+"_{z}/{x}/{y}.png",type:"xyz",layerParams:{attribution:"",maxZoom:19}}}else{if(!t[a])throw"Not found baseLayer name "+a;n=angular.extend({},t[a])}}else n=angular.extend({},e);return e===i&&(n.visible=!0),n}function d(i,n){var a=i;if("string"==typeof i){var o=i,r=o.split(".");a=e;for(var s="window",l=0;l<r.length;l++){var c=r[l];if(a[c]===t)throw"Not found "+c+" in "+s;s=s+"."+c,a=a[c]}}try{var d=new a(n);if(d instanceof L.Control)return d;console.warn(i+" instance do not appears as L.Control")}catch(u){var p=JSON.stringify(n);throw new Error("Error instantiating "+i+" with "+p,u)}}function u(e){var t=f.getAllBaseLayerConfigs(),i=t[e]||t.osm||t.dark2||t.ogWorld||t.googleTerrain||t.googleHybrid||t.googleRoadmap||t.googleSatellite;if("xyz"===i.type){var n=new L.TileLayer(i.url,i.options||i.layerParams);return n}throw"not implemented tilelayer creation from "+JSON.stringify(i)}function p(e){function t(e,t){for(var n in t){var a=t[n];if(a.addTo)try{a.addTo(e),i.controls.push(a);var o=a._controlName;o&&!i[o]&&(i[o]=a)}catch(r){console.error("INTERNAL ERROR adding control to map ",r)}}angular.element(e._container).find(".leaflet-control-layers").addClass("navbar navbar-primary")}var i=this;this.controls=[],this.initControls=function(i,n){var a=(f.getBaseLayerConfigs(i),f._createMapControls(i,n));f.getMap(e,function(e){t(e,a)})},this.toggleFullscreen=function(){f.getMap(e,function(e){e.toggleFullscreen({})})}}function m(e,t){try{for(var i in e.controls.custom){var n=e.controls.custom[i];n._isGohomeInstance&&n.changeTargetViewToBounds(t)}}catch(a){console.error("Error zooming to bounds "+t,a)}}var h=this,f=this;L.Map.mergeOptions({sleep:!0,sleepTime:750,wakeTime:750,sleepNote:!0,hoverToWake:!0,wakeMessage:l.instant("TOASTR.RIGHT_CLICK_ZOOM_ACTIVATION"),wakeMessageTouch:l.instant("TOASTR.RIGHT_CLICK_ZOOM_ACTIVATION"),sleepOpacity:.9,sleepNoteStyle:{background:"black",color:"white",maxWidth:"50%",top:"5px"}}),this.createMapManager=function(e){if(!e||!e.$id)throw"Invalid angular scope";return new p(e)},h.getMapId=function(e,i){var n=i===t?"":"-"+i;return"map-"+e.$id+n},h.getMap=function(e,t,i){var n=this.getMapId(e,i);h.getMapWithId(n,t,e)},h.getMapWithId=function(e,t,a){n.getMap(e).then(function(e){e.setNgScope&&e.setNgScope(a),i(function(){t(e)})})},h.mapOn=function(e,t,i){var n=h.getMapId(e);e.$on("leafletDirectiveMap.{{ vm.id }}."+t,function(e){if(e.currentScope.vm.id===n)try{i(e)}catch(t){}})},h.getDefaultOptions=function(e){return angular.extend({},r,e||{})},h.createNgOptions=function(e,t){e=e||r,t=t||{};var i=e.l_gohome?e.l_gohome:null,n={center:i?{lat:i.center[0],lng:i.center[1],zoom:i.zoom}:{lat:40,lng:-3.7,zoom:5},layers:{baselayers:this.getBaseLayerConfigs(e),overlays:e.overlays||{}},controls:this.createControlConfigs(e,t),"default":e.mapOptions};return n},h.getAllBaseLayerConfigs=function(){return s},h.getBaseLayerConfigByName=function(e){var t=h.getAllBaseLayerConfigs(),i=null;return angular.forEach(t,function(t,n){i||t.name!==e||(i=t,i.identifier=n)}),i},h.getBaseLayerConfigs=function(e){var t=e.baseLayers,i=e.baseLayerDefault||"",n=this.getAllBaseLayerConfigs(),a={},o=[];if(i){for(var r=0;r<t.length;r++){var s=t[r],l=s instanceof Object?s.id||"layer_"+r:s;try{i===l&&(a[l]=c(s,n,i))}catch(d){o.push(s)}}for(var r=0;r<t.length;r++){var s=t[r],l=s instanceof Object?s.id||"layer_"+r:s;try{i!==l&&(a[l]=c(s,n,i))}catch(d){o.push(s)}}}else for(var r=0;r<t.length;r++){var s=t[r],l=s instanceof Object?s.id||"layer_"+r:s;try{a[l]=c(s,n,i)}catch(d){o.push(s)}}if(o.length>0){var u="Not found basemaps: ["+o.join(", ")+"]. available names: ["+this.getAllBaseLayerConfigNames().join(", ")+"]";console.error(u,"")}return a},h.getAllBaseLayerConfigNames=function(){var e=h.getAllBaseLayerConfigs(),t=[];for(var i in e)t.push(i);return t},h.createControlConfigs=function(e,t){var i={};return e.l_scale&&(i.scale=e.l_scale),i.custom=h.createCustomWidgets(e,t),angular.forEach(e.apikeys,function(e,t){a.setApikey(t,e)}),i},h._createMapControls=function(e,t){var i=this.createCustomWidgets(e,t);return i},h.createCustomWidgets=function(e,t){var i={l_fullscreen:{_controlName:"fullscreenControl",_desc:"Control for set current view mode in fullscreen",constructor:"L.Control.Fullscreen",defaultOpts:{position:"topleft"}},l_minimap:{_controlName:"minimapControl",_desc:"Control for showing a minimap guide in a corner of main map",constructor:null,defaultOpts:{layer:{url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{}},position:"bottomright",toggleDisplay:!0,autoToggleDisplay:!0,minimized:!0,width:100,height:100,strings:{hideText:"Hide Mini Map asdfasdfasdf",showText:"Show Mini Map"}},createControlInstance:function(e){var t,i=e.layer;return t="string"==typeof i?u(i):new L.TileLayer(i.url,i.options),new L.Control.MiniMap(t,e)}},l_mouseposition:{_controlName:"geolocationControl",_desc:"Control for showing current mouse location in lat/lon",constructor:L.Control.MousePosition,defaultOpts:{position:"bottomleft"}},"l_placefinder-google":{_controlName:"googleplacefinderControl",_desc:"Control for Search GeoLocation using external WebService (bower:leaflet-google-places-autocomplete)",constructor:L.Control.GPlaceAutocomplete2,defaultOpts:{searchCall:t&&t.placefinderCb||function(){},placeholder:"Enter place name",text:"Enter place name",position:"topleft"},dependencies:["google"]},"l_placefinder-esri":{_controlName:"esriplacefinderControl",_desc:"Control for Search ... ESRI",constructor:L.Control.PlaceFinderEsri,defaultOpts:{providerName:["arcgisOnlineProvider","mapServiceProvider"],layers:[2,3],searchFields:["NAME","STATE_NAME"]}},"l_placefinder-osm":{_controlName:"osmplacefinderControl",_desc:"Control for Search using OSM/Nominatim",constructor:L.Control.OsmPlaceFinder,defaultOpts:{placeholder:"Enter place name",text:"Enter place name",position:"topleft",forcePosition:"c√≥mo lo hace googleplacefinderControl???"}},l_placefinder:"pending to assign",l_search:{_controlName:"searchControl",_desc:"Control for Search internal features in map",constructor:L.Control.Search,defaultOpts:{searchCall:t.searchCb||function(){console.warn("NOT entitiesCacheCallback setter in l_search")},position:"topright",placeholder:"search",timeAutoclose:2400,textErr:"Device not found"}},l_measure:{_desc:"Control for distance measure in map",constructor:"L.Control.Measure",defaultOpts:{primaryLengthUnit:"kilometers",secondaryLengthUnit:"meters",primaryAreaUnit:"hectares",secondaryAreaUnit:"sqmeters",position:"bottomleft"},_bower:"'leaflet-measure ': '^ 2.1.5'"},l_boxselection:{_controlName:"boxselectionControl",_desc:"Control for select features using mouse bounding box",constructor:L.Control.FeatureSelection,defaultOpts:{position:"topleft"}},l_gohome:{_controlName:"gohomeControl",_desc:"Control for Pan/zoom to original position",constructor:L.Control.Gohome,defaultOpts:{center:[0,0],zoom:4,position:"topleft"},_bower:!1},l_print:{_controlName:"printoutControl",_desc:"Control for print out current map view",constructor:L.Control.EasyPrint,defaultOpts:{title:"Print map",position:"topleft",elementsToHide:"p, h2"},_bower:!1},l_magnifying:{_controlName:"magnifyingControl",_desc:"Control for magnify cursor area on map view",constructor:L.Control.MagnifyingGlass,defaultOpts:{title:"Magnifying glass",position:"topleft"},_bower:!1},l_localtiles:{_controlName:"localtilesControl",_desc:"Control for reset/load base tiles for offline navigation",constructor:L.Control.LocalTileControl,defaultOpts:{position:"topright"},_bower:!1}};i.l_placefinder=i["l_placefinder-osm"];var n=[];for(var a in i){var o=i[a],r=e[a];if(o&&r){var s=a+" "+o._desc;try{var l,c=$.extend(o.defaultOpts,r);l=o.constructor?d(o.constructor,c):o.createControlInstance(c),l._controlName||(l._controlName=o._controlName),n.push(l),console.debug("Created plugin: "+a+" "+s)}catch(p){console.error("INTERNAL ERROR loading leaflet plugin: "+s,p)}}}return n},h.createOverlaysConfig=function(e){if(console.debug("createOverlaysConfig no implementado. Solo funciona  options='demo'"),"demo"===e)return{wms:{name:"EEUU States (WMS)",type:"wms",visible:!0,url:"http://suite.opengeo.org/geoserver/usa/wms",layerParams:{layers:"usa:states",format:"image/png",transparent:!0}}}},h.tryChangeGohomeOptions=m,h.loadGeoJsonFromFile=function(e,t){var i=e?e.name:"null",n=new FileReader;n.onload=function(){try{var e=n.result;t(h.validateGeoJsonContent(e))}catch(a){t(null,new Error("No valid GeoJson file: ["+i+"]\n"+a),null)}};try{n.readAsText(e)}catch(a){t(new Error("Invalid "+i+"\n"+a.message),null)}},h.validateGeoJsonContent=function(e){var t;try{t=JSON.parse(e)}catch(i){throw"Invalid JSON data"}if("object"!=typeof t)throw"Invalid GeoJSON. Expected JSON format";if("FeatureCollection"!==t.type)throw"Invalid GeoJSON. Expected {type:'FeatureCollection'...";var n=t.features;if(!angular.isArray(n))throw"Invalid GeoJSON. Expected {features:[...]...";return t},h.enableRightClickToZoom=function(e,t){function i(){t.showClickMessage=!1,t.$apply()}e.scrollWheelZoom.disable();var n;e.on("fullscreenchange",function(t){t.target._isFullscreen?e.scrollWheelZoom.enable():e.scrollWheelZoom.disable()}),e.on("contextmenu",function(i){t.showClickMessage=!1,e.scrollWheelZoom.enable()}),e.on("click",function(i){t.showClickMessage=!1,e.scrollWheelZoom.enable()}),e.on("mouseout",function(t){e.scrollWheelZoom.disable(),n&&clearTimeout(n),n=setTimeout(i,2e3)}),e.on("blur",function(t){e.scrollWheelZoom.disable(),n&&clearTimeout(n),n=setTimeout(i,2e3)}),e.on("mousemove",function(a){a.target._isFullscreen?e.scrollWheelZoom._enabled||e.scrollWheelZoom.enable():e.scrollWheelZoom._enabled||(t.showClickMessage=!0,n&&clearTimeout(n),n=setTimeout(i,2e3))})},h.circleToPolygon=o.circleToPolygon,h.createVectorLayer=o.createVectorLayer}]),angular.module("uxleaflet").service("mapUxGeoJsonService",["$window","jsonPath","$api","$http","$timeout","mapUxService","mapMarkerService","$oguxThemes",function(e,i,n,a,o,r,s,l){function c(e,t,i){i=i||{};try{var n=u(t);d(n.features);var a=new v(e,n,i);return a}catch(o){throw"invalid data as geojson content. "+o.message}}function d(e){e=Array.isArray(e)?e:[e];var t="#ff6600";try{t=l.getColorFromThemeComposition().sample}catch(i){console.error("WARN: Fail recovering theme from oguxThemes",i)}for(var n=0;n<e.length;n++){var a=e[n];try{var o=a.properties=a.properties||{};if(o.name=o.name||"no-name",o.name){var r="";r+="<div><span class='text-primary'>"+(o.name||"")+"</span><br>"+(o.description||"")+"</div>",o.popupContent=r}o["fill-opacity"]=.2,o.stroke="#555555",o["stroke-width"]=1,o["stroke-opacity"]=1,o.fill=t}catch(i){console.error("Error replacing properties on feature ",a,i)}}}function u(e){if(e&&e.features&&"string"==typeof e.type)return e;if(e.startsWith("<!"))throw"Not found geojson file.";try{var t=JSON.parse(e);if("string"!=typeof t.type)throw"invalid geojson. Expected type property as string";return t}catch(i){throw"invalid geojson. Expected JSON "+i.message}}function p(e,i){return e!==t?e:i}function m(e){return{radius:p(e.radius||12),fillColor:p(e.fill,"#ff7800"),color:p(e.stroke,"#ff0000"),weight:p(e["stroke-weight"],1),opacity:p(e["stroke-opacity"],.8),fillOpacity:p(e["fill-opacity"],.2),popupContent:e.popupContent}}function h(e,t){var i=e?e.name:"null",n=new FileReader;n.onload=function(){try{var e=n.result;f(e),t(null,e)}catch(a){t(new Error("No valid GeoJson file: ["+i+"]\n"+a),null)}};try{n.readAsText(e)}catch(a){t(new Error("Invalid "+i+"\n"+a.message),null)}}function f(e){var t;try{t=JSON.parse(e)}catch(i){throw"Invalid JSON data"}if("object"!=typeof t)throw"Invalid GeoJSON. Expected JSON format";if("FeatureCollection"!==t.type)throw"Invalid GeoJSON. Expected {type:'FeatureCollection'...";var n=t.features;if("[object Array]"!==Object.prototype.toString.call(n))throw"Invalid GeoJSON. Expected {features:[...]..."}function g(e){var t=e;if("string"==typeof e)e=JSON.parse(e);else if("object"!=typeof e)throw new Error("geojson is required as object or string. Nor valid "+t);if(!e||!e.type)throw new Error("Invalid geojson object ",t);var i=y[e.type];if(!i)throw new Error("Invalid geojson type "+e.type);return"geometry"===i?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]}:"feature"===i?{type:"FeatureCollection",features:[e]}:"featurecollection"===i?e:void 0}function v(e,i,n){function a(e){var t=e.layer.toGeoJSON?e.layer.toGeoJSON():"";console.info("map-ux-geojson-service: commited feature. Action: "+e.action,t)}var o=this,r={radius:12,fillColor:"#ff7800",color:"#000",weight:1,opacity:1,fillOpacity:.2,aweMarkerCss:"hand-o-down",onFeatureCommited:a};this._map=e,this._uxEditionControl=null,this.options=L.extend({},r,n),this.layer=L.geoJson(i,{style:this.options.style||function(e){if(e.properties){var t=m(e.properties);return t}return{color:"#ff8800"}},onEachFeature:this.options.onEachFeature||function(e,t){e.properties&&e.properties.popupContent&&t.bindPopup(e.properties.popupContent)},pointToLayer:this.options.pointToLayer||function(e,t){var i=o.options.aweMarkerCss,n=s.createMarker(e,t,{defaultAweSymbol:i});return n},filter:this.options.filter||function(e,t){return!0}}),this.setEditionMode=function(e){var i=this._map;if(!i)throw"Error. No has Map associated to this GeoJson Manager";e?(this._uxEditionControl=new L.Control.UxEdition({position:"topright",onFeatureCommited:this.options.onFeatureCommited}),this._uxEditionControl.addTo(i),this._uxEditionControl.setLayer(this.layer._layers)):this._uxEditionControl&&(this._uxEditionControl.setLayer(t),i.removeControl(this._uxEditionControl),delete this._uxEditionControl);try{for(var n in this.layer._layers){var a=this.layer._layers[n];e?a.enableEdit&&a.enableEdit(i):a.disableEdit&&a.disableEdit()}}catch(o){console.error("Error interno habilitando edici√≥n de geometr√≠as GeoJSON",o)}},this.layersToGeoJson=function(){var e=[];for(var t in this.layer._layers){var i=this.layer._layers[t];try{i.editor.commitDrawing();var n=i.toGeoJSON();e.push(n)}catch(a){console.error(" Layer can be converted to feature: ",a)}}var o={type:"FeatureCollection",features:e,lastEdition:(new Date).toISOString()},r=JSON.stringify(o);return r}}this.createLayerManager=c,this.loadGeoJsonFromFile=h,this.normalizeGeoJson=g;var y={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}}]),angular.module("uxleaflet").service("mapEsriService",["$window","jsonPath","$api","mapUxService",function(e,t,i,n){console.info("TESTING l_placefinder_esri");var a=t("L.esri.Geocoding.Geosearch");a&&console.warn("Error not found L.esri.Geocoding.Geosearch "),L.Control.PlaceFinderEsri=a.extend({initialize:function(e){var t={providers:[L.esri.Geocoding.arcgisOnlineProvider(),L.esri.Geocoding.mapServiceProvider({label:"States and Counties",url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/Census/MapServer",layers:e.layers,searchFields:e.searchFields})]};a.prototype.initialize.call(this,t)},_buildContainer:function(e){a.prototype._buildContainer.call(this,e)},addTo:function(e){a.prototype.addTo.call(this,e)}})}]),angular.module("uxleaflet").service("mapExtraApiService",function(){function t(e,t){a[e]?a[e].apikey=t:console.warn("WARN: 'setApiKey'. Not found ApiName: "+e)}function i(t){for(var i=!0,n=0;n<t.length;n++)for(var a=t[n],o=a.split("."),r=e,s=0;s<o.length&&(i=i&&r[o[s]],i);s++);return i}function n(t,n,o){function r(){l.isApikeyRequired&&!l.apikey?e.setTimeout(r,1e3):(d.src=l.getUrl(),document.getElementsByTagName("head")[0].appendChild(d))}function s(e,t,i){if(e&&e.call)try{e(t,i)}catch(t){console.error("callback error: ",t)}}var l=a[t];l||(console.warn("not found known EXT_API as: "+t),s(o,new Error("not found known EXT_API as: "+t),null));var c=i(n);if(c)return void s(o,null,e[t]);if("fail"===l.status)return void s(o,new Error("not found API for "+t),null);if("loading"!==l.status){l.status="loading";var d=document.createElement("script");d.type="text/javascript",d.readyState?d.onreadystatechange=function(){"loaded"!==d.readyState&&"complete"!==d.readyState||(l.status="ok",d.onreadystatechange=null,s(o,null,e[t]))}:d.onload=function(){l.status="ok",s(o,null,e[t])},r()}else var u=e.setInterval(function(){"loading"!==l.status&&(e.clearInterval(u),"ok"===l.status?s(o,null,e[t]):"fail"===l.status&&s(o,new Error("not found API for "+t),null))})}this.ensureLib=n,this.setApikey=t,L.extraApi={},L.extraApi.ensureLib=this.ensureLib=n,L.extraApi.setApikey=this.setApikey=t;var a={google:{apikey:null,isApikeyRequired:!0,options:{libraries:"drawing,places"},getUrl:function(){this.options.libraries?"&libraries="+this.options.libraries:"";return"https://maps.google.com/maps/api/js?v=3.20&libraries=drawing,places&key="+this.apikey},status:null},esri:{apikey:"",getUrl:function(){return"https://unpkg.com/esri-leaflet@2.0.8"},status:null},osm:{apikey:"",getUrl:function(){return"https://openstreetmap.org/aaaaaaaaaaaaa"},status:null},mapquest:{apikey:"",getUrl:function(){return"https://maquest.com/aaaaaaaaaaaa"},status:null}}}),angular.module("uxleaflet").service("geomUxService",["$timeout",function(e){function i(e){return e*Math.PI/180}function n(e){return 180*e/Math.PI}function a(e,t,a){var o=i(e[1]),r=i(e[0]),s=t/6378137,l=Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.cos(a)),c=r+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(o),Math.cos(s)-Math.sin(o)*Math.sin(l));
return[n(c),n(l)]}function o(e,t,i){for(var n=i?i:32,o=[],r=0;r<n;r+=1)o.push(a(e,t,2*Math.PI*r/n));return o.push(o[0]),{type:"Polygon",coordinates:[o]}}function r(e,t){var i=1e-7;if(!e||!t)return!1;var n=1*e/t,a=Math.abs(1-n);return a<i}function s(e){var i,n=40075017/360,a=e.coordinates[0]||[],o=L.bounds(a),s=o.getCenter(),l=o.getSize(),c=l.y/2*n;if("Polygon"===e.type){var d=50;if(a.length>=d){i=!0;var u=new L.LatLng(s.y,s.x);for(var p in a){var m=a[p],h=new L.LatLng(m[1],m[0]),f=u.distanceTo(h);if(!f||!r(c,f)){i=!1;break}}}else i=!1}else i=!1;var g;if(i===!1){var v=L.geoJson(e,{onEachFeature:function(e,t){e.properties||(e.properties={})}});g=v.getLayers()[0]}else{var y=s.lat!==t?s.lat:s.y,b=s.lng!==t?s.lng:s.x;g=L.circle([y,b],c)}return g}var l=this;l.circleToPolygon=o,l.createVectorLayer=s}]),angular.module("uxleaflet").service("geocodingService",i),i.$inject=["$http"],angular.module("uxleaflet-directive",[]).directive("uxleaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletMapEvents",n]),angular.module("ui-leaflet").directive("decopaths",["$log","leafletHelpers",function(e,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(i,n,a,o){function r(t){return d(t)&&d(t.coordinates)&&(c.isLoaded()||e.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(t.coordinates)}function s(e,t){if(d(e)&&d(t)&&d(t.coordinates)&&d(t.patterns))return e.setPaths(t.coordinates),e.setPatterns(t.patterns),e}var l=o.getLeafletScope(),c=t.PolylineDecoratorPlugin,d=t.isDefined,u={};o.getMap().then(function(e){l.$watch("decopaths",function(t){console.debug("Pendiente implementar aqu√≠: decopaths");for(var i in u)d(t[i])&&angular.equals(t[i],u)||(e.removeLayer(u[i]),delete u[i]);for(var n in t){var a=t[n],o=r(a);d(o)&&(u[n]=o,e.addLayer(o),s(o,a))}},!0)})}}}]),angular.module("opengate-angular-js").directive("windowTimeSelect",function(){return{restrict:"AE",templateUrl:"window-time-select/views/window-time.select.view.html",scope:{event:"@",rawdate:"@"},controller:["$scope","$element","$attrs","$translate",function(i,n,a,o){function r(){return e.moment(i.date.from).add(1,"minutes")._d}function s(){return e.moment(i.date.to).subtract(1,"minutes")._d}function l(){return e.moment(i.date.to).subtract(1,"months")._d}function c(e){i.date||(i.date={}),i.date.to=e,i.toMax=e,i.toOptions={datePicker:{startingDay:1,showWeeks:!1,minDate:i.toMin,minMode:"day",closed:i.toChange},timePicker:{showMeridian:!1}}}function d(){i.date.from=l(i.date.to),i.toOptions.datePicker.minDate=r(),i.toMin=r(),i.fromMax=s(i.date.to),i.fromOptions={datePicker:{startingDay:1,showWeeks:!1,maxDate:i.fromMax,maxMode:"day",closed:i.fromChange},timePicker:{showMeridian:!1}}}function u(t){var i=e.moment().subtract(1,t);return{from:i._d,type:t}}i.fromCalendarOpen=!1,i.toCalendarOpen=!1,i.customButtonBar={show:!0,now:{show:!1},today:{show:!1},clear:{show:!1},date:{show:!0,text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-calendar"},time:{show:!0,text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-clock-o"},close:{show:!0,text:" ",cls:"btn-sm btn-success oux-button-margin fa fa-check"},cancel:{show:!1}},i.oneDayClass=i.oneWeekClass=i.oneMonthClass=i.customClass="btn-info",i.filterApplied=!1,i.format="dd MMMM yyyy HH:mm",i.clear=function(){i.oneDayClass=i.oneWeekClass=i.oneMonthClass=i.customClass="btn-info",i.filterApplied=!1,i.customEnabled=!1,i.$emit("onWindowTimeChanged",{})},i.fromOpen=function(){i.fromPopup.opened=!0},i.fromPopup={opened:!1},i.toOpen=function(){i.toPopup.opened=!0},i.toPopup={opened:!1},i.openCalendarFrom=function(){i.fromCalendarOpen=!0},i.openCalendarTo=function(){i.toCalendarOpen=!0},i.custom=function(){i.customEnabled&&(i.fromCalendarOpen||i.toCalendarOpen)||(i.customEnabled=!i.customEnabled)},i.apply=function(t,n){if(i.filterApplied=!0,i.customEnabled=!1,!e.eval(i.rawdate)){for(var a in t)"type"!==a&&"rawdate"!==a&&(t[a]=e.moment(t[a]).format());t.rawdate=!1}n&&i.$emit("onWindowTimeChanged",t)},i.oneDay=function(e){i.oneDayClass="btn-success",i.oneWeekClass=i.oneMonthClass=i.customClass="btn-info",i.apply(u("days"),!e)},i.oneWeek=function(e){i.oneWeekClass="btn-success",i.oneDayClass=i.oneMonthClass=i.customClass="btn-info",i.apply(u("weeks"),!e)},i.oneMonth=function(e){i.oneMonthClass="btn-success",i.oneWeekClass=i.oneDayClass=i.customClass="btn-info",i.apply(u("months"),!e)},i.applyCustom=function(e){i.fromCalendarOpen?i.fromChange():i.toCalendarOpen?i.toChange():(i.fromCalendarOpen=!1,i.toCalendarOpen=!1,i.customClass="btn-success",i.oneWeekClass=i.oneDayClass=i.oneMonthClass="btn-info",i.apply({type:"custom",to:i.date.to,from:i.date.from},!e))},i.init=function(){function n(){e.moment(i.date.to).diff(i.date.from)<=0?i.errorCustomWindow="From date("+i.date.from.toISOString()+") is bigger than to date("+i.date.to.toISOString()+")":i.errorCustomWindow=t}if(c(new Date),d(),i.toChange=function(){n(),i.fromMax=s(i.date.to),i.fromOptions.datePicker.maxDate=i.fromMax,i.toCalendarOpen=!1},i.fromChange=function(){n(),i.toOptions.datePicker.minDate=r(),i.toMin=r(),i.fromCalendarOpen=!1},i.$parent.config&&i.$parent.config.windowFilter){var a=i.$parent.config.windowFilter;switch(e.eval(i.rawdate)||(i.$parent.config.windowFilter.rawdate=!1),a.type){case"days":i.oneDay(!0);break;case"weeks":i.oneWeek(!0);break;case"months":i.oneMonth(!0);break;case"custom":a.to&&a.from&&(i.date.to=new Date(a.to),i.date.from=new Date(a.from)),i.applyCustom(!0)}}},i.init()}]}}),angular.module("opengate-angular-js").directive("datetimeSelect",function(){return{restrict:"AE",templateUrl:"window-time-select/views/datetime.select.view.html",scope:{ngModel:"=",ngValue:"=",ngRequired:"<",placeholder:"@",format:"@",mode:"@",ngChange:"<",dateOptions:"=",timeOptions:"=",min:"=",max:"="},controller:["$scope","$element","$attrs","$translate","uibDateParser",function(e,i,n,a,o){e.mode&&"date-time"!==e.mode?e.inputMode=e.mode:e.inputMode="datetime",e.required=!!e.ngRequired&&!!e.ngRequired,e.calendarOpen=!1,e.enableDate=!e.inputMode||"datetime"===e.inputMode||"date"===e.inputMode,e.enableTime=e.inputMode&&("datetime"===e.inputMode||"time"===e.inputMode),e.format?e.visibleFormat=e.format:e.enableDate&&!e.enableTime?(e.format="yyyy-MM-dd",e.visibleFormat="dd MMMM yyyy"):!e.enableDate&&e.enableTime?(e.format="HH:mm:ss",e.visibleFormat="HH:mm"):(e.format="yyyy-MM-ddTHH:mm:ss.sssZ",e.visibleFormat="dd MMMM yyyy HH:mm"),e.outputFormat=e.format,angular.isUndefined(e.ngModel)&&angular.isUndefined(e.ngValue)||(e.ngValue?e.rawdata=e.ngValue:e.ngModel&&(e.rawdata=o.parse(e.ngModel,e.outputFormat))),e.customButtonBar={show:!0,now:{show:!1},today:{show:!0,text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-calendar-o"},clear:{show:!0,text:" ",cls:"btn-sm btn-success oux-button-margin fa fa-close"},date:{show:!e.inputMode||"datetime"===e.inputMode||"date"===e.inputMode,text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-calendar"},time:{show:e.inputMode&&("datetime"===e.inputMode||"time"===e.inputMode),text:" ",cls:"btn-sm btn-info oux-button-margin fa fa-clock-o"},close:{show:!0,text:" ",cls:"btn-sm btn-success oux-button-margin fa fa-check"},cancel:{show:!1}},e.pickerOptions={datePicker:{startingDay:1,showWeeks:!1,appendToBody:!0},timePicker:{showMeridian:!1,appendToBody:!0}},e.dateOptions&&angular.merge(e.pickerOptions.datePicker,e.dateOptions),e.timeOptions&&angular.merge(e.pickerOptions.timePicker,e.timeOptions),e.openCalendar=function(){e.calendarOpen=!0},e.changedRawdata=function(){var i=e.rawdata;if(i)if(e.min&&(i<e.min||i<o.parse(e.min,e.outputFormat))||e.max&&(i>e.max||i>o.parse(e.max,e.outputFormat)))e.rawdata=t,e.ngModel&&(e.ngModel=t,e.ngChange&&e.ngChange(e.ngModel));else{var n;n="yyyy-MM-ddTHH:mm:ss.sssZ"!==e.outputFormat?o.filter(i,e.outputFormat):i.toISOString(),n!==e.ngModel&&(e.ngModel=n,e.ngChange&&e.ngChange(e.ngModel))}else e.rawdata=t,e.ngModel&&(e.ngModel=t,e.ngChange&&e.ngChange(e.ngModel))},e.$watch("ngModel",function(i){i?o.parse(i,e.outputFormat)?e.rawdata=o.parse(i,e.outputFormat):e.rawdata=new Date(i):e.rawdata=t,e.ngChange&&e.ngChange(e.ngModel)}),e.init=function(){},e.init()}]}}),function(){L.Control.Search=L.Control.extend({includes:L.Mixin.Events,options:{searchCall:null,searchJsonpUrl:"",searchJsonpFilter:null,searchLayer:null,searchLayerProp:"title",searchInitial:!0,searchMinLen:1,searchDelay:300,timeAutoclose:1200,autoPan:!0,autoResize:!0,animatePan:!0,zoom:null,position:"topright",placeholder:"Seach feature by id...",textErr:"Location not found"},initialize:function(e){L.Util.setOptions(this,e),this._inputMinSize=this.options.placeholder.length,this.options.searchLayer=this.options.searchLayer||new L.LayerGroup,this.options.searchJsonpFilter=this.options.searchJsonpFilter||this._jsonpDefaultFilter,this.timeDelaySearch=this.options.searchDelay,this._recordsCache={}},onAdd:function(e){return this._map=e,this._circleLoc=new L.CircleMarker([0,0],{radius:0,weight:3,color:"#0000",fill:!1}).addTo(this._map),this._container=L.DomUtil.create("div","leaflet-control-search leaflet-bar"),this._alert=this._createAlert("search-alert"),this._input=this._createInput(this.options.placeholder,"search-input"),this._createButton(this.options.placeholder,"search-button"),this._tooltip=this._createTooltip("search-tooltip"),this._container},onRemove:function(e){this._recordsCache={}},showAlert:function(e){this._setVisibleElem(this._alert,!0,100),this._alert.innerHTML=e;var t=this;clearTimeout(this.timerAlert);var i=2e3;this.timerAlert=setTimeout(function(){t._setVisibleElem(t._alert,!1,200)},i)},_setVisibleElem:function(e,t,i){var n=t?"show":"hide";$&&$.fn&&$.fn.show&&$.fn.hide?$(e)[n](500):this._alert.style.display=t?"inherit":"none"},_setCircleVisible:function(e,i,n){var a=this._circleLoc;e?(i&&a.setLatLng(i),n!==t&&a.setRadius(n),a.setStyle({color:"#ac60"})):(a.setLatLng([0,0]),a.setStyle({color:"#0000"}))},expand:function(){this._input.style.display="block",L.DomUtil.addClass(this._container,"exp"),this._input.focus()},collapse:function(){this._hideTooltip(),this._input.value="",this._input.size=this._inputMinSize,this._alert.style.display="none",this._input.style.display="none",L.DomUtil.removeClass(this._container,"exp"),this._setCircleVisible(!1)},autoCollapse:function(){var e=this,t=isNaN(this.options.timeAutoclose)?0:+this.options.timeAutoclose;t&&(this.timerCollapse=setTimeout(function(){e.collapse()},this.timeout))},autoCollapseStop:function(){clearTimeout(this.timerCollapse)},_clickFocus:function(e){e.target.focus()},_createAlert:function(e){var t=L.DomUtil.create("div",e,this._container);return t.style.display="none",t},_createInput:function(e,t){var i=L.DomUtil.create("input",t,this._container);return i.type="text",i.size=this._inputMinSize,i.value="",i.placeholder=e,i.style.display="none",L.DomEvent.disableClickPropagation(i).addListener(i,"keyup",this._handleKeypress,this).addListener(i,"keyup",this._handleAutoresize,this).addListener(i,"blur",this.autoCollapse,this).addListener(i,"focus",this.autoCollapseStop,this),i},_createButton:function(e,t){var i=L.DomUtil.create("a",t,this._container);return i.href="#",i.title=e,L.DomEvent.disableClickPropagation(i).addListener(i,"focus",this.autoCollapseStop,this).addListener(i,"blur",this.autoCollapse,this).addListener(i,"click",this._handleSubmit,this),i},_createTooltip:function(e){var t=L.DomUtil.create("div",e,this._container);t.style.display="none";var i=this;return L.DomEvent.disableClickPropagation(t).addListener(t,"blur",this.autoCollapse,this).addListener(t,"mousewheel",function(e){i.autoCollapseStop(),L.DomEvent.stopPropagation(e)},this).addListener(t,"mousedown",function(e){L.DomEvent.stop(e),i.autoCollapseStop()},this),t},_createTip:function(e){var t=L.DomUtil.create("a","search-tip");return t.href="#",t.innerHTML=e,L.DomEvent.addListener(t,"click",function(t){this._input.value=e,this._input.focus(),this._hideTooltip(),this._handleAutoresize(),this.options.autoPan&&this._handleSubmit()},this),t},_showTooltip:function(){if(this._input.value.length<this.options.searchMinLen)return this._hideTooltip();var e=new RegExp("^[.]$|[|]","g"),t=this._input.value.replace(e,""),i=this.options.searchInitial?"^":"",n=new RegExp(i+t,"i"),a=0;this._tooltip.innerHTML="";for(var o in this._recordsCache)n.test(o)&&(this._tooltip.appendChild(this._createTip(o)),a++);return a>0?this._tooltip.style.display="block":this._hideTooltip(),a},_hideTooltip:function(){this._tooltip.style.display="none",this._tooltip.innerHTML=""},_jsonpDefaultFilter:function(e){var t={};for(var i in e)t[e[i].title]=L.latLng(e[i].loc);return t},_recordsFromJsonp:function(e,t,i){L.Control.Search.callJsonp=function(e){var n=i.options.searchJsonpFilter(e);t(n)};var n=L.DomUtil.create("script","",document.getElementsByTagName("body")[0]),a=L.Util.template(i.options.searchJsonpUrl,{s:e,c:"L.Control.Search.callJsonp"});return n.type="text/javascript",n.src=a,t},_recordsFromLayer:function(){var e={},t=this.options.searchLayer,i=this.options.searchLayerProp;return t.eachLayer(function(t){var n=t.options.hasOwnProperty(i)&&t.options[i]||"";n&&(e[n]=t.getLatLng())},this),e},_handleKeypress:function(e){switch(e.keyCode){case 27:this.collapse();break;case 13:this._handleSubmit();break;case 37:case 39:case 16:case 17:break;default:if(clearTimeout(this.timerKeypress),this._input.value.length<this.options.searchMinLen)return this._hideTooltip();var t=this;this.timerKeypress=setTimeout(function(){t._timerKeypressElapsed()},t.timeDelaySearch)}},_timerKeypressElapsed:function(){var e=this,t=e._input.value;e.options.searchCall?(e._recordsCache=e.options.searchCall.apply(e,[t]),e._showTooltip()):e.options.searchJsonpUrl?e._recordsFromJsonp(t,function(t){e._recordsCache=t,e._showTooltip()},e):e.options.searchLayer&&(e._recordsCache=e._recordsFromLayer(),e._showTooltip())},_handleAutoresize:function(){this.options.autoResize&&(this._input.size=this._input.value.length<this._inputMinSize?this._inputMinSize:this._input.value.length)},_handleSubmit:function(e){"none"===this._input.style.display?this.expand():""===this._input.value?this.collapse():this._findLocation(this._input.value)===!1?this.showAlert(this.options.textErr):+this.options.timeAutoclose>0==!1&&this.collapse(),this._input.focus()},_animateLocation:function(e){this._setCircleVisible(!0,e,50),console.info("animated to: "+e);var t=this._circleLoc,i=200,n=10,a=parseInt(t._radius/n),o=0,r=this;this.timerAnimLoc=setInterval(function(){o+=.5,a+=o;var e=t._radius-a;e>.5?t.setRadius(e):clearInterval(r.timerAnimLoc)},i)},_findLocation:function(e){if(null===this._recordsCache)return console.warn("Callback for findLocation not set in L.Search plugin"),!1;if(this._recordsCache.hasOwnProperty(e)){var t=this._recordsCache[e];return this.options.zoom?this._map.setView(t,this.options.zoom):this._map.setView(t),this.options.animatePan&&this._animateLocation(t),t}return this._setCircleVisible(!1),!1}})}(),function(){if("0.7.7"!==L.version)return void console.warn("Ux-leaflet-patch only is applicable to leaflet 0.7.7. No applied to leaflet "+L.version);L.DomUtil.getPosition=function(e){return e._leaflet_pos||new L.Point(0,0)};var e=L.DomUtil.getTranslateString;L.DomUtil.getTranslateString=function(i){return i&&i.x!==t&&i.y!==t?e(i):""};var i=L.Path.prototype._updateStyle;L.Path.prototype._updateStyle=function(){i.apply(this,arguments),this.options.fill||this._path.setAttribute("fill-opacity",0)};var n=L.Draggable.prototype._onMove;L.Draggable.prototype._onMove=function(e){n.apply(this,arguments),this._lastEvent=e},console.info("Ux-leaflet-patch applied to leaflet "+L.version)}(),function(){function e(e,t){function i(e,t,i){var n=l+"/search",a=r(e),s=!t&&"2"||t.limit||"3",c=n+"/"+a+"?format=json&limit="+s;t&&t.extraParams&&(c+="&"+t.extraParams),console.info("URL nominatim search \n"+c),o(c,i)}function n(t,i,n,a,o,r){var s=($.extend({},d),l+"/reverse"),c=s+"?format=json&lat="+t+"&lon="+i+"&zoom="+n+"&addressdetails=1&polygon_geojson=1"+(r?"&accept-language="+r:"");e({method:"GET",url:c}).then(function(e){var t;try{if(e.address)t=e;else{if(200!==e.status)return;t=e.data}}catch(i){return void a(new Error("Invalid json: \n ",e))}a(null,t)},function(e){a(e)})}function a(e,t){}function o(t,i){e({method:"GET",url:t}).then(function(e){var t;try{t="string"!=typeof e?e:JSON.parse(e)}catch(n){return void i(new Error("Invalid json: \n "+e.substring(0,20)))}i(null,t)},function(e){i(e)})}function r(e){return e}var s=this,l="https://nominatim.openstreetmap.org",c=!1;t&&(l=t.baseAddress||l,c=t.houseNumberSwap||c);var d={house_number:{"Num casa":!0},road:{Calle:!0},suburb:{Suburb:!1},city:{Ciudad:!0},county:{Provincia:!0},state_district:{Suburb:!1},state:{Estado:!1},postcode:{CP:!1},country:{"Pa√≠s":!0},country_code:{cc:!1}};s.reverseSearch=n,s.search=i,s.lookupGeometry=a}function i(e){return $.ajax(e.url)}if(L.OsmGeocodingService=e,L.Util.geocodingService=new e(i),L.Control.OsmPlaceFinder=L.Control.extend({includes:L.Mixin.Events,options:{searchLayerProp:"title",searchInitial:!0,searchMinLen:5,searchDelay:300,timeAutoclose:1200,autoPan:!0,autoResize:!0,animatePan:!0,zoom:null,position:"topleft",prepend:!0,placeholder:"Search place ..",textErr:"Place not found",autocompleteEnabled:!0,hightlightTarget:!0},initialize:function(e){L.Control.prototype.initialize.apply(this,arguments),L.Util.setOptions(this,e),this._inputMinSize=this.options.placeholder.length,this.options.searchLayer=this.options.searchLayer||new L.LayerGroup,this.options.searchJsonpFilter=this.options.searchJsonpFilter||this._jsonpDefaultFilter,this.timeDelaySearch=this.options.searchDelay,this._recordsCache={}},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),i=this.getPosition(),n=e._controlCorners[i];return L.DomUtil.addClass(t,"leaflet-control"),this.options.prepend?n.insertBefore(t,n.firstChild):n.appendChild(t),this},onAdd:function(e){this._map=e;var t="leaflet-control-osmplacefinder";return this._container=L.DomUtil.create("div",t+" leaflet-bar"),this._alert=this._createAlert("search-alert"),this._input=this._createInput(this.options.placeholder,"search-input"),this._createButton(this.options.placeholder,"search-button"),this._tooltip=this._createTooltip("search-tooltip"),this._container},onRemove:function(e){this._recordsCache=[]},showAlert:function(e){this._setVisibleElem(this._alert,!0,100),this._alert.innerHTML=e;var t=this;clearTimeout(this.timerAlert);var i=2e3;this.timerAlert=setTimeout(function(){t._setVisibleElem(t._alert,!1,200)},i)},_setVisibleElem:function(e,t,i){var n=t?"show":"hide";$&&$.fn&&$.fn.show&&$.fn.hide?$(e)[n](500):this._alert.style.display=t?"inherit":"none"},expand:function(){this._input.style.display="block",L.DomUtil.addClass(this._container,"exp"),this._input.focus(),""!==this._input.value&&this._refreshPlaces()},collapse:function(){return localStorage.getItem("CSS")?void console.error("  comentado c√≥digo para colapsar"):(this._hideTooltip(),this._input.size=this._inputMinSize,this._alert.style.display="none",this._input.style.display="none",void L.DomUtil.removeClass(this._container,"exp"))},autoCollapse:function(){var e=this,t=isNaN(this.options.timeAutoclose)?0:+this.options.timeAutoclose;t&&(this.timerCollapse=setTimeout(function(){e.collapse()},this.timeout))},autoCollapseStop:function(){clearTimeout(this.timerCollapse)},_clickFocus:function(e){e.target.focus()},_createAlert:function(e){var t=L.DomUtil.create("div",e,this._container);return t.style.display="none",t},_createInput:function(e,t){var i=L.DomUtil.create("input",t,this._container);return i.type="text",i.size=this._inputMinSize,i.value="",i.placeholder=e,i.style.display="none",L.DomEvent.disableClickPropagation(i).addListener(i,"keyup",this._handleKeypress,this).addListener(i,"keyup",this._handleAutoresize,this).addListener(i,"blur",this.autoCollapse,this).addListener(i,"focus",this.autoCollapseStop,this),i},_createButton:function(e,t){var i=L.DomUtil.create("a",t,this._container);return i.href="#",i.title=e,L.DomEvent.disableClickPropagation(i).addListener(i,"focus",this.autoCollapseStop,this).addListener(i,"blur",this.autoCollapse,this).addListener(i,"click",this._handleSubmit,this),i},_createTooltip:function(e){var t=L.DomUtil.create("div",e,this._container);t.style.display="none";var i=this;return L.DomEvent.disableClickPropagation(t).addListener(t,"blur",this.autoCollapse,this).addListener(t,"mousewheel",function(e){i.autoCollapseStop(),L.DomEvent.stopPropagation(e)},this).addListener(t,"mousedown",function(e){L.DomEvent.stop(e),i.autoCollapseStop()},this),t},_createTip:function(e){var t=L.DomUtil.create("a","search-tip");return t.href="#",t.innerHTML=e.display_name,t.setAttribute("data-tip",e),L.DomEvent.addListener(t,"click",function(t){this._input.focus(),this._hideTooltip(),this._handleAutoresize(),this.options.autoPan&&this._handleSubmit(e)},this),t},_createCopyright:function(){var e=L.DomUtil.create("p","osm-copyright");e.innerHTML="powered by ";var t=L.DomUtil.create("a");return t.href="http://wiki.openstreetmap.org/wiki/Nominatim",t.innerHTML="Nominatim",t.target="_blank",e.appendChild(t),e},_showTooltip:function(){this._tooltip.innerHTML="";for(var e=this._recordsCache,t=0;t<e.length;t+=1){var i=e[t];this._tooltip.appendChild(this._createTip(i))}if(0===+e.length){var n=L.DomUtil.create("p","err-text",this._tooltip);n.innerText=this.options.textErr}this._tooltip.appendChild(this._createCopyright()),this._tooltip.style.display="block"},_hideTooltip:function(){this._tooltip.style.display="none",this._tooltip.innerHTML=""},_handleKeypress:function(e){switch(e.keyCode){case 27:""===this._input.value?this.collapse():this._input.value="";break;case 13:this.options.autocompleteEnabled===!1?this._refreshPlaces():this._handleSubmit(0);break;case 37:case 39:var t=this._input.value;this._input.selectionStart>=t.length&&this._refreshPlaces(t);break;case 16:case 17:break;default:if(this.options.autocompleteEnabled===!1)return;if(clearTimeout(this.timerKeypress),this._input.value.length<this.options.searchMinLen)return this._hideTooltip();var i=this;this.timerKeypress=setTimeout(function(){i._refreshPlaces()},i.timeDelaySearch)}},_refreshPlaces:function(e){var i=this;if(!this._isRefreshing){this._isRefreshing=!0,e===t&&(e=this._input.value);var n=L.Util.geocodingService,a={limit:5};n.search(e,a,function(t,n){if(null!==t)console.warn("Error search in nominatim "+e+"]",t),i._recordsCache=[];else{i._recordsCache=n;var a=n||n.length;console.info(""+new Date+" nominatim - getPlaces: ok: "+a,n)}i._isRefreshing=!1,i._showTooltip()})}},_handleAutoresize:function(){this.options.autoResize&&(this._input.size=this._input.value.length<this._inputMinSize?this._inputMinSize:this._input.value.length)},_handleSubmit:function(e){"none"===this._input.style.display?this.expand():(e=e||this._recordsCache[0],e?this._findLocation(e)===!1?this.showAlert(this.options.textErr):(+this.options.timeAutoclose>0==!1&&this.collapse(),this.options.hightlightTarget&&this.highlightResult(e)):this.collapse()),this._input.focus()},_findLocation:function(e){try{var t=new L.latLng(e.lat,e.lon),i=e.boundingbox,n=new L.LatLngBounds([[i[0],i[2]],[i[1],i[3]]]);return this._map.fitBounds(n),t}catch(a){return!1}},highlightResult:function(e){if(e){var t=new L.LayerGroup;if(t.addTo(this._map),e.lat){var i=L.circleMarker([e.lat,e.lon],{radius:10,weight:2,fillColor:"#ff7800",color:"blue",opacity:.75}),n=this._map;i.on("click",function(){n.removeLayer(t)}),t.addLayer(i)}if(e.aBoundingBox){var a=[[1*e.aBoundingBox[0],1*e.aBoundingBox[2]],[1*e.aBoundingBox[1],1*e.aBoundingBox[3]]];if(this._map.fitBounds(a),e.asgeojson&&e.asgeojson.match(/(Polygon)|(Line)/)){var o=JSON.parse(e.asgeojson),r=L.geoJson(o,{style:function(e){return{interactive:!1,color:"blue"}}});t.addLayer(r)}}}}}),L.Map._isDemoEnabled){console.info("OJO: Nominatim activado. Hacking L.Map._onclic"),L.Map.mergeOptions({uxNominatim:{zoomOffset:2}});var n;L.Map.NominatimClickHandler=L.Handler.extend({initialize:function(e){n.initialize.apply(this,arguments),this._zoomOffset=e.options.uxNominatim.zoomOffset||0},addHooks:function(){var e=this._map;e.on("click",this._clicked,this),e.whenReady(this._mapReady,this)},removeHooks:function(){this._map.off("click",this._clicked,this)},_mapReady:function(){var e=this._map._container&&this._map._container.id;console.info("GeocodingService. Mapa listo para  click->nominatim-balloon: MapId: ["+e+"]. Clic con shift y ctrl presionados")},_clicked:function(t){var n=t.originalEvent;if(n.altKey&&n.ctrlKey){console.info("Prueba con nominatim en ",n);var a=this._map,o=t.latlng,r=a.getZoom()+this._zoomOffset,s=L.popup({className:"ux-nomintim"}),l=document.createElement("div");s.setContent(l),s.setLatLng(o),l.classList.add("ux-nominatim"),l.classList.add("ux-waiting");var c=document.createElement("div");c.style.maxHeight="150px",c.style.overflowY="scroll",c.style.padding=".6em",c.style.backgroundColor="#f0f0d0",l.innerHTML="<p>Obteniendo posici√≥n</p>",l.appendChild(c);var d=new e(i,{}),u=this;d.reverseSearch(o.lat,o.lng,r,function(e,t){if(null!==e)c.innerText=e.message;else{var i=u._generateHtmlTable(t.address,null,!1);c.style.fontSize="1.35em",c.innerHTML=i,l.classList.remove("ux-waiting"),l.parentNode.style.width="inherit",l.parentNode.style.minWidth="200px",l.parentNode.style.maxWidth="500px",s.update()}}),this._map.openPopup(s)}},_onViewReset:function(){var e=this._map.getSize()._divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.project([0,180]).x},_generateHtmlTable:function(e,t,i){if("string"==typeof t)return e[t];var n=!t;t=!t&&e;var a="";for(var o in t)if(n||o in e){var r=i?o+" : ":"";a+="<tr><td>"+r+"</td><td>"+e[o]+"</td></tr>"}return a=a||"- - -","<table><tbody>"+a+"</tbody></table>"}}),n=L.Map.NominatimClickHandler.__super__,L.Map.addInitHook("addHandler","uxNominatim",L.Map.NominatimClickHandler)}}(),function(e){function t(e){var t=i(e.options);if(e instanceof L.SVG)return L.svg(t);if(e instanceof L.Canvas)return L.canvas(t);if(e instanceof L.TileLayer)return L.tileLayer(e._url,t);if(e instanceof L.ImageOverlay)return L.imageOverlay(e._url,e._bounds,t);if(e instanceof L.Marker)return L.marker(e.getLatLng(),t);if(e instanceof L.Circle)return L.circle(e.getLatLng(),e.getRadius(),t);if(e instanceof L.CircleMarker)return L.circleMarker(e.getLatLng(),t);if(e instanceof L.Rectangle)return L.rectangle(e.getBounds(),t);if(e instanceof L.Polygon)return L.polygon(e.getLatLngs(),t);if(e instanceof L.Polyline)return L.polyline(e.getLatLngs(),t);if(e instanceof L.GeoJSON)return L.geoJson(e.toGeoJSON(),t);if(e instanceof L.LayerGroup)return L.layerGroup(n(e));if(e instanceof L.FeatureGroup)return L.FeatureGroup(n(e));throw"Unknown layer, cannot clone this layer. Leaflet-version: "+L.version}function i(e){var i={};for(var n in e){var a=e[n];a&&a.clone?i[n]=a.clone():a instanceof L.Layer?i[n]=t(a):i[n]=a}return i}function n(e){var i=[];return e.eachLayer(function(e){i.push(t(e))}),i}L.Util.cloneLayer||(L.Util.cloneLayer=t),"object"==typeof e&&(module.exports=t)}(e.exports),function(){function i(e,i){var n=i.properties[e];return n===t&&(n="not-found-"+e),n}if(!e.L)throw new Error("L.Control.Markers needs Leaflet");L.ux||(L.ux={});L.ux.Marker=L.Marker.extend({_isMarker:!0,_feature:null,_latlng:null,_bocadilloOffset:new L.Point(0,(-42)),initialize:function(e,t){this._feature=t,this._latlng=e;var i=this.createIcon(),n=this.createTitle();L.Marker.prototype.initialize.call(this,e,{title:n,icon:i})},showPopup:function(e,t,i,n){if(null===this._popup){var a=e.fillPopup(this._feature,t,i),o=this._latlng,r=this._bocadilloOffset;this._popup=L.popup({offset:r}).setLatLng(o).setContent(a)}this._popup.openOn(e)},createIcon:function(){return L.marker()},createTitle:function(){return"Marker"},_getProperty:function(e){i("entitytype",this._feature)},_end:0}),L.ux.EntityMarker=L.ux.Marker.extend({_isEntityMarker:!0,_bocadilloOffset:new L.Point(0,(-42)),createIcon:function(){var e=this._feature.properties.status||"unknown",t="status-"+e+" t-"+this._getProperty("entitytype"),i=L.divIcon({iconSize:[40,40],iconAnchor:[20,40],html:"<div class='m2m-type'></div>",className:t});return i},createTitle:function(){return this._getProperty("entityKeyAsString")},_end:0}),L.ux.entityMarker=function(e,t){return new L.ux.maps.EntityMarker(e,t)},L.ux.QuadrantMarker=L.ux.Marker.extend({_isQuadrantMarker:!0,_bocadilloOffset:new L.Point(0,(-17)),createIcon:function(){var e="marker-cluster marker-cluster-small quadranKey",t=L.divIcon({iconSize:[40,40],iconAnchor:[20,20],html:"<div class=''><span>G</span></div>",className:e});return t},createTitle:function(){var e="Agrupador: "+this._getProperty("quadrantKeyAsString");return e},_end:0}),L.ux.quadrantMarker=function(e,t){return new L.ux.maps.QuadrantMarker(e,t)}}(),function(){function e(e,t){var i=t[0];return i?(o(i,function(t,i){if(t)return void console.error("Error cartgando fichero",t);try{L.TileLayer.prototype.changeTileDataFromJson.call(e,i)}catch(t){throw"Invalid JSON data"}}),void console.debug("Cambiando tiles a capa: "+e.name)):void console.debug("carga de tiles locales cancelada")}function t(e,t){var i=t[0];if("string"==typeof i)return!1;i.id;return!1}function i(e){var t=(e.options||{},e.options.usingLocalTiles||localStorage.getItem("localtiles")),i={osm:{name:"OpenStreetMap",url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz",layerParams:{attribution:"OpenStreet Map",maxZoom:19}},dark2:{name:"Dark Map",url:"//{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",layerParams:{attribution:"Cartocdn Dark Map",maxZoom:19},type:"xyz"},ogWorld:{name:"OpenGate Maps",url:"http://172.19.18.248/osm_tiles/{z}/{x}/{y}.png",layerParams:{attribution:"OpenGate Maps",maxZoom:19},type:"xyz"}},n=new L.Control.Layers;e.addControl(n);for(var a in i){var o=i[a],r=L.tileLayer(o.url,o.options);n.addBaseLayer(r,o.name)}e.addControl(new L.Control.MousePosition({})),e.addControl(new L.Control.Fullscreen({})),t&&L.Control.LocalTileControl&&e.addControl(new L.Control.LocalTileControl({}))}function n(e,t){var i=t&&t.controls&&t.controls.custom;!e._syncMinimapLayerenabled&&i&&(e._syncMinimapLayerenabled=!0,e.on("baselayerchange",function(e){var t=a(i,L.Control.MiniMap);if(t){var n=new L.TileLayer(e.layer._url);t.changeLayer(n)}var o=a(i,L.Control.Gohome);if(o){var r=e.layer.getHomeInfo&&e.layer.getHomeInfo();r&&r.center?o.changeTargetView(r.center,r.zoom):o.restoreOriginalView()}}))}function a(e,t){for(var i=0;i<e.length;i+=1){var n=e[i];if(n instanceof t)return n}}function o(e,t){var i=e?e.name:"null",n=new FileReader;n.onload=function(){try{var e=n.result;t(null,e)}catch(a){t(new Error("No valid GeoJson file: ["+i+"]\n"+a),null)}};try{n.readAsText(e)}catch(a){t(new Error("Invalid "+i+"\n"+a.message),null)}}function r(e,t,i){function n(e){this.getMessage=function(){return e}}console.warn("WARN: MapUx est√° usando __overrideClass. Class in development: ",e.constructor);var a=i||{};for(var o in t){var r=o,s=e.prototype[r];if(!s){var l=r;s=new n(" not exist "+l).getMessage}a[r]=s;var c=t[r];e.prototype[r]=c}return a}var s,l=!1;if(!L.UxMap&&!L.Map_ixUx){s=L.Map;var c,d={initialize:function(){var e=t(this,arguments);c.initialize.apply(this,arguments),console.info("Ux L.Map initialize");var n=this.options;if(n.editPointSize&&L.Editable&&L.Editable.VertexIcon){var a=parseInt(n.editPointSize);a>5&&a<30&&(L.Editable.VertexIcon.prototype.options.iconSize=new L.Point(a,a))}e&&i(this)},setNgScope:function(e){this._$ScopeConfig||(this._$ScopeConfig=e&&e.config,n(this,e))},_enableMinimapSynchronization:function(e){},addControl:function(e){c.addControl.apply(this,arguments);var t=e&&e._container&&e._container.classList;if(t&&t.contains("leaflet-control-layers")&&(!this._mainLayerControl&&e instanceof L.Control.Layers&&(this._mainLayerControl=e),this._layerControlPosition=e.options.position),this._layerControlPosition===e.options.position){var i=$(this._container).find(".leaflet-control-layers.leaflet-control")[0];
if(i&&i!==e._container){var n=i.parentNode;n.removeChild(i),n.appendChild(i)}}}};l?(c=s.prototype,L.UxMap=s.extend(d),L.UxMap._isUx=!0):(c={},r(s,d,c)),L.Map._isUx=!0,L.Map._isDemoEnabled=!!localStorage.getItem("isUxDemo");var u=L.Control.Zoom.prototype.options;u.zoomInText="",u.zoomOutText="",u.maxZoom=20,L.Map.prototype._removeZoomContent||(L.Map.prototype._removeZoomContent=!0)}if(!L.Control.UxLayers){s=L.Control.Layers;var p,m="Offline",h={initialize:function(e,t,i){p.initialize.apply(this,arguments),this._localLayer=null},_initLayout:function(){p._initLayout.apply(this,arguments),this._container.classList.add("navbar"),this._container.classList.add("navbar-primary"),this._form.classList.add("navbar"),this._form.classList.add("navbar-primary")},addBaseLayer:function(e,t){return p.addBaseLayer.apply(this,arguments),e._isUsingLocalTiles&&(null===this._localLayer?this._localLayer=e:console.warn("Another locallayer already exists. "+this._localLayer.layerName)),this},removeLayer:function(e){return p.removeLayer.apply(this,arguments),e._isUsingLocalTiles&&this._localLayer===e,this},_addItem:function(t){var i=p._addItem.apply(this,arguments);if(t.name.startsWith(m)){var n=document.createElement("input");n.textContent="Seleccionar",n.type="file",Object.defineProperty(n,"layerId",{get:function(){return t.layer._leaflet_id}}),n.style.width="160px",n.style.position="absolute",n.style.left="0px",n.style.top="-24px",n.style.display="none",$(n).click(function(e){e.stopPropagation()}),n.onchange=function(i){i.stopPropagation(),e(t.layer,i.target.files)};var a=i.children[0],o=i.parentNode;$(o).click(function(){var e=a.checked?"inherit":"none";n.style.display=e});var r=o.parentNode;r.insertBefore(n,r.firstChild)}},_refreshOfflineLayer:function(e,t){var i=t[0];return i?(t.length>1&&console.warn("selected "+(t.length-1)+" files after first is ignored"),o(i,function(t,i){if(t)return void console.error("Error cartgando fichero",t);try{L.TileLayer.prototype.changeTileDataFromJson.call(e,i)}catch(t){throw"Invalid JSON data"}}),void console.debug("Cambiando tiles a capa: "+e.name)):void console.debug("carga de tiles locales cancelada")}};l?(p=s.prototype,L.Control.UxLayers=s.extend(h)):(p={},r(s,h,p))}L.DomUtil.uxLoadGeoJsonFromFile=o}(),function(){L.Control.MousePosition=L.Control.extend({options:{position:"bottomleft",separator:" : ",emptyString:"Unavailable",lngFirst:!1,numDigits:6,lngFormatter:t,latFormatter:t,prefix:""},_existMouse:!1,onAdd:function(e){return this._container=L.DomUtil.create("div","leaflet-control-mouseposition"),L.DomEvent.disableClickPropagation(this._container),e.on("mousemove",this._onMouseMove,this),e.on("move",this._onMove,this),this._container.innerHTML=this.options.emptyString,this._container},onRemove:function(e){e.off("mousemove",this._onMouseMove)},_setText:function(e){var t=this.options.lngFormatter?this.options.lngFormatter(e.lng):L.Util.formatNum(e.lng,this.options.numDigits),i=this.options.latFormatter?this.options.latFormatter(e.lat):L.Util.formatNum(e.lat,this.options.numDigits),n=this.options.lngFirst?t+this.options.separator+i:i+this.options.separator+t,a=this.options.prefix+" "+n;this._container.innerHTML=a},_onMouseMove:function(e){this._existMouse=!0,this._setText(e.latlng)},_onMove:function(e){if(!this._existMouse){var t=e.target;this._setText(t.getCenter())}}}),L.Map.mergeOptions({positionControl:!1}),L.Map.addInitHook(function(){this.options.positionControl&&(this.positionControl=new L.Control.MousePosition,this.addControl(this.positionControl))}),L.control.mousePosition=function(e){return new L.Control.MousePosition(e)}}(),function(){function t(){}function i(t,i){var n=e.addEventListener?document.addEventListener:document.attachEvent;n("keydown",function(e){16!==e.keyCode&&16!==e.charCode||(e._iskeydown=!0,t.call(i,e,!0))}),n("keyup",function(e){16!==e.keyCode&&16!==e.charCode||(e._iskeyup=!0,t.call(i,e,!1))})}function n(t,i){var n=e.removeEventListener?document.removeEventListener:function(){};n("keydown",i),n("keyup",i)}function a(t){var i=e.location.protocol+"//b.tile.openstreetmap.org/{z}/{x}/{y}.png",n={attribution:"&copy; <a href='https://osm.org/copyright'>OpenStreetMap</a> contributors"},a=L.tileLayer(i,n),o=L.magnifyingGlass({zoomOffset:3,layers:[a]});return o}if(!e.L)throw new Error("L.MagnifyingGlass needs Leaflet");var o,r;L.Layer?(o=L.Layer,r=!1):(o=L.Class,r=!0),L.MagnifyingGlass=o.extend({options:{radius:180,zoomOffset:3,layers:[],fixedPosition:!1,latLng:[0,0],fixedZoom:-1},initialize:function(e){L.Util.setOptions(this,e),this._fixedZoom=this.options.fixedZoom!==-1,this._mainMap=null,this._glassMap=null},_shifPerformed:function(e,t){var i=t?".6":"1";this._glassMap._container.style.opacity=i},getMap:function(){return this._glassMap},_createMiniMap:function(e){return new L.Map(e,{layers:this.options.layers,zoom:this._getZoom(),maxZoom:this._mainMap.getMaxZoom(),minZoom:this._mainMap.getMinZoom(),crs:this._mainMap.options.crs,fadeAnimation:!1,attributionControl:!1,zoomControl:!1,boxZoom:!1,touchZoom:!1,scrollWheelZoom:!1,doubleClickZoom:!1,dragging:!1,keyboard:!1})},_getZoom:function(){return this._fixedZoom?this.options.fixedZoom:this._mainMap.getZoom()+this.options.zoomOffset},_updateZoom:function(){this._glassMap.setZoom(this._getZoom())},setRadius:function(e){this.options.radius=e,this._wrapperElt&&(this._wrapperElt.style.width=2*this.options.radius+"px",this._wrapperElt.style.height=2*this.options.radius+"px")},setLatLng:function(e){this.options.latLng=e,this._update(e)},_updateFromMouse:function(e){this._update(e.latlng,e.layerPoint)},_updateFixed:function(){this._update(this.options.latLng)},_update:function(e,t){this._glassMap.setView(e,this._getZoom(),{pan:{animate:!1}}),t=t||this._mainMap.latLngToLayerPoint(e),this._wrapperElt.style.left=t.x-this.options.radius+"px",this._wrapperElt.style.top=t.y-this.options.radius+"px"},onAdd:function(e){this._mainMap=e,this._wrapperElt=L.DomUtil.create("div","leaflet-magnifying-glass");var t=L.DomUtil.create("div","",this._wrapperElt);L.Browser.webkit&&L.DomUtil.addClass(t,"leaflet-magnifying-glass-webkit"),this._glassMap=this._createMiniMap(t),L.DomEvent.addListener(this._wrapperElt,"click",this._fireClick,this);var n=this.options;return this.setRadius(n.radius),this.setLatLng(n.latLng),this._glassMap.whenReady(function(){n.fixedPosition?(this._mainMap.on("zoomend",this._updateFixed,this),L.DomUtil.addClass(this._wrapperElt,"leaflet-zoom-hide")):(this._mainMap.on("mousemove",this._updateFromMouse,this),this._fixedZoom||this._mainMap.on("zoomend",this._updateZoom,this))},this),e.getPanes().popupPane.appendChild(this._wrapperElt),this._glassMap.invalidateSize(),i(this._shifPerformed,this),this},_fireClick:function(e){this.fire&&this.fire("click",e),L.DomEvent.stopPropagation(e)},onRemove:function(e){e.off("viewreset",this._updateFixed,this),e.off("mousemove",this._updateFromMouse,this),e.off("zoomend",this._updateZoom,this);for(var t=0,i=this.options.layers.length;t<i;t++)this._glassMap.removeLayer(this.options.layers[t]);return this._glassMap.remove(),L.DomEvent.removeListener(this._wrapperElt,"click",this._fireClick),e.getPanes().popupPane.removeChild(this._wrapperElt),this._mainMap=null,n(this._shifPerformed,this),this}}),L.magnifyingGlass=function(e){return new L.MagnifyingGlass(e)},L.Control.MagnifyingGlass=L.Control.extend({_magnifyingGlass:!1,options:{position:"topleft",title:"Toggle Magnifying Glass",forceSeparateButton:!0},initialize:function(e){for(var t in e)e.hasOwnProperty(t)&&this.options.hasOwnProperty(t)&&(this.options[t]=e[t])},onAdd:function(e){var t,i="leaflet-control-magnifying-glass";return t=e.zoomControl&&!this.options.forceSeparateButton?e.zoomControl._container:L.DomUtil.create("div",i+" leaflet-bar"),this._button=this._createButton(this.options.title,i,t,e),t},_createButton:function(e,t,i,n){var a=this,o=L.DomUtil.create("a",t,i);return o.href="#",o.title=e,L.DomEvent.addListener(o,"click",L.DomEvent.stopPropagation).addListener(o,"click",L.DomEvent.preventDefault).addListener(o,"click",function(){a._clicked(n)}),o},_clicked:function(){var e=this._map;this._magnifyingGlass||(this._magnifyingGlass=a(e)),e.hasLayer(this._magnifyingGlass)?(e.removeLayer(this._magnifyingGlass),L.DomUtil.removeClass(this._button,"active")):(this._magnifyingGlass.addTo?this._magnifyingGlass.addTo(e):e.addLayer(this._magnifyingGlass),L.DomUtil.addClass(this._button,"active"))}}),L.control.magnifyingglass=function(e){return new L.Control.MagnifyingGlass(e)},t()}(),function(){var t=L.Control.GPlaceAutocomplete;if(!t)return void console.error("L.Control.GPlaceAutocomplete2 requires L.Control.GPlaceAutocomplete");if(L.Control.GPlaceAutocomplete2=t.extend({_buildContainer:function(e){var i=this;L.extraApi.ensureLib("google",["google.maps.places.Autocomplete"],function(){t.prototype._buildContainer.call(i,e)})},addTo:function(i){var n=this,a=e.setInterval(function(){n.container&&(e.clearInterval(a),t.prototype.addTo.call(n,i))},100)}}),document.location.host.startsWith("172.")||document.location.host.startsWith("localhost"))var i=2e3,n=3,a=n,o=e.setInterval(function(){var t="google-apikey",i=localStorage.getItem(t);i&&L.extraApi?(console.info("Found apikey in locaStorage['"+t+"']"),L.extraApi.setApikey("google",i),a=-1):console.debug("Not Found apikey in locaStorage['"+t+"']"),(a-=1)<0&&e.clearInterval(o)},i)}(),function(){function i(e){L.Google.asyncWait.push(e),n||(n=!0,L.extraApi.ensureLib("google",["google.maps.Map"],function(){var e;for(e=0;e<L.Google.asyncWait.length;e++){var t=L.Google.asyncWait[e];t._ready=!0,t._container&&(t._initMapObject(),t._update())}L.Google.asyncWait=[]}))}if(!e.L)throw new Error("L.Google needs Leaflet");L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1},initialize:function(n,a){L.Util.setOptions(this,a),this._ready=e.google!==t,this._ready||i(this),this._type=n||"SATELLITE"},onAdd:function(e,t){this._map=e,this._insertAtTheBottom=t,this._initContainer(),this._initMapObject(),e.on("viewreset",this._resetCallback,this),this._limitedUpdate=L.Util.limitExecByInterval(this._update,50,this),e.on("move",this._update,this),e.on("dragstart",this._update,this),e.on("drag",this._update,this),e.on("zoomstart",this._update,this),e.on("zoomend",this._update,this),e.on("autopanstart",this._update,this),e._controlCorners.bottomright.style.marginBottom="1em",this._reset(),this._update()},onRemove:function(e){this._map._container.removeChild(this._container),this._map.off("viewreset",this._resetCallback,this),this._map.off("move",this._update,this),e._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(e){this.options.opacity=e,e<1&&L.DomUtil.setOpacity(this._container,e)},setElementSize:function(e,t){e.style.width=t.x+"px",e.style.height=t.y+"px"},_initContainer:function(){var e=this._map._container,t=e.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left"),this._container.id="_GMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),e.insertBefore(this._container,t),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(this._ready){this._google_center=new google.maps.LatLng(0,0);var e=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!0,streetViewControl:!1}),t=this;this._reposition=google.maps.event.addListenerOnce(e,"center_changed",function(){t.onReposition()}),e.backgroundColor="#ff0000",this._google=e}},_resetCallback:function(e){this._reset(e.hard)},_reset:function(e){this._initContainer()},_update:function(){if(this._google){this._resize();var e=this._map.getBounds(),t=e.getNorthEast(),i=e.getSouthWest(),n=(new google.maps.LatLngBounds(new google.maps.LatLng(i.lat,i.lng),new google.maps.LatLng(t.lat,t.lng)),this._map.getCenter()),a=new google.maps.LatLng(n.lat,n.lng);this._google.setCenter(a),this._google.setZoom(this._map.getZoom())}},_resize:function(){var e=this._map.getSize();this._container.style.width===e.x&&this._container.style.height===e.y||(this.setElementSize(this._container,e),this.onReposition())},onReposition:function(){this._google&&google.maps.event.trigger(this._google,"resize")}}),L.Google.asyncWait=[];var n=!1}(),!e.L)throw new Error("L.Control.Gohome needs Leaflet");L.Control.Gohome=L.Control.extend({includes:L.Mixin.Events,options:{className:""},_isGohomeInstance:!0,initialize:function(e){L.Control.initialize&&L.Control.initialize.apply(this,arguments),L.Util.setOptions(this,e),this._className=(this.options.className||"")+" ux-home",this.options.center=this.options.center||[40,-3.7],this.options.zoom=this.options.zoom||8,this._originalView={center:this.options.center,zoom:this.options.zoom}},onAdd:function(e){var t=this._className+" leaflet-control-home",i=L.DomUtil.create("div",t+" leaflet-bar"),n=this.options.fullscreenTitle||"Go Home Location";return this._createButton("",n,t,i,this.goHome,this),i},_createButton:function(e,t,i,n,a,o){var r=L.DomUtil.create("a",i+" leaflet-bar-part",n);r.innerHTML=e,r.href="#",r.title=t;var s=L.DomEvent.stopPropagation;return L.DomEvent.on(r,"click",s).on(r,"mousedown",s).on(r,"dblclick",s).on(r,"click",L.DomEvent.preventDefault).on(r,"click",a,o).on(r,"click",this._refocusOnMap,o),r},goHome:function(){if(this.options.bounds)this._map.fitBounds(this.options.bounds);else{var e=this.options.zoom||8,t=this.options.center,i=new L.LatLng(t[0],t[1]);this._map.setView(i,e)}this._map.invalidateSize()},saveCurrentViewOriginalView:function(){this._originalView={center:this.options.center,zoom:this.options.zoom}},restoreOriginalView:function(){this.changeTargetView(this._originalView.center,this._originalView.zoom)},changeTargetView:function(e,i){if(isNaN(e[0])||isNaN(e[1])){if(isNaN(e.lat)||isNaN(e.lng))throw"unknowwn format for center: "+e;this.options.center=[e.lat,e.lng]}else this.options.center=e;this.options.zoom=i,this.options.bounds=t},changeTargetViewToBounds:function(e){if(!e.isValid)throw"Invalid bounds: "+e;this.options.bounds=e,this.options.zoom=t,this.options.center=t},_oldStyle:{}}),L.gohome=function(e){return new L.Control.Gohome(e)},a(),function(){if(!e.L)throw new Error("L.Control.FeatureSelection needs Leaflet");L.Control.FeatureSelection=L.Control.extend({includes:L.Mixin.Events,options:{className:""},_button:null,_restriction:null,initialize:function(t){if(!e.L.Map.SelectArea)throw new Error("L.Control.FeatureSelection needs L.Map.SelectArea (bower: leaflet-select-area");L.Control.initialize&&L.Control.initialize.apply(this,arguments),L.Util.setOptions(this,t)},onAdd:function(e){this._map=e;var t=(this._className||"")+" leaflet-control-boxselection",i=L.DomUtil.create("div",t+" leaflet-bar"),n=this.options.title||"Select features on map";n="IN DEVELOPMENT  --  Select features on map",console.warn(n),this._button=this._createButton("",n,t,i,this.goHome,this);document.querySelector(".info .result")||$("<div></div>");return e.on({areaselected:this.areaSelectedPerformed,areaselecttoggled:this.updateButton}),this._map.selectArea.setControlKey(!1),this.updateButton(),i},areaSelectedPerformed:function(e){var t=e.bounds.toBBoxString().split(",").join(",\n");console.info(t)},_createButton:function(e,t,i,n,a,o){var r=this,s=L.DomUtil.create("a",i+" leaflet-bar-part",n);s.innerHTML=e,s.href="#",s.title=t;var l=L.DomEvent.stopPropagation;return L.DomEvent.on(s,"click",function(){r._areaSelectToggled()}).on(s,"mousedown",l).on(s,"dblclick",l).on(s,"click",L.DomEvent.preventDefault),s},updateButton:function(){this._button&&L.DomUtil[this._map.selectArea.enabled()?"addClass":"removeClass"](this._button,"active")},toggleRestriction:function(){var e=this._map;if(this._restriction)e.removeLayer(this._restriction),e.selectArea.setValidate(),this._restriction=null;else{var t=e.getBounds().pad(-.25);this._restriction=L.rectangle(t,{weight:2,color:"#0ff",fillOpacity:0,clickable:!1,opacity:.7}).addTo(e),e.selectArea.setValidate(function(i){return t.contains(e.layerPointToLatLng(i))})}},_areaSelectToggled:function(){this._map.selectArea.enabled()?(L.DomUtil.removeClass(this._button,"active"),this._map.selectArea.disable(),console.info("Select area disabled")):(L.DomUtil.addClass(this._button,"active"),this._map.selectArea.enable(),console.info("Select area enabled"))},toggleCtrlKey:function(){this._map.selectArea.setControlKey(document.querySelector("#ctrl-key").checked)},toggleShiftKey:function(){this._map.selectArea.selectArea.setShiftKey(document.querySelector("#shift-key").checked)},_oldStyle:{}}),L.boxSelection=function(e){return new L.Control.BoxSelection(e)}}(),L.Editable=L.Class.extend({_dev_version:"0.9.0",_clazzName:"L.Editable",includes:[L.Mixin.Events],statics:{FORWARD:1,BACKWARD:-1},options:{zIndex:1e3,polygonClass:L.Polygon,polylineClass:L.Polyline,markerClass:L.Marker,drawingCSSClass:"leaflet-editable-drawing"},initialize:function(e,t){L.setOptions(this,t),this._lastZIndex=this.options.zIndex,this.map=e,this.editLayer=this.createEditLayer(),this.featuresLayer=this.createFeaturesLayer(),this.newClickHandler=this.createNewClickHandler(),this.forwardLineGuide=this.createLineGuide(),this.backwardLineGuide=this.createLineGuide()},fireAndForward:function(e,t){t=t||{},t.editTools=this,this.fire(e,t),this.map.fire(e,t)},createLineGuide:function(){var e=L.extend({dashArray:"5,10",weight:1},this.options.lineGuideOptions);return L.polyline([],e)},createVertexIcon:function(e){return L.Browser.touch?new L.Editable.TouchVertexIcon(e):new L.Editable.VertexIcon(e)},createNewClickHandler:function(){return L.marker(this.map.getCenter(),{icon:this.createVertexIcon({className:"leaflet-div-icon leaflet-drawing-icon"}),opacity:0,zIndexOffset:this._lastZIndex})},createEditLayer:function(){return this.options.editLayer||(new L.LayerGroup).addTo(this.map)},createFeaturesLayer:function(){return this.options.featuresLayer||(new L.LayerGroup).addTo(this.map)},moveForwardLineGuide:function(e){this.forwardLineGuide._latlngs.length&&(this.forwardLineGuide._latlngs[1]=e,this.forwardLineGuide.redraw())},moveBackwardLineGuide:function(e){this.backwardLineGuide._latlngs.length&&(this.backwardLineGuide._latlngs[1]=e,this.backwardLineGuide.redraw())},anchorForwardLineGuide:function(e){this.forwardLineGuide._latlngs[0]=e,this.forwardLineGuide.redraw()},anchorBackwardLineGuide:function(e){this.backwardLineGuide._latlngs[0]=e,this.backwardLineGuide.redraw()},attachForwardLineGuide:function(){this.editLayer.addLayer(this.forwardLineGuide)},attachBackwardLineGuide:function(){this.editLayer.addLayer(this.backwardLineGuide)},detachForwardLineGuide:function(){this.forwardLineGuide._latlngs=[],this.editLayer.removeLayer(this.forwardLineGuide)},detachBackwardLineGuide:function(){this.backwardLineGuide._latlngs=[],this.editLayer.removeLayer(this.backwardLineGuide)},updateNewClickHandlerZIndex:function(){this._lastZIndex+=2,this.newClickHandler.setZIndexOffset(this._lastZIndex)},registerForDrawing:function(e){this.map.on("mousemove touchmove",e.onMouseMove,e),this._drawingEditor&&this.unregisterForDrawing(this._drawingEditor),this._drawingEditor=e,this.editLayer.addLayer(this.newClickHandler),this.newClickHandler.on("click",e.onNewClickHandlerClicked,e),L.Browser.touch&&this.map.on("click",e.onTouch,e),L.DomUtil.addClass(this.map._container,this.options.drawingCSSClass),this.updateNewClickHandlerZIndex()},unregisterForDrawing:function(e){e=e||this._drawingEditor,this.editLayer.removeLayer(this.newClickHandler),e&&(this.map.off("mousemove touchmove",e.onMouseMove,e),this.newClickHandler.off("click",e.onNewClickHandlerClicked,e),L.Browser.touch&&this.map.off("click",e.onTouch,e),e===this._drawingEditor&&(delete this._drawingEditor,e.drawing&&e.cancelDrawing(),L.DomUtil.removeClass(this.map._container,this.options.drawingCSSClass)))},stopDrawing:function(){this.unregisterForDrawing()},connectCreatedToMap:function(e){return this.featuresLayer.addLayer(e)},startPolyline:function(e,t){var i=this.createPolyline([],t);this.connectCreatedToMap(i);var n=i.enableEdit();return n.startDrawingForward(),e&&n.newPointForward(e),i},startPolygon:function(e,t){var i=this.createPolygon([],t);this.connectCreatedToMap(i);var n=i.enableEdit();return n.startDrawingForward(),e&&n.newPointForward(e),i},startMarker:function(e,t){e=e||this.map.getCenter();var i=this.createMarker(e,t);this.connectCreatedToMap(i);var n=i.enableEdit();return n.startDrawing(),i},startHole:function(e,t){e.newHole(t)},extendMultiPolygon:function(e){var t=this.createPolygon([]);e.addLayer(t),t.multi=e;var i=t.enableEdit();return i.startDrawingForward(),t},createPolyline:function(e,t){t=L.Util.extend({editOptions:{editTools:this}},t);var i=new this.options.polylineClass(e,t);return this.fireAndForward("editable:created",{layer:i}),i},createPolygon:function(e,t){t=L.Util.extend({editOptions:{editTools:this}},t);var i=new this.options.polygonClass(e,t);return this.fireAndForward("editable:created",{layer:i}),i},createMarker:function(e,t){t=L.Util.extend({editOptions:{editTools:this}},t);var i=new this.options.markerClass(e,t);return this.fireAndForward("editable:created",{layer:i}),i}}),L.Map.addInitHook(function(){this.whenReady(function(){this.options.editable!==!1&&(this.editTools=new L.Editable(this,this.options.editOptions))})}),L.Editable.VertexIcon=L.DivIcon.extend({_clazzName:"L.Editable.VertexIcon",options:{iconSize:new L.Point(8,8)}}),L.Editable.TouchVertexIcon=L.Editable.VertexIcon.extend({_clazzName:"L.Editable.TouchVertexIcon",options:{iconSize:new L.Point(20,20)}}),L.Editable.VertexMarker=L.Marker.extend({_clazzName:"L.Editable.VertexMarker",options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon"},initialize:function(e,t,i,n){this.latlng=e,this.latlngs=t,this.editor=i,L.Marker.prototype.initialize.call(this,e,n),this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.latlng.__vertex=this,this.editor.editLayer.addLayer(this),this.setZIndexOffset(i.tools._lastZIndex+1)},onAdd:function(e){L.Marker.prototype.onAdd.call(this,e),this.on("drag",this.onDrag),this.on("dragstart",this.onDragStart),this.on("dragend",this.onDragEnd),this.on("click",this.onClick),this.on("contextmenu",this.onContextMenu),this.on("mousedown touchstart",this.onMouseDown),this.addMiddleMarkers()},onRemove:function(e){this.middleMarker&&this.middleMarker["delete"](),delete this.latlng.__vertex,this.off("drag",this.onDrag),this.off("dragstart",this.onDragStart),this.off("dragend",this.onDragEnd),this.off("click",this.onClick),this.off("contextmenu",this.onContextMenu),this.off("mousedown touchstart",this.onMouseDown),L.Marker.prototype.onRemove.call(this,e)},onDrag:function(e){e.vertex=this,this.editor.onVertexMarkerDrag(e);var t=L.DomUtil.getPosition(this._icon),i=this._map.layerPointToLatLng(t);this.latlng.lat=i.lat,this.latlng.lng=i.lng,this.editor.refresh(),this.middleMarker&&this.middleMarker.updateLatLng();var n=this.getNext();n&&n.middleMarker&&n.middleMarker.updateLatLng()},onDragStart:function(e){e.vertex=this,this.editor.onVertexMarkerDragStart(e)},onDragEnd:function(e){e.vertex=this,this.editor.onVertexMarkerDragEnd(e)},onClick:function(e){e.vertex=this,this.editor.onVertexMarkerClick(e)},onContextMenu:function(e){e.vertex=this,this.editor.onVertexMarkerContextMenu(e)},onMouseDown:function(e){e.vertex=this,this.editor.onVertexMarkerMouseDown(e)},"delete":function(){var e=this.getNext();this.latlngs.splice(this.latlngs.indexOf(this.latlng),1),this.editor.editLayer.removeLayer(this),this.editor.onVertexDeleted({latlng:this.latlng,vertex:this}),e&&e.resetMiddleMarker()},getIndex:function(){return this.latlngs.indexOf(this.latlng)},getLastIndex:function(){return this.latlngs.length-1},getPrevious:function(){if(!(this.latlngs.length<2)){var e=this.getIndex(),t=e-1;0===e&&this.editor.CLOSED&&(t=this.getLastIndex());var i=this.latlngs[t];return i?i.__vertex:void 0}},getNext:function(){if(!(this.latlngs.length<2)){var e=this.getIndex(),t=e+1;e===this.getLastIndex()&&this.editor.CLOSED&&(t=0);var i=this.latlngs[t];return i?i.__vertex:void 0}},addMiddleMarker:function(e){e=e||this.getPrevious(),e&&!this.middleMarker&&(this.middleMarker=this.editor.addMiddleMarker(e,this,this.latlngs,this.editor))},addMiddleMarkers:function(){if(!this.editor.tools.options.skipMiddleMarkers){var e=this.getPrevious();e&&this.addMiddleMarker(e);var t=this.getNext();t&&t.resetMiddleMarker()}},resetMiddleMarker:function(){this.middleMarker&&this.middleMarker["delete"](),this.addMiddleMarker()},_initInteraction:function(){L.Marker.prototype._initInteraction.call(this),L.DomEvent.on(this._icon,"touchstart",function(e){this._fireMouseEvent(e)},this)}}),L.Editable.mergeOptions({vertexMarkerClass:L.Editable.VertexMarker}),L.Editable.MiddleMarker=L.Marker.extend({_clazzName:"L.Editable.MiddleMarker",options:{opacity:.5,className:"leaflet-div-icon leaflet-middle-icon"},initialize:function(e,t,i,n,a){this.left=e,this.right=t,this.editor=n,this.latlngs=i,L.Marker.prototype.initialize.call(this,this.computeLatLng(),a),this._opacity=this.options.opacity,this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.editor.editLayer.addLayer(this);try{this.setVisibility()}catch(o){console.error("err interno MiddleMarker",o)}},setVisibility:function(){var e=this._map.latLngToContainerPoint(this.left.latlng),t=this._map.latLngToContainerPoint(this.right.latlng),i=L.point(this.options.icon.options.iconSize);e.distanceTo(t)<3*i.x?this.hide():this.show()},show:function(){this.setOpacity(this._opacity)},hide:function(){this.setOpacity(0)},updateLatLng:function(){this.setLatLng(this.computeLatLng()),this.setVisibility()},computeLatLng:function(){var e=this.editor.map.latLngToContainerPoint(this.left.latlng),t=this.editor.map.latLngToContainerPoint(this.right.latlng),i=(e.y+t.y)/2,n=(e.x+t.x)/2;return this.editor.map.containerPointToLatLng([n,i])},onAdd:function(e){L.Marker.prototype.onAdd.call(this,e),this.on("mousedown touchstart",this.onMouseDown),e.on("zoomend",this.setVisibility,this)},onRemove:function(e){delete this.right.middleMarker,this.off("mousedown touchstart",this.onMouseDown),e.off("zoomend",this.setVisibility,this),L.Marker.prototype.onRemove.call(this,e)},onMouseDown:function(e){this.editor.onMiddleMarkerMouseDown(e,this),this.latlngs.splice(this.index(),0,e.latlng),this.editor.refresh();var t=this.editor.addVertexMarker(e.latlng,this.latlngs);t.dragging._draggable._onDown(e.originalEvent),this["delete"]()},"delete":function(){this.editor.editLayer.removeLayer(this)},index:function(){return this.latlngs.indexOf(this.right.latlng)},_initInteraction:function(){L.Marker.prototype._initInteraction.call(this),L.DomEvent.on(this._icon,"touchstart",function(e){this._fireMouseEvent(e)},this)}}),L.Editable.mergeOptions({middleMarkerClass:L.Editable.MiddleMarker}),L.Editable.BaseEditor=L.Class.extend({_clazzName:"L.Editable.BaseEditor",initialize:function(e,t,i){L.setOptions(this,i),this.map=e,this.feature=t,this.feature.editor=this,this.editLayer=new L.LayerGroup,this.tools=this.options.editTools||e.editTools},enable:function(){return this._enabled?this:(this.tools.editLayer.addLayer(this.editLayer),this.onEnable(),this._enabled=!0,this.feature.on("remove",this.disable,this),console.warn("habilitando dragging en feature ???? "),this.feature.dragging.enable(),this._getEvents&&this.feature.on(this._getEvents(),this),this)},disable:function(){return this.feature.off("remove",this.disable,this),this.editLayer.clearLayers(),this.tools.editLayer.removeLayer(this.editLayer),this.onDisable(),delete this._enabled,this.drawing&&this.cancelDrawing(),console.info("deshabilitando dragging en feature ???? "),this.feature.dragging.disable(),this},fireAndForward:function(e,t){t=t||{},t.layer=this.feature,this.feature.fire(e,t),this.feature.multi&&this.feature.multi.fire(e,t),this.tools.fireAndForward(e,t)},onEnable:function(){this.fireAndForward("editable:enable")},onDisable:function(){this.fireAndForward("editable:disable")},onEditing:function(){this.fireAndForward("editable:editing")},onStartDrawing:function(){this.fireAndForward("editable:drawing:start")},onEndDrawing:function(){this.fireAndForward("editable:drawing:end")},onCancelDrawing:function(){this.fireAndForward("editable:drawing:cancel")},onCommitDrawing:function(){this.fireAndForward("editable:drawing:commit")},startDrawing:function(){this.drawing||(this.drawing=L.Editable.FORWARD),this.tools.registerForDrawing(this),this.onStartDrawing()},commitDrawing:function(){this.onCommitDrawing(),this.endDrawing()},cancelDrawing:function(){this.onCancelDrawing(),this.endDrawing()},endDrawing:function(){this.drawing=!1,this.tools.unregisterForDrawing(this),this.onEndDrawing()},onMouseMove:function(e){this.drawing&&this.tools.newClickHandler.setLatLng(e.latlng)},onTouch:function(e){this.onMouseMove(e),this.drawing&&this.tools.newClickHandler._fireMouseEvent(e)},onNewClickHandlerClicked:function(e){this.fireAndForward("editable:drawing:click",e)},isNewClickValid:function(e){return!0}}),L.Editable.MarkerEditor=L.Editable.BaseEditor.extend({_clazzName:"L.Editable.MarkerEditor",enable:function(){return this._enabled?this:(L.Editable.BaseEditor.prototype.enable.call(this),this.feature.dragging.enable(),this.feature.on("dragstart",this.onEditing,this),this)},disable:function(){return L.Editable.BaseEditor.prototype.disable.call(this),this.feature.dragging.disable(),this.feature.off("dragstart",this.onEditing,this),this},onMouseMove:function(e){this.drawing&&(L.Editable.BaseEditor.prototype.onMouseMove.call(this,e),this.feature.setLatLng(e.latlng),this.tools.newClickHandler._bringToFront())},onNewClickHandlerClicked:function(e){this.isNewClickValid(e.latlng)&&(L.Editable.BaseEditor.prototype.onNewClickHandlerClicked.call(this,e),this.commitDrawing())}}),L.Editable.PathEditor=L.Editable.BaseEditor.extend({_clazzName:"L.Editable.PathEditor",CLOSED:!1,MIN_VERTEX:2,enable:function(){return this._enabled?this:(L.Editable.BaseEditor.prototype.enable.call(this),this.feature&&this.initVertexMarkers(),this)},disable:function(){return L.Editable.BaseEditor.prototype.disable.call(this)},initVertexMarkers:function(){for(var e=this.getLatLngsGroups(),t=0;t<e.length;t++)this.addVertexMarkers(e[t])},getLatLngsGroups:function(){return[this.getLatLngs()]},getLatLngs:function(){return this.feature.getLatLngs()},reset:function(){this.editLayer.clearLayers(),this.initVertexMarkers()},addVertexMarker:function(e,t){return new this.tools.options.vertexMarkerClass(e,t,this)},addVertexMarkers:function(e){for(var t=0;t<e.length;t++)this.addVertexMarker(e[t],e)},addMiddleMarker:function(e,t,i){return new this.tools.options.middleMarkerClass(e,t,i,this)},onVertexMarkerClick:function(e){var t=e.vertex.getIndex();e.originalEvent.ctrlKey?this.onVertexMarkerCtrlClick(e):e.originalEvent.altKey?this.onVertexMarkerAltClick(e):e.originalEvent.shiftKey?this.onVertexMarkerShiftClick(e):t>=this.MIN_VERTEX-1&&t===e.vertex.getLastIndex()&&this.drawing===L.Editable.FORWARD?this.commitDrawing():0===t&&this.drawing===L.Editable.BACKWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX?this.commitDrawing():0===t&&this.drawing===L.Editable.FORWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX&&this.CLOSED?this.commitDrawing():this.onVertexRawMarkerClick(e)},onVertexRawMarkerClick:function(e){this.vertexCanBeDeleted(e.vertex)&&(e.vertex["delete"](),this.refresh())},vertexCanBeDeleted:function(e){return e.latlngs.length>this.MIN_VERTEX},onVertexDeleted:function(e){this.fireAndForward("editable:vertex:deleted",e)},onVertexMarkerCtrlClick:function(e){this.fireAndForward("editable:vertex:ctrlclick",e)},onVertexMarkerShiftClick:function(e){
this.fireAndForward("editable:vertex:shiftclick",e)},onVertexMarkerAltClick:function(e){this.fireAndForward("editable:vertex:altclick",e)},onVertexMarkerContextMenu:function(e){this.fireAndForward("editable:vertex:contextmenu",e)},onVertexMarkerMouseDown:function(e){this.fireAndForward("editable:vertex:mousedown",e)},onMiddleMarkerMouseDown:function(e){this.fireAndForward("editable:middlemarker:mousedown",e)},onVertexMarkerDrag:function(e){this.fireAndForward("editable:vertex:drag",e)},onVertexMarkerDragStart:function(e){this.fireAndForward("editable:vertex:dragstart",e)},onVertexMarkerDragEnd:function(e){this.fireAndForward("editable:vertex:dragend",e)},startDrawing:function(){this._drawnLatLngs||(this._drawnLatLngs=this.getLatLngs()),L.Editable.BaseEditor.prototype.startDrawing.call(this)},startDrawingForward:function(){this.startDrawing(),this.tools.attachForwardLineGuide()},endDrawing:function(){L.Editable.BaseEditor.prototype.endDrawing.call(this),this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),delete this._drawnLatLngs},addLatLng:function(e){this.drawing===L.Editable.FORWARD?this._drawnLatLngs.push(e):this._drawnLatLngs.unshift(e),this.refresh(),this.addVertexMarker(e,this._drawnLatLngs)},newPointForward:function(e){this.addLatLng(e),this.tools.anchorForwardLineGuide(e),this.tools.backwardLineGuide._latlngs[0]||this.tools.anchorBackwardLineGuide(e)},newPointBackward:function(e){this.addLatLng(e),this.tools.anchorBackwardLineGuide(e)},onNewClickHandlerClicked:function(e){this.isNewClickValid(e.latlng)&&(this.drawing===L.Editable.FORWARD?this.newPointForward(e.latlng):this.newPointBackward(e.latlng),L.Editable.BaseEditor.prototype.onNewClickHandlerClicked.call(this,e))},onMouseMove:function(e){this.drawing&&(L.Editable.BaseEditor.prototype.onMouseMove.call(this,e),this.tools.moveForwardLineGuide(e.latlng),this.tools.moveBackwardLineGuide(e.latlng))},refresh:function(){this.feature.redraw(),this.onEditing()},onMove:function(e){this.fireAndForward("editable:drawing:move",e)},_getEvents:function(){return{dragstart:this.onDragStart,drag:this.onDrag,dragend:this.onDragEnd,remove:this.disable}},onDragStart:function(e){this.onEditing(),this.editLayer.clearLayers(),this.fireAndForward("editable:dragstart",e)},onDrag:function(e){this.onMove(e),this.fireAndForward("editable:drag",e)},onDragEnd:function(e){this.initVertexMarkers(),this.fireAndForward("editable:dragend",e)}}),L.Editable.PolylineEditor=L.Editable.PathEditor.extend({_clazzName:"L.Editable.PolylineEditor",startDrawingBackward:function(){this.drawing=L.Editable.BACKWARD,this.startDrawing(),this.tools.attachBackwardLineGuide()},continueBackward:function(){this.tools.anchorBackwardLineGuide(this.getFirstLatLng()),this.startDrawingBackward()},continueForward:function(){this.tools.anchorForwardLineGuide(this.getLastLatLng()),this.startDrawingForward()},getLastLatLng:function(){return this.getLatLngs()[this.getLatLngs().length-1]},getFirstLatLng:function(){return this.getLatLngs()[0]}}),L.Editable.PolygonEditor=L.Editable.PathEditor.extend({_clazzName:"L.Editable.PolygonEditor",CLOSED:!0,MIN_VERTEX:3,getLatLngsGroups:function(){var e=L.Editable.PathEditor.prototype.getLatLngsGroups.call(this);if(this.feature._holes)for(var t=0;t<this.feature._holes.length;t++)e.push(this.feature._holes[t]);return e},startDrawingForward:function(){L.Editable.PathEditor.prototype.startDrawingForward.call(this),this.tools.attachBackwardLineGuide()},addNewEmptyHole:function(){var e=Array();return this.feature._holes||(this.feature._holes=[]),this.feature._holes.push(e),e},newHole:function(e){this._drawnLatLngs=this.addNewEmptyHole(),this.startDrawingForward(),e&&this.newPointForward(e)},checkContains:function(e){return this.feature._containsPoint(this.map.latLngToLayerPoint(e))},vertexCanBeDeleted:function(e){return e.latlngs!==this.getLatLngs()||L.Editable.PathEditor.prototype.vertexCanBeDeleted.call(this,e)},isNewClickValid:function(e){return this._drawnLatLngs===this.getLatLngs()||this.checkContains(e)},onVertexDeleted:function(e){L.Editable.PathEditor.prototype.onVertexDeleted.call(this,e),e.vertex.latlngs.length||e.vertex.latlngs===this.getLatLngs()||this.feature._holes.splice(this.feature._holes.indexOf(e.vertex.latlngs),1)}}),L.Map.mergeOptions({polylineEditorClass:L.Editable.PolylineEditor}),L.Map.mergeOptions({polygonEditorClass:L.Editable.PolygonEditor}),L.Map.mergeOptions({markerEditorClass:L.Editable.MarkerEditor});var M={createEditor:function(e){e=e||this._map;var t=this.options.editorClass||this.getEditorClass(e);return new t(e,this,this.options.editOptions)},enableEdit:function(){return console.warn("enabling edition ... "),this.editor||this.createEditor(),this.multi&&this.multi.onEditEnabled(),this.editor.enable()},editEnabled:function(){return this.editor&&this.editor._enabled},disableEdit:function(){this.editor&&(this.multi&&this.multi.onEditDisabled(),this.editor.disable(),delete this.editor)},toggleEdit:function(){this.editEnabled()?this.disableEdit():this.enableEdit()}};L.Polyline.include(M),L.Polygon.include(M),L.Marker.include(M),L.Polyline.include({_containsPoint:function(e,t){var i,n,a,o,r,s,l,c=this.options.weight/2;for(L.Browser.touch&&(c+=10),i=0,o=this._parts.length;i<o;i++)for(l=this._parts[i],n=0,r=l.length,a=r-1;n<r;a=n++)if((t||0!==n)&&(s=L.LineUtil.pointToSegmentDistance(e,l[a],l[n]),s<=c))return!0;return!1},getEditorClass:function(e){return e.options.polylineEditorClass}}),L.Polygon.include({_containsPoint:function(e){var t,i,n,a,o,r,s,l,c=!1;if(L.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(a=0,s=this._parts.length;a<s;a++)for(t=this._parts[a],o=0,l=t.length,r=l-1;o<l;r=o++)i=t[o],n=t[r],i.y>e.y!=n.y>e.y&&e.x<(n.x-i.x)*(e.y-i.y)/(n.y-i.y)+i.x&&(c=!c);return c},getEditorClass:function(e){return e.options.polygonEditorClass}}),L.Marker.include({getEditorClass:function(e){return e.options.markerEditorClass}});var C={enableEdit:function(){this.eachLayer(function(e){e.multi=this,e.enableEdit()},this)},disableEdit:function(){this.eachLayer(function(e){e.disableEdit()})},toggleEdit:function(e){e.layer.editor?this.disableEdit():this.enableEdit(e)},onEditEnabled:function(){this._editEnabled||(this._editEnabled=!0,this.fire("editable:multi:edit:enabled"))},onEditDisabled:function(){this._editEnabled&&(this._editEnabled=!1,this.fire("editable:multi:edit:disabled"))},editEnabled:function(){return!!this._editEnabled}};L.MultiPolygon.include(C),L.MultiPolyline.include(C),function(){function t(){var e=document.createElement("style");e.type="text/css",e.innerHTML=".leaflet-control-easyPrint a {background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMiA1MTI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPGc+Cgk8cGF0aCBkPSJNMTI4LDMyaDI1NnY2NEgxMjhWMzJ6IE00ODAsMTI4SDMyYy0xNy42LDAtMzIsMTQuNC0zMiwzMnYxNjBjMCwxNy42LDE0LjM5OCwzMiwzMiwzMmg5NnYxMjhoMjU2VjM1Mmg5NiAgIGMxNy42LDAsMzItMTQuNCwzMi0zMlYxNjBDNTEyLDE0Mi40LDQ5Ny42LDEyOCw0ODAsMTI4eiBNMzUyLDQ0OEgxNjBWMjg4aDE5MlY0NDh6IE00ODcuMTk5LDE3NmMwLDEyLjgxMy0xMC4zODcsMjMuMi0yMy4xOTcsMjMuMiAgIGMtMTIuODEyLDAtMjMuMjAxLTEwLjM4Ny0yMy4yMDEtMjMuMnMxMC4zODktMjMuMiwyMy4xOTktMjMuMkM0NzYuODE0LDE1Mi44LDQ4Ny4xOTksMTYzLjE4Nyw0ODcuMTk5LDE3NnoiIGZpbGw9IiMwMDAwMDAiLz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K);background-size:16px 16px;cursor: pointer;}._epHidden{display:none!important;}@media print {html {padding: 0px!important;}.leaflet-control-easyPrint-button{display: none!important;}}",document.body.appendChild(e)}if(!e.L)throw new Error("EasyPrint needs Leaflet");L.Control.EasyPrint=L.Control.extend({options:{title:"Print map",position:"topleft"},printPage:function(){var t;if(this.options.elementsToHide){t=document.querySelectorAll(this.options.elementsToHide);for(var i=0;i<t.length;i++)t[i].className=t[i].className+" _epHidden"}if(this._map.fire("beforePrint"),e.print(),this._map.fire("afterPrint"),this.options.elementsToHide){t=document.querySelectorAll(this.options.elementsToHide);for(var n=0;n<t.length;n++)t[n].className=t[n].className.replace(" _epHidden","")}},onAdd:function(){var e=L.DomUtil.create("div","leaflet-control-easyPrint leaflet-bar leaflet-control");return this.link=L.DomUtil.create("a","leaflet-control-easyPrint-button leaflet-bar-part",e),this.link.id="leafletEasyPrint",this.link.title=this.options.title,L.DomEvent.addListener(this.link,"click",this.printPage,this),L.DomEvent.disableClickPropagation(e),e}}),L.easyPrint=function(e){return t(),new L.Control.EasyPrint(e)}}(),L.PathDraggable=L.Draggable.extend({initialize:function(e){this._path=e,this._canvas=e._map.getRenderer&&e._map.getRenderer(e)instanceof L.Canvas;var t=this._canvas?this._path._map.getRenderer(this._path)._container:this._path._path;L.Draggable.prototype.initialize.call(this,t,t,!0)},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("drag",e)},_onDown:function(e){var t=e.touches?e.touches[0]:e;this._startPoint=new L.Point(t.clientX,t.clientY),this._canvas&&!this._path._containsPoint(this._path._map.mouseEventToLayerPoint(t))||L.Draggable.prototype._onDown.call(this,e)}}),L.Handler.PathDrag=L.Handler.extend({initialize:function(e){this._path=e},getEvents:function(){return{dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd}},addHooks:function(){this._draggable||(this._draggable=new L.PathDraggable(this._path)),this._draggable.on(this.getEvents(),this).enable(),L.DomUtil.addClass(this._draggable._element,"leaflet-path-draggable")},removeHooks:function(){this._draggable.off(this.getEvents(),this).disable(),L.DomUtil.removeClass(this._draggable._element,"leaflet-path-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._startPoint=this._draggable._startPoint,this._path.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(e){var t=this._path,i=e.originalEvent.touches&&1===e.originalEvent.touches.length?e.originalEvent.touches[0]:e.originalEvent,n=L.point(i.clientX,i.clientY),a=t._map.layerPointToLatLng(n);this._offset=n.subtract(this._startPoint),this._startPoint=n,this._path.eachLatLng(this.updateLatLng,this),t.redraw(),e.latlng=a,e.offset=this._offset,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){this._path._bounds&&this.resetBounds(),this._path.fire("moveend").fire("dragend",e)},latLngToLayerPoint:function(e){var t=this._path._map.project(L.latLng(e));return t._subtract(this._path._map.getPixelOrigin())},updateLatLng:function(e){var t=this.latLngToLayerPoint(e);t._add(this._offset);var i=this._path._map.layerPointToLatLng(t);e.lat=i.lat,e.lng=i.lng},resetBounds:function(){this._path._bounds=new L.LatLngBounds,this._path.eachLatLng(function(e){this._bounds.extend(e)})}}),L.Path.include({eachLatLng:function(e,t){t=t||this;var i=function(n){for(var a=0;a<n.length;a++)L.Util.isArray(n[a])?i(n[a]):e.call(t,n[a])};i(this.getLatLngs?this.getLatLngs():[this.getLatLng()])}}),L.Path.addInitHook(function(){this.dragging=new L.Handler.PathDrag(this),this.options.draggable&&this.once("add",function(){this.dragging.enable()})}),function(){function e(e,t,i){var n=new XMLHttpRequest;n.open("GET",e),n.onload=function(){if(n.status>=200&&n.status<300){var a=n.response;"{"===a[0]?t(a):i("Invalid json. Expected start with '{'. Response start with: "+a.substring(0,20))}else i("Invalid request for "+e,n.statusText)},n.onerror=function(){i(n.statusText)},n.send(null)}if(L.Map){var t="",i="";L.TileLayer.DEFAULT_LS_KEY="currentlocaltiles",L.TileLayer.LOCAL_MAX_VIEW_ZOOM=16;var n=L.TileLayer.prototype.initialize;L.TileLayer.prototype.initialize=function(){n.apply(this,arguments);var e=arguments[0]||"__",t=e.split("_"),i=t[1];if("$local"===i&&(this.options.maxNativeZoom=L.TileLayer.LOCAL_MAX_VIEW_ZOOM,this.options.minZoom=4,this._isLocalLayer=!0,!this._localTiles)){var a=t[2]||L.TileLayer.DEFAULT_LS_KEY,o=localStorage.getItem(a);if(this._isUsingLocalTiles=!0,o)console.info("Detected offline layer from localStorage: "+a),this.changeTileDataFromJson(o);else{console.info("Detected offline layer: "+a);var r="./sampledata/tiles-"+a+".json";this.changeTileDataFromUrl(r)}}this._url&&this._url.indexOf("172.")>0&&this._url.indexOf("smara/")&&(this._defaultView={zoom:16,center:{lat:26.742,lng:-11.7006}})},L.Control.Layers.include({setLocalTilesFromLocalstorage:function(e){var t=localStorage.getItem(e);t&&this._localLayer&&(this._localLayer.changeTileDataFromJson(t),this._map.update())},setLocalTilesFromUrl:function(e){e&&this._localLayer&&(this._localLayer.changeTileDataFromUrl(e),this._map.update())}}),L.TileLayer.prototype.changeTileDataFromUrl=function(t){if(!this._isLocalLayer)throw"This layer is not a Local TileLayer";var i=this;e(t,function(e){try{var n=i._localTiles=JSON.parse(e),a=0;for(var o in n)a+=o.indexOf("/")>0?1:0;console.info("Loaded tiles offline: "+t+"\n Tile count:"+a+"\n Map View: ",n.mapview)}catch(r){console.info("Fail parsing json file container of tiles: "+t+"\n",r)}},function(e){console.info("Fail response. "+t,e)})},L.TileLayer.prototype.changeTileDataFromJson=function(e){try{var t=this._localTiles=JSON.parse(e),i=0;for(var n in t)i+=n.indexOf("/")>0?1:0;console.info("Loaded tiles offline from localstorage\n Tile count:"+i+"\n Map View: ",t.mapview)}catch(a){console.info("Fail parsing json content \n",a)}},L.TileLayer.prototype.getHomeInfo=function(){return this._isUsingLocalTiles?this._localTiles&&this._localTiles.mapview||{}:this._defaultView||{}};var a=L.TileLayer.prototype.getTileUrl;L.TileLayer.prototype.getTileUrl=function(e){if(!this._isUsingLocalTiles)return this._url||(this._url="//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),a.apply(this,arguments);var n=L.Util.template(this._url,L.extend({s:this._getSubdomain(e),z:e.z,x:e.x,y:e.y},this.options)),o=n.split("_")[3];if(o){o=o.split(".")[0];var r=this._localTiles&&(this._localTiles[o]||i)||t;return r}},L.TileLayer.getJson=e}}(),function(){function t(e,t){function i(e,t,i){var n="data:image/"+t+";base64,",a=new Blob([e],{type:"application/octet-binary"}),o=new FileReader;o.onload=function(e){var t=e.target.result.split(",");if(t[0].startsWith("data")){var a=n+t[1];i(a)}else console.error("interval error: invalid data as base64")},o.readAsDataURL(a)}this.key=e,this.url=t,this.data=null,this.load=function(e,n){var a=this,o=this.url.split("."),r=1===o.length?"png":o[o.length-1],s=new XMLHttpRequest;s.responseType="arraybuffer",s.open("GET",t),s.onload=function(){s.status>=200&&s.status<300?i(s.response,r,function(t){a.data=t,e(a)}):n("not found "+t,s.statusText)},s.onerror=function(){n(s.statusText)},s.send(null)}}function i(t){var i=t&&t._map;if(!i)return void console.error("Error interno. Falta referencia a mapa en Control LocalTileControl");var a=i.getZoom();if(a<o)return void alert("Zoom demasiado lejano: "+a+"\nAl menos debe ser "+o);var r=6,s=17,l=n(r,s,i),c=e.confirm("WARN: Current stored tiles will be deleted. \nThen, it will be loaded "+l._tileInfos.length+" tiles replacing old tiles for offset navigation","Offline tile replacement");if(c!==!1){var d=prompt("Enter 'new' word of a name for searching in public/sampledata/files-NAME.json \n (salonica25, smara, smara-topo)","new");if(d){if("new"===d){t.disable();var u=l._tileInfos,p=L.TileLayer.DEFAULT_LS_KEY;l.startLoading({},function(){t.setProgressText("OK: "+l._tileInfos.length+" tiles");var e=l.tileSetToJson();console.info("Json tileSet have a size in bytes of "+e.length);var i=localStorage.getItem(p);try{localStorage.removeItem(p),localStorage.setItem(p,e),alert("local tiles downloaded: "+u.length),t._refresDefaultLocalLayer(e),console.info("local base layer refreshed")}catch(n){i&&localStorage.setItem(p,i),alert("Error saving tileSet in localstorage\n\n"+n.message);try{var a=new Blob([e],{type:"text/JSON"});L.Util.saveAs(a,p+".json"),alert("WARN. json has been downloaded in local folder")}catch(o){alert("Error saving tileSet in local folder\n\n"+o.message)}}t.enable()},function(e,i,n){var a=n-e;t.setProgressText("Left "+a)})}else{var m="./sampledata/tiles-"+d+".json";console.info("Probando cargar tiles desde "+m);var h=i._mainLayerControl._localLayer;h&&h.changeTileDataFromUrl(m)}console.error("AVISO. Sin implementar reseteado de tiles para navegaci√≥n offline")}}}function n(e,t,i){if(!i._mainLayerControl)return void console.error("Invalid leaflet. No mainLayercontrol found");if(!i._mainLayerControl._localLayer)return void console.error("Invalid leaflet. No locallayer defined");var n=i._mainLayerControl._localLayer,o=a(i),r=((new Date).getMilliseconds(),new L.LocalTileSet(n,o));return r.updateTileRange(e,t,i),r}function a(e){var t=null;for(var i in e._layers){var n=e._layers[i];n instanceof L.TileLayer&&null===t&&(t=n)}return t}if(L.Map){var o=12;L.LocalTileSet=L.Class.extend({options:{},_refTileLayer:null,_localTileLayer:null,_zoom:null,_center:null,_tileInfos:[],tileSetToJson:function(){var e=this._center.lat||this._center[1]||0,t=this._center.lng||0|this._center[0],i={};i.mapview={zoom:this._zoom,center:{lat:e,lng:t}};for(var n=0;n<this._tileInfos.length;n+=1){var a=this._tileInfos[n];i[a.key]=a.data}return JSON.stringify(i,null,2)},initialize:function(e,t){if(this._localTileLayer=e,!(t instanceof L.TileLayer))throw"argument exception: it is needed a TileLayer";this._refTileLayer=t},updateTileRange:function(e,t,i){this._center=i.getCenter(),this._zoom=i.getZoom(),this._tileInfos=[];for(var n=i.getBounds(),a=e;a<=t;a+=1){var o=this.getPixelBounds(i,a,n),r=this._refTileLayer._getTileSize(),s=L.bounds(o.min.divideBy(r)._floor(),o.max.divideBy(r)._floor()),l=this._getTileInfosFrom(s,a);this._tileInfos=this._tileInfos.concat(l)}},_getTileInfosFrom:function(e,i){var n,a,o,r=[],s=e.getCenter();for(n=e.min.y;n<=e.max.y;n++)for(a=e.min.x;a<=e.max.x;a++)o=new L.Point(a,n),r.push(o);var l=r.length;if(console.info("Descarga desde zoom: "+i+", cantidad: "+l),0===l)return[];r.sort(function(e,t){return e.distanceTo(s)-t.distanceTo(s)});var c=[];for(a=0;a<l;a++){var d=r[a];d.z=i;var u=d.z+"/"+d.x+"/"+d.y,p=this._refTileLayer.getTileUrl(d);this._tileInfos.push(new t(u,p)),console.info("* Tile desde: "+p)}return c},startLoading:function(e,t,i){function n(){s-=1,s<=0&&t()}function a(){this.success=function(){i(l+1,c,r),l+=1,n()},this.reject=function(){n()}}for(var o=this._tileInfos,r=o.length,s=r,l=0,c=0,d=new a,u=0;u<r;u+=1){var p=o[u];p.load(d.success,d.reject)}console.info("Downloading started for bb centered in "+this.center)},getPixelBounds:function(e,t,i){var n=(e.options.crs.latLngToPoint(i.getSouthWest(),t),this.project(e,t,i.getSouthWest())),a=this.project(e,t,i.getNorthEast());return new L.Bounds(n,a)},project:function(e,t,i){return e.options.crs.latLngToPoint(L.latLng(i),t)},getTileCount:function(){this._tileInfos.length},_0:""}),L.Control.LocalTileControl=L.Control.extend({options:{title:"Reset Local base tile layer",position:"topright"},onAdd:function(){var e=L.DomUtil.create("div","leaflet-control-localtiles leaflet-bar leaflet-control");e.style.position="relative";var t=this;return this.progressLabel=L.DomUtil.create("div","leaflet-control-localtiles-progress leaflet-bar-part",e),this.progressLabel.style.position="absolute",this.progressLabel.style.display="none",this.progressLabel.style.right="36px",this.progressLabel.style.left="auto",this.progressLabel.style.width="70px",this.progressLabel.style.textAlign="center",this.progressLabel.style["float"]="left",this.progressLabel.style.backgroundColor="#e0e0e0",this.progressLabel.style.color="#ff7040",this.link=L.DomUtil.create("a","leaflet-control-localtiles-button leaflet-bar-part",e),this.link.title=this.options.title,L.DomEvent.addListener(this.link,"click",function(){i(t)},this),L.DomEvent.disableClickPropagation(e),e},disable:function(){this.link.classList.add("leaflet-disabled"),this.progressLabel.style.display="block",this.progressLabel.innerHTML="downloading..."},enable:function(){this.link.classList.remove("leaflet-disabled"),this.progressLabel.style.display="none"},setProgressText:function(e){this.progressLabel.innerHTML=e},resetTiles:function(){i.apply(this,arguments)},_refresDefaultLocalLayer:function(e){var t=this._map._mainLayerControl;if(!t)return void console.error("this map is not a UX map. Not found mainLayerControl");var i=this._map._mainLayerControl._localLayer;i&&(i.changeTileDataFromJson(e),this._map.setZoom(this._map.getZoom()))}}),L.LocalTileSet.MIN_DOWNLOAD_ZOOM=o,L.Control.LocalTileControl.recalculateTileset=n,L.Map.mergeOptions({localtiles:!1}),L.Map.addInitHook(function(){if(this.options.localtiles){var e="localtiles",t="string"==typeof this.options.localtiles?this.options.localtiles:this.options.localtiles.urlName||e;this.positionControl=new L.Control.LocalTileControl({keyname:t}),this.addControl(this.positionControl)}})}}(),L.Map.mergeOptions({zooms:t}),L.Map.include({_limitZoom:function(e){var t,i=this.options.zooms;if(i&&"length"in i&&i.length){var n,a,o,r=100,s=-1,l=100,c=e-this._zoom;for(t=L.Browser.any3d?this.options.zoomSnap:1,t&&(e=Math.round(e/t)*t),a=0;a<i.length;a++)o=Math.abs(i[a]-e),o<r&&(n=i[a],r=o),c*(i[a]-this._zoom)>0&&o<l&&(s=i[a],l=o);return s<0?n:s}var d=this.getMinZoom(),u=this.getMaxZoom();return t=L.Browser.any3d?this.options.zoomSnap:1,t&&(e=Math.round(e/t)*t),Math.max(d,Math.min(u,e))}}),L.Evented=L.Class.extend({on:function(e,t,i){if("object"==typeof e)for(var n in e)this._on(n,e[n],t);else{e=L.Util.splitWords(e);for(var a=0,o=e.length;a<o;a++)this._on(e[a],t,i)}return this},off:function(e,t,i){if(e)if("object"==typeof e)for(var n in e)this._off(n,e[n],t);else{e=L.Util.splitWords(e);for(var a=0,o=e.length;a<o;a++)this._off(e[a],t,i)}else delete this._events;return this},_on:function(e,i,n){this._events=this._events||{};var a=this._events[e];a||(a=[],this._events[e]=a),n===this&&(n=t);for(var o={fn:i,ctx:n},r=a,s=0,l=r.length;s<l;s++)if(r[s].fn===i&&r[s].ctx===n)return;r.push(o)},_off:function(e,i,n){var a,o,r;if(this._events&&(a=this._events[e])){if(!i){for(o=0,r=a.length;o<r;o++)a[o].fn=L.Util.falseFn;return void delete this._events[e]}if(n===this&&(n=t),a)for(o=0,r=a.length;o<r;o++){var s=a[o];if(s.ctx===n&&s.fn===i)return s.fn=L.Util.falseFn,this._firingCount&&(this._events[e]=a=a.slice()),void a.splice(o,1)}}},fire:function(e,t,i){if(!this.listens(e,i))return this;var n=L.Util.extend({},t,{type:e,target:this});if(this._events){var a=this._events[e];if(a){this._firingCount=this._firingCount+1||1;for(var o=0,r=a.length;o<r;o++){var s=a[o];s.fn.call(s.ctx||this,n)}this._firingCount--}}return i&&this._propagateEvent(n),this},listens:function(e,t){var i=this._events&&this._events[e];if(i&&i.length)return!0;if(t)for(var n in this._eventParents)if(this._eventParents[n].listens(e,t))return!0;return!1},once:function(e,t,i){if("object"==typeof e){for(var n in e)this.once(n,e[n],t);return this}var a=L.bind(function(){this.off(e,t,i).off(e,a,i)},this);return this.on(e,t,i).on(e,a,i)},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[L.stamp(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[L.stamp(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,L.extend({layer:e.target},e),!0)}});var w=L.Evented.prototype;w.addEventListener=w.on,w.removeEventListener=w.clearAllEventListeners=w.off,w.addOneTimeEventListener=w.once,w.fireEvent=w.fire,w.hasEventListeners=w.listens,L.Mixin={Events:w},function(){return L.Control?(L.Editable.VertexIcon.prototype.options.iconSize=new L.Point(14,14),L.Control.UxEdition=L.Control.extend({options:{position:"topleft",addPolygonText:"",addPolylineText:"",addMarkerText:"",deleteGeomText:"",onFeatureCommited:null,cssClass:""},onAdd:function(e){var t=L.DomUtil.create("div","leaflet-control leaflet-bar"),i=[L.NewPolygonControl,L.DeleteGeomControl];this._buttons=[];for(var n=0;n<i.length;n++){var a=i[n],o=new a;o.onFeatureCommitedListener=this.options.onFeatureCommited,this._buttons.push(o),t.appendChild(o._createLink(e))}return t},setLayer:function(e){for(var t=0;t<this._buttons.length;t++)this._buttons[t].layerGroup=e;for(var i in e){var n=e[i];n.enableEdit&&(n.enableEdit(),n.on("dblclick",L.DomEvent.stop).on("dblclick",this.toggleEdit))}}}),L.BaseEditControl=L.Control.extend({options:{position:"topleft",title:"Edit control",innerText:"o"},_commitedAction:"added",layerGroup:t,onAdd:function(e){this._map=e;var t=L.DomUtil.create("div","leaflet-control leaflet-bar"),i=this._createLink(e);return t.appendChild(i),t},isActive:function(){return this._link&&this._link.classList.contains("active")},setActive:function(t){if(t){this._link.setAttribute("title",this.options.cancelTitle),this._link.classList.add("active");var i=e.getComputedStyle(this._link).color;this._link.style.backgroundColor=i,this._link.style.color="#ffffff"}else this._link.setAttribute("title",this.options.title),this._link.classList.remove("active"),this._link.style.backgroundColor="",this._link.style.color=""},_createLink:function(e){var t=L.DomUtil.create("a",this.options.cssClass||"");t.href="#",t.title=this.options.title,t.innerHTML=this.options.innerText,this._link=t;var i=this;return L.DomEvent.on(t,"click",L.DomEvent.stop).on(t,"click",function(){var t=i._onClick(e),n=t&&t._leaflet_id;n&&(i.layerGroup[n]=t)}),this._link=t,t},_onClick:null,_toggle:function(){var e=!this.isActive();return this.setActive(e),console.debug("starting tool from: "+this.options.title),e},_featureCommitted:function(e){e.action=this._commitedAction,console.info("feature commited ",e),this.onFeatureCommitedListener&&this.onFeatureCommitedListener(e)},onFeatureCommitedListener:null,_featureCanceled:function(e){var t=e._leaflet_id;if(!e._deleting){e._deleting=!0;var i=e._map;i.removeLayer(e),i._onResize(),delete this.layerGroup[t]}}}),L.DeleteGeomControl=L.BaseEditControl.extend({options:{title:"Delete geometries",cancelTitle:"Stop deletiing",innerText:"Ôá∏",cssClass:"delete-edit-control"},_commitedAction:"deleted",_onClick:function(e){var t=this._toggle();for(var i in this.layerGroup){var n=this.layerGroup[i];t?this._addOnclick(n):this._removeOnclick(n)}},_addOnclick:function(e){if(e.editor){var i=this;e.on("click",L.DomEvent.stop).on("click",function(){var e=this._leaflet_id;if(e!==t){var n=this._map;n.removeLayer(this),n._onResize(),delete i.layerGroup[e],i._featureCommitted({layer:this}),console.debug("deleted feature "+e)}else console.warn("clicked object is not a leaflet layer: "+this)},e)}},_removeOnclick:function(e){e.editor&&e.off("click",L.DomEvent.stop).off("click")}}),L.NewLineControl=L.BaseEditControl.extend({options:{title:"Create a new line",cancelTitle:"Cancel line",innerText:"\\/\\",cssClass:"newline-edit-control"},_onClick:function(e){this._toggle();return e.editTools.startPolyline()}}),L.NewPolygonControl=L.BaseEditControl.extend({options:{title:"Create a new polygon",cancelTitle:"Cancel polygon",innerText:"‚ñ∞",cssClass:"newpolygon-edit-control"},_onClick:function(e){var t=this._toggle();if(t){var i=e.editTools.startPolygon();return i.on("editable:drawing:commit",this._featureCommitted,this),i.on("editable:drawing:commit",function(e){this.setActive(!1)},this),i.on("editable:drawing:cancel",function(e){this.setActive(!1),this._featureCanceled(i)},this),i}e.editTools.stopDrawing()}}),void(L.NewMarkerControl=L.BaseEditControl.extend({options:{title:"Add a new marker",cancelTitle:"Cancel marker",innerText:"üñà",cssClass:"newmarker-edit-control"},_onClick:function(e){this._toggle();return e.editTools.startMarker()}}))):void console.error("L.Control.Edition requires Leaflet")}(),L.Class.prototype.toString=function(){return"Class: "+this._clazzName},L.Map.prototype._clazzName="Map",L.Polygon.prototype._clazzName="Polygon",L.Polygon.prototype.toString=function(){return L.Polyline.prototype.toString.call(this)+" "+JSON.stringify(this._latlng)},L.Circle.prototype._clazzName="Circle",L.Point.prototype._clazzName="Point",L.Path.prototype._clazzName="Path",L.Marker.prototype._clazzName="Marker",L.Polyline.prototype._clazzName="Polyline",L.Browser.svg?L.Path.include({_resetTransform:function(){this._container.setAttributeNS(null,"transform","")},_applyTransform:function(e){this._container.setAttributeNS(null,"transform","matrix("+e.join(" ")+")")}}):L.Path.include({_resetTransform:function(){this._skew&&(this._skew.on=!1,this._container.removeChild(this._skew),this._skew=null)},_applyTransform:function(e){var t=this._skew;t||(t=this._createElement("skew"),this._container.appendChild(t),t.style.behavior="url(#default#VML)",this._skew=t);var i=e[0].toFixed(8)+" "+e[1].toFixed(8)+" "+e[2].toFixed(8)+" "+e[3].toFixed(8)+" 0 0",n=Math.floor(e[4]).toFixed()+", "+Math.floor(e[5]).toFixed(),a=this._container.style,o=parseFloat(a.left),r=parseFloat(a.top),s=parseFloat(a.width),l=parseFloat(a.height);isNaN(o)&&(o=0),isNaN(r)&&(r=0),!isNaN(s)&&s||(s=1),!isNaN(l)&&l||(l=1);var c=(-o/s-.5).toFixed(8)+" "+(-r/l-.5).toFixed(8);t.on="f",t.matrix=i,t.origin=c,t.offset=n,t.on=!0}}),L.Path.include({_onMouseClick:function(e){this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(e)}}),L.Handler.PathDrag=L.Handler.extend({initialize:function(e){this._path=e,this._matrix=null,this._startPoint=null,this._dragStartPoint=null},addHooks:function(){this._path.on("mousedown",this._onDragStart,this),L.DomUtil.addClass(this._path._container,"leaflet-path-draggable")},removeHooks:function(){this._path.off("mousedown",this._onDragStart,this),L.DomUtil.removeClass(this._path._container,"leaflet-path-draggable")},moved:function(){return this._path._dragMoved},_onDragStart:function(e){this._startPoint=e.containerPoint.clone(),this._dragStartPoint=e.containerPoint.clone(),this._matrix=[1,0,0,1,0,0],this._path._map.on("mousemove",this._onDrag,this).on("mouseup",this._onDragEnd,this),this._path._dragMoved=!1},_onDrag:function(e){var t=e.containerPoint.x,i=e.containerPoint.y,n=t-this._startPoint.x,a=i-this._startPoint.y;this._path._dragMoved||!n&&!a||(this._path._dragMoved=!0,this._path.fire("dragstart")),this._matrix[4]+=n,this._matrix[5]+=a,this._startPoint.x=t,this._startPoint.y=i,this._path._applyTransform(this._matrix),this._path.fire("drag"),L.DomEvent.stop(e.originalEvent)},_onDragEnd:function(e){L.DomEvent.stop(e),this._path._resetTransform(),this._transformPoints(this._matrix),this._path._map.off("mousemove",this._onDrag,this).off("mouseup",this._onDragEnd,this),this._path.fire("dragend",{distance:Math.sqrt(L.LineUtil._sqDist(this._dragStartPoint,e.containerPoint))}),this._matrix=null,this._startPoint=null,this._dragStartPoint=null},_transformPoints:function(e){var t,i,n,a=this._path,o=L.point(e[4],e[5]),r=a._map.options.crs,s=r.transformation,l=r.scale(a._map.getZoom()),c=r.projection,d=s.untransform(o,l).subtract(s.untransform(L.point(0,0),l));if(a._point)a._latlng=c.unproject(c.project(a._latlng)._add(d)),a._point._add(o);else if(a._originalPoints)for(t=0,i=a._originalPoints.length;t<i;t++)n=a._latlngs[t],a._latlngs[t]=c.unproject(c.project(n)._add(d)),a._originalPoints[t]._add(o);if(a._holes)for(t=0,i=a._holes.length;t<i;t++)for(var u=0,p=a._holes[t].length;u<p;u++)n=a._holes[t][u],a._holes[t][u]=c.unproject(c.project(n)._add(d)),a._holePoints[t][u]._add(o);a._updatePath()}}),L.Path.prototype.__initEvents=L.Path.prototype._initEvents,
L.Path.prototype._initEvents=function(){this.__initEvents(),this.options.draggable?this.dragging?this.dragging.enable():(this.dragging=new L.Handler.PathDrag(this),this.dragging.enable()):this.dragging&&this.dragging.disable()},function(){function e(e,t,i){for(var n=0,a=e.length;n<a;n++){var o=e[n];o.prototype["_"+t]=o.prototype[t],o.prototype[t]=i}}L.FeatureGroup.EVENTS+=" dragstart";var t={addLayer:function(e){return this.hasLayer(e)?this:(e.on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._addLayer.call(this,e))},removeLayer:function(e){return this.hasLayer(e)?(e.off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._removeLayer.call(this,this)):this}};e([L.MultiPolygon,L.MultiPolyline],"addLayer",t.addLayer),e([L.MultiPolygon,L.MultiPolyline],"removeLayer",t.removeLayer);var i={_onDrag:function(e){var t=e.target;this.eachLayer(function(e){e!==t&&e._applyTransform(t.dragging._matrix)}),this._propagateEvent(e)},_onDragEnd:function(e){var t=e.target;this.eachLayer(function(e){e!==t&&(e._resetTransform(),e.dragging._transformPoints(t.dragging._matrix))}),this._propagateEvent(e)}};L.MultiPolygon.include(i),L.MultiPolyline.include(i)}(),L.Polygon.include({getCenter:function(){var e,t,i,n,a,o,r,s,l,c=this._parts[0];for(r=s=l=0,e=0,i=c.length,t=i-1;e<i;t=e++)n=c[e],a=c[t],o=n.y*a.x-a.y*n.x,s+=(n.x+a.x)*o,l+=(n.y+a.y)*o,r+=3*o;return this._map.layerPointToLatLng([s/r,l/r])}}),L.EditToolbar.Edit.MOVE_MARKERS=!1,L.EditToolbar.Edit.include({initialize:function(e,t){L.EditToolbar.Edit.MOVE_MARKERS=!!t.selectedPathOptions.moveMarkers,this._initialize(e,t)},_initialize:L.EditToolbar.Edit.prototype.initialize}),L.Edit.SimpleShape.include({_updateMoveMarker:function(){this._moveMarker&&this._moveMarker.setLatLng(this._getShapeCenter())},_getShapeCenter:function(){return this._shape.getBounds().getCenter()},_createMoveMarker:function(){L.EditToolbar.Edit.MOVE_MARKERS&&(this._moveMarker=this._createMarker(this._getShapeCenter(),this.options.moveIcon))}}),L.Edit.SimpleShape.mergeOptions({moveMarker:!1}),L.Edit.Circle.include({addHooks:function(){this._shape._map&&(this._map=this._shape._map,this._markerGroup||(this._enableDragging(),this._initMarkers()),this._shape._map.addLayer(this._markerGroup))},removeHooks:function(){if(this._shape._map){for(var e=0,t=this._resizeMarkers.length;e<t;e++)this._unbindMarker(this._resizeMarkers[e]);this._disableDragging(),this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},_createMoveMarker:L.Edit.SimpleShape.prototype._createMoveMarker,_resize:function(e){var t=this._shape.getLatLng(),i=t.distanceTo(e);this._shape.setRadius(i),this._updateMoveMarker()},_enableDragging:function(){this._shape.dragging||(this._shape.dragging=new L.Handler.PathDrag(this._shape)),this._shape.dragging.enable(),this._shape.on("dragstart",this._onStartDragFeature,this).on("dragend",this._onStopDragFeature,this)},_disableDragging:function(){this._shape.dragging.disable(),this._shape.off("dragstart",this._onStartDragFeature,this).off("dragend",this._onStopDragFeature,this)},_onStartDragFeature:function(){this._shape._map.removeLayer(this._markerGroup),this._shape.fire("editstart")},_onStopDragFeature:function(){var e=this._shape.getLatLng();this._resizeMarkers[0].setLatLng(this._getResizeMarkerPoint(e)),this._shape._map.addLayer(this._markerGroup),this._updateMoveMarker(),this._fireEdit()}}),L.Edit.Rectangle.include({addHooks:function(){this._shape._map&&(this._markerGroup||(this._enableDragging(),this._initMarkers()),this._shape._map.addLayer(this._markerGroup))},removeHooks:function(){this._shape._map&&(this._shape._map.removeLayer(this._markerGroup),this._disableDragging(),delete this._markerGroup,delete this._markers)},_resize:function(e){this._shape.setBounds(L.latLngBounds(e,this._oppositeCorner)),this._updateMoveMarker()},_onMarkerDragEnd:function(e){this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,e)},_enableDragging:function(){this._shape.dragging||(this._shape.dragging=new L.Handler.PathDrag(this._shape)),this._shape.dragging.enable(),this._shape.on("dragstart",this._onStartDragFeature,this).on("dragend",this._onStopDragFeature,this)},_disableDragging:function(){this._shape.dragging.disable(),this._shape.off("dragstart",this._onStartDragFeature,this).off("dragend",this._onStopDragFeature,this)},_onStartDragFeature:function(){this._shape._map.removeLayer(this._markerGroup),this._shape.fire("editstart")},_onStopDragFeature:function(){for(var e=this._shape,t=0,i=e._latlngs.length;t<i;t++){var n=this._resizeMarkers[t];n.setLatLng(e._latlngs[t]),n._origLatLng=e._latlngs[t],n._middleLeft&&n._middleLeft.setLatLng(this._getMiddleLatLng(n._prev,n)),n._middleRight&&n._middleRight.setLatLng(this._getMiddleLatLng(n,n._next))}this._shape._map.addLayer(this._markerGroup),this._updateMoveMarker(),this._repositionCornerMarkers(),this._fireEdit()}}),L.Edit.PolyVerticesEdit.include({__createMarker:L.Edit.PolyVerticesEdit.prototype._createMarker,__removeMarker:L.Edit.PolyVerticesEdit.prototype._removeMarker,addHooks:function(){var e=this._poly;e.setStyle(e.options.editing),this._poly._map&&(this._markerGroup||(this._enableDragging(),this._initMarkers(),this._createMoveMarker()),this._poly._map.addLayer(this._markerGroup))},_createMoveMarker:function(){L.EditToolbar.Edit.MOVE_MARKERS&&this._poly instanceof L.Polygon&&(this._moveMarker=new L.Marker(this._getShapeCenter(),{icon:this.options.moveIcon}),this._moveMarker.on("mousedown",this._delegateToShape,this),this._markerGroup.addLayer(this._moveMarker))},_delegateToShape:function(e){var t=this._shape||this._poly,i=e.target;t.fire("mousedown",L.Util.extend(e,{containerPoint:L.DomUtil.getPosition(i._icon).add(t._map._getMapPanePos())}))},_getShapeCenter:function(){return this._poly.getCenter()},removeHooks:function(){var e=this._poly;e.setStyle(e.options.original),this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),this._disableDragging(),delete this._markerGroup,delete this._markers)},_enableDragging:function(){this._poly.dragging||(this._poly.dragging=new L.Handler.PathDrag(this._poly)),this._poly.dragging.enable(),this._poly.on("dragstart",this._onStartDragFeature,this).on("dragend",this._onStopDragFeature,this)},_disableDragging:function(){this._poly.dragging.disable(),this._poly.off("dragstart",this._onStartDragFeature,this).off("dragend",this._onStopDragFeature,this)},_onStartDragFeature:function(e){this._poly._map.removeLayer(this._markerGroup),this._poly.fire("editstart")},_onStopDragFeature:function(e){for(var t=0,i=this._latlngs.length;t<i;t++){var n=this._markers[t];n.setLatLng(this._latlngs[t]),n._origLatLng=this._latlngs[t],n._middleLeft&&n._middleLeft.setLatLng(this._getMiddleLatLng(n._prev,n)),n._middleRight&&n._middleRight.setLatLng(this._getMiddleLatLng(n,n._next))}this._poly._map.addLayer(this._markerGroup),L.Edit.SimpleShape.prototype._updateMoveMarker.call(this),this._fireEdit()},_updateMoveMarker:L.Edit.SimpleShape.prototype._updateMoveMarker,_createMarker:function(e,t){var i=this.__createMarker(e,t);return i.on("dragstart",this._hideMoveMarker,this).on("dragend",this._showUpdateMoveMarker,this),i},_removeMarker:function(e){this.__removeMarker(e),e.off("dragstart",this._hideMoveMarker,this).off("dragend",this._showUpdateMoveMarker,this)},_hideMoveMarker:function(){this._moveMarker&&this._markerGroup.removeLayer(this._moveMarker)},_showUpdateMoveMarker:function(){this._moveMarker&&(this._markerGroup.addLayer(this._moveMarker),this._updateMoveMarker())}}),L.Edit.PolyVerticesEdit.prototype.options.moveIcon=new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),L.Edit.PolyVerticesEdit.mergeOptions({moveMarker:!1}),L.Util.saveAs=function(e){function i(){return e.URL||e.webkitURL||e}function n(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)}function a(e){var t=function(){"string"==typeof e?i().revokeObjectURL(e):e.remove()};setTimeout(t,p)}function o(e,t,i){t=[].concat(t);for(var a=t.length;a--;){var o=e["on"+t[a]];if("function"==typeof o)try{o.call(e,i||e)}catch(r){n(r)}}}function r(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function s(n,s,l){function p(){o(h,"writestart progress write writeend".split(" "))}l||(n=r(n));var m,h=this,f=n.type,g=f===u;h.readyState=h.INIT;var v=e.document,y=v.createElementNS("http://www.w3.org/1999/xhtml","a"),b="download"in y;if(b)return m=i().createObjectURL(n),void setTimeout(function(){y.href=m,y.download=s;var e=new MouseEvent("click");y.dispatchEvent(e),p(),a(m),h.readyState=h.DONE});if((d||g&&c)&&e.FileReader){var _=new FileReader;return _.onloadend=function(){var i=d?_.result:_.result.replace(/^data:[^;]*;/,"data:attachment/file;"),n=e.open(i,"_blank");n||(e.location.href=i),i=t,h.readyState=h.DONE,p()},_.readAsDataURL(n),void(h.readyState=h.INIT)}if(m||(m=i().createObjectURL(n)),g)e.location.href=m;else{var L=e.open(m,"_blank");L||(e.location.href=m)}h.readyState=h.DONE,p(),a(m)}function l(e,t,i){return new s(e,t||e.name||"download",i)}if(!("undefined"==typeof e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var c=/constructor/i.test(e.HTMLElement)||e.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent),u="application/octet-stream",p=4e4;if("undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob)return function(e,t,i){return t=t||e.name||"download",i||(e=r(e)),navigator.msSaveOrOpenBlob(e,t)};var m=s.prototype;return m.abort=function(){},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,l}}("undefined"!=typeof self&&self||"undefined"!=typeof e&&e),angular.module("opengate-angular-js").service("$schemaFormUtils",["$provisionDatastreamsUtils","$api","$q",function(e,i,n){function a(e,t){if(!e)throw new Error("First parameter field must be a string or object");if(!Array.isArray(t))throw new Error("Second parameter form must be an array")}function o(e,t){return a(e,t),t=t.filter(function(t){if("string"==typeof t){if("string"==typeof e)return t!==e;var i=Array.isArray(e.key)?e.key[0]:e.key;return t!==i}if("string"==typeof e){var n=Array.isArray(t.key)?t.key[0]:t.key;return e!==n}var a=Array.isArray(e.key)?e.key[0]:e.key,o=Array.isArray(t.key)?t.key[0]:t.key;return a!==o})}function r(e,t){return a(e,t),t.push("string"==typeof e?{key:"['"+e+"']"}:e),t}function s(){function e(e,i,n){var o=e.identifier;e.required&&l.required.push(o),e.modifiable||(e.schema.readOnly=e.schema.readOnly||!i||e.calculated),e.schema.description=e.description,e.title=(e.name||o)+(e.unit&&e.unit.label?" ("+e.unit.label+")":""),e.schema.title=e.title,t(e.schema,n),a(o),d=r(o,d),l.properties[o]=e.schema}function t(e,i){var n=Object.keys(e);n.forEach(function(n){var a=e[n];i||"string"===a&&"undefined"==typeof e.format&&"undefined"==typeof e["enum"]&&(e.format="helperdialog"),angular.isObject(a)&&t(a,i)})}function a(e){c.indexOf(e)===-1&&c.push(e)}var s=this,l={type:"object",properties:{},required:[]},c=[],d=[];this.updateForm=function(e){e=angular.copy(e)},this.addField=function(t,a,o){var r=n.defer(),s=r.promise;if("string"==typeof t.schema.$ref){var l="$."+t.schema.$ref.split("#")[1];l=l.replace(/[\/]/g,"."),i().basicTypesSearchBuilder().withPath(l).execute().then(function(i){t.schema=i.data,e(t,a,o),r.resolve()})["catch"](function(e){console.error(e),r.reject(e)})}else e(t,a,o),r.resolve();return s},this.addFields=function(e,t,i){var a=[];if(Array.isArray(e)&&e.length>0)return e.forEach(function(e){a.push(s.addField(e,t,i))}),n.all(a)["catch"](function(e){console.error(e)});throw new Error("fields must be an array")},this.removeField=function(e){delete l.properties[e],l.required.splice(l.required.indexOf(e),1),c.splice(c.indexOf(e),1),d=o(e,d)},this.getSchema=function(){return l},this.getForm=function(){return d},this.getIdentifiers=function(){return c}}return{addFieldToForm:r,removeFieldToForm:o,getSchemaFormCreator:function(){return new s},getSchemaFormCreatorFromDatamodel:function(a){var o=a.customFields,r=a.allowedResourceTypes,l=a.organization,c=a.creationMode,d=a.fromAllDatamodels,u=a.withoutHelper,p=d?{and:[]}:e.getFilter(),m=n.defer(),h=m.promise;Array.isArray(o)&&o.length>0?p.and.push({"in":{"datamodels.categories.datastreams.identifier":o}}):m.reject("First parameter must be an array of datastreams identifier");var f=new s({creationMode:c});return r&&p.and.push({"in":{"datamodels.allowedResourceTypes":r}}),l&&p.and.push({eq:{"datamodels.organizationName":l}}),i().datamodelsSearchBuilder().filter(p).build().execute().then(function(i){var a=i.data.datamodels;d||(a=e.filterForCoreDatamodelsCatalog(a));var r=a.reduce(function(e,t){var i=[];return t.categories?e.concat(t.categories.reduce(function(e,t){return t.datastreams?e.concat(t.datastreams):e},i)):e},[]),s=r.reduce(function(e,t){return e[t.identifier]=t,e},[]),l=[];o.forEach(function(e){var i=s[e];"undefined"==typeof i?console.error("Datastream "+e+" no exists or not is custom."):l.push(f.addField(i,t,u))}),l.length>0&&n.all(l).then(function(){m.resolve(f)})["catch"](function(e){console.error(e),m.reject(e)})})["catch"](function(e){console.error(e),m.reject(e)}),h}}}]),angular.module("opengate-angular-js").config(["schemaFormProvider","schemaFormDecoratorsProvider","sfPathProvider","sfBuilderProvider",function(e,t,i,n){var a=function(t,n,a){var o;if("string"!==n.type||"helperdialog"!==n.format&&"date"!==n.format&&"time"!==n.format&&"datetime"!==n.format&&"date-time"!==n.format?"object"!==n.type||"date"!==n.format&&"time"!==n.format&&"datetime"!==n.format&&"date-time"!==n.format?"boolean"===n.type?(o=e.stdFormObj(t,n,a),o.key=a.path,o.type="boolean"):"object"===n.type&&n.properties&&n.properties.position&&n.properties.zoom&&(o=e.stdFormObj(t,n,a),o.key=a.path,o.type="map"):(o=e.stdFormObj(t,n,a),o.key=a.path,"date"===n.format?o.type="date":"datetime"===n.format||"date-time"===n.format?o.type="datetime":"time"===n.format&&(o.type="time")):(o=e.stdFormObj(t,n,a),o.key=a.path,"helperdialog"===n.format?o.type="helperdialog":"date"===n.format?o.type="date":"datetime"===n.format||"date-time"===n.format?o.type="datetime":"time"===n.format&&(o.type="time")),o)return a.lookup[i.stringify(a.path)]=o,o};e.defaults.string.unshift(a),e.defaults.object.unshift(a),e.defaults["boolean"].unshift(a),t.defineAddOn("bootstrapDecorator","helperdialog","schema-form/views/schema.form.helper.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","boolean","schema-form/views/schema.form.helper.boolean.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","checkboxes","schema-form/views/schema.form.helper.checkboxes.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","radios","schema-form/views/schema.form.helper.radios.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","radiobuttons","schema-form/views/schema.form.helper.radiobuttons.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","radios-inline","schema-form/views/schema.form.helper.radiosinline.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","datetime","schema-form/views/schema.form.helper.datetime.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","date-time","schema-form/views/schema.form.helper.datetime.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","date","schema-form/views/schema.form.helper.datetime.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","time","schema-form/views/schema.form.helper.datetime.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","map","schema-form/views/schema.form.map.template.html",n.stdBuilders);var o=function(t,n,a){if("string"===n.type&&"customuiselect"===n.format){var o=e.stdFormObj(t,n,a);return o.key=a.path,o.type=n.properties&&n.properties.type?n.properties.type:"string",a.lookup[i.stringify(a.path)]=o,o}};e.defaults.string.unshift(o),t.defineAddOn("bootstrapDecorator","entity","schema-form/views/schema.form.entity.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","datastream","schema-form/views/schema.form.datastream.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","device","schema-form/views/schema.form.device.template.html",n.stdBuilders),t.defineAddOn("bootstrapDecorator","asset","schema-form/views/schema.form.asset.template.html",n.stdBuilders)}]);var k=angular.module("opengate-angular-js");k.controller("helperDialogController",["$scope","$element","$attrs","$uibModal",function(e,t,i,n){var a=this,o=angular.element('<style title="helper-dialog-style">helper-dialog .row-eq-height,.helper-dialog .row-eq-height {display: -webkit-box;display: -webkit-flex;display: -ms-flexbox;display: flex;}helper-dialog .vcenter,.helper-dialog .vcenter {display: -webkit-box;display: -webkit-flex;display: -ms-flexbox;display: flex;flex-direction: column;justify-content: center;}.helper-dialog .top-buffer {margin-top: 25px;}.helper-dialog .custom-ui-select-label {display: none;}.helper-dialog .without-padding-top .form-group {margin-top: 0 !important;}.helper-dialog .without-padding-top.modal-body h4 {padding-bottom: 0px;}</style>'),r=angular.element("html head");0===r.find('style[title="helper-dialog-style"]').length&&r.append(o),a.mode="default",a.helperTitle?(a.mode="title",a.helperButton&&(a.mode="title_button")):a.helperButton&&(a.mode="button"),a.open=function(){var e=n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"helper.view.modal.html",controller:"helperDialogModalController",controllerAs:"$ctrl",windowClass:"helper-dialog",resolve:{helper_id:function(){return a.componentsIds&&1===a.componentsIds.length?a.componentsIds[0]:a.helperId},helper_exclusive:function(){return"true"===a.helperExclusive},specific_type:function(){return a.specificType},exclude_devices:function(){return"true"===a.excludeDevices},helper_extra:function(){return a.helperExtra},helper_type:function(){return a.helperType},helper_selected:function(){return a.helperExtra&&a.helperExtra.selected?a.helperExtra.selected:a.selected},fullCopy:function(){return a.fullCopy}}});e.result.then(function(e){e?(a.selected=angular.fromJson(e),a.onCopy&&a.onCopy({$helper_keys:e}),a.onMulti&&angular.isArray(a.onMulti)&&angular.forEach(a.onMulti,function(t,i){angular.isFunction(t)&&t({$helper_keys:e})})):console.warn("Nothing selected on modal")},function(){})}}]),k.controller("helperDialogModalController",["$scope","$uibModalInstance","helper_id","helper_exclusive","specific_type","exclude_devices","helper_extra","helper_selected","helper_type","Upload","mapUxService","$translate","fullCopy",function(e,t,i,n,a,o,r,s,l,c,d,u,p){function m(e,t,i){h.helper_keys.map={latitude:e,longitude:t,zoom:i}}var h=this;if(h.helper_extra=r,i){var f=/(\w|0-9)+/g;i=f.exec(i.toLowerCase())[0],h.helper_id=i,h[i+"IsOpen"]=!0,h[i+"IsExclusive"]=h.helper_exclusive=n}l&&(h[l+"IsOpen"]=!0,h[l+"IsExclusive"]=!0,h.helper_exclusive=!0),h.helper_keys={},h.helper_keys.__clean={},h.helper_keys.__clean[u.instant("FORM.HELPER.FIELD.EMPTY")]="",h.specific_type=a,h.exclude_devices=o;var g=[],v=d.getDefaultOptions();if(delete v.l_gohome,delete v.l_print,h.map=d.createNgOptions(v),angular.extend(h.map,{center:{lat:s&&s.latitude?s.latitude:40.095,lng:s&&s.longitude?s.longitude:-3.823,zoom:s&&s.zoom?s.zoom:4},markers:{},events:{markers:{enable:["dragend","click"],logic:"emit"},map:{enable:["click"],logic:"emit"}}}),s&&s.latitude&&(h.map.markers={marker:{lat:s.latitude,lng:s.longitude,draggable:!0,focus:!0,message:u.instant("LOG.DRAG_ME")}},m(s.latitude,s.longitude,s.zoom)),r){if(r.map){var y={marker:{draggable:!0,focus:!0,message:u.instant("LOG.DRAG_ME")}};h.map=_.merge(h.map,r.map,y)}r.area&&(h.area=r.area)}g.push(e.$on("leafletDirectiveMarker.map-marker.click",function(e,t){delete h.helper_keys.map,h.map.markers={}}),e.$on("leafletDirectiveMap.map-marker.click",function(e,t){var i=t.leafletEvent.latlng;h.map.markers={marker:{lat:i.lat,lng:i.lng,draggable:!0,focus:!0,message:u.instant("LOG.DRAG_ME")}},m(i.lat,i.lng,t.leafletObject._zoom)}),e.$on("leafletDirectiveMarker.map-marker.dragend",function(e,t){var i=t.leafletEvent.target._leaflet_events.dragend[0].context._latlng;m(i.lat,i.lng,t.leafletObject._zoom)})),h.domain={},s&&s.name&&(h.helper_keys.domain={name:s.name},h.datastream={selected:[{name:s.name}]}),h.onSelectDomainKey=function(e,t){h.helper_keys.domain={name:e.name}},h.onDeleteDomainKey=function(){delete h.helper_keys.name},h.datastream={},s&&s.datastreamId&&(h.helper_keys.datastream={datastreamId:s.datastreamId},h.datastream={selected:[{identifier:s.datastreamId}]}),h.onSelectDatastreamKey=function(e,t){h.helper_keys.datastream={datastreamId:e.identifier}},h.onDeleteDatastreamKey=function(){delete h.helper_keys.datastream},h.entity={},s&&s.entityKey&&(h.helper_keys.entity={entityKey:s.entityKey},h.entity={selected:[{provision:{administration:{identifier:{_current:{value:s.entityKey}}}}}]}),h.onSelectEntityKey=function(e,t){h.helper_keys.entity={entityKey:e.provision.administration.identifier._current.value}},h.onDeleteEntityKey=function(){delete h.helper_keys.entity},h.device={},s&&s.deviceKey&&(h.helper_keys.device={deviceKey:s.deviceKey},h.device={selected:[{provision:{administration:{identifier:{_current:{value:s.deviceKey}}}}}]}),h.onSelectDeviceKey=function(e,t){h.helper_keys.device={deviceKey:e.provision.administration.identifier._current.value}},h.onDeleteDeviceKey=function(){delete h.helper_keys.device},h.asset={},s&&s.assetKey&&(h.helper_keys.asset={assetKey:s.assetKey},h.asset={selected:[{provision:{administration:{identifier:{_current:{value:s.assetKey}}}}}]}),h.onSelectAssetKey=function(e,t){h.helper_keys.asset={assetKey:e.provision.administration.identifier._current.value}},h.onDeleteAssetKey=function(){delete h.helper_keys.asset},h.subscriber={},s&&s.subscriberKey&&(h.helper_keys.subscriberKey={subscriberKey:s.subscriberKey},h.subscriber={selected:[{provision:{subscriber:{identifier:{_current:{value:s.subscriberKey}}}}}]}),h.onSelectSubscriberKey=function(e,t){h.helper_keys.subscriber=e},h.onDeleteSubscriberKey=function(){delete h.helper_keys.subscriber},h.subscription={},s&&s.subscriptionKey&&(h.helper_keys.subscriptionKey={subscriptionKey:s.subscriptionKey},h.subscription={selected:[{provision:{subscription:{identifier:{_current:{value:s.subscriptionKey}}}}}]}),h.onSelectSubscriptionKey=function(e,t){h.helper_keys.subscription=e},h.onDeleteSubscriptionKey=function(){delete h.helper_keys.subscription},h.area?delete h.area.selected:h.area={},s&&s.area&&(h.helper_keys.area={area:s.area},h.area.selected=[{identifier:s.area}]),h.onSelectAreaKey=function(e,t){h.helper_keys.area={area:e.identifier}},h.onDeleteAreaKey=function(){delete h.helper_keys.area},h.canApply=function(){return Object.keys(h.helper_keys).length>0},h.bundle?delete h.bundle.selected:h.bundle={},s&&s.bundle&&(h.helper_keys.bundle={bundle:s.bundle},h.bundle.selected=[{id:s.bundle}]),h.onSelectBundleKey=function(e,t){h.helper_keys.bundle={bundleId:e.id,bundleName:e.name,bundleVersion:e.version}},h.onDeleteBundleKey=function(){delete h.helper_keys.bundle},s&&s.image&&(h.helper_keys.image={image:s.image}),h.imageSelected=function(e){e?c.base64DataUrl(e).then(function(e){h.helper_keys.image={image:e}}):h.removeDataFile()},h.removeDataFile=function(){delete h.helper_keys.image},h.canApply=function(){return Object.keys(h.helper_keys).length>0},h.ok=function(e){if(e&&p)t.close(h.helper_keys[e]);else{var i={};angular.forEach(h.helper_keys,function(e,t){if("subscriber"===t.trim().toLowerCase()||"subscription"===t.trim().toLowerCase()){var n=e.provision[t.trim().toLowerCase()].identifier._current.value;i[t.trim().toLowerCase()+"Key"]=n}else angular.forEach(e,function(e,t){i[t]=e})}),t.close(i)}},h.cancel=function(){t.dismiss("cancel")},e.$on("destroy",function(){for(var e in g)e()})}]),k.component("helperDialog",{transclude:!0,templateUrl:"helper/views/helper.view.html",controller:"helperDialogController",controllerAs:"$helper",bindings:{onCopy:"&",helperId:"@",specificType:"@",excludeDevices:"@",helperButton:"@",helperTitle:"@",helperExclusive:"@",helperExtra:"<",helperType:"@?",modalTemplate:"@",modalController:"@",onMulti:"<",fullCopy:"="}}),angular.module("opengate-angular-js").controller("helperUiSelectController",["$scope","$element","$attrs",function(e,t,i){var n=this;n.$helper_keys={},n.labelError=n.labelError?n.labelError:"Parameter is required",n.labelText=n.labelText?n.labelText:"Parameter",n.helperTagTransform=function(e){return{key:"custom",value:e}},n._onCopy=function(e){n.$helper_keys=e.$helper_keys,n.have_helper_keys=!0,n.helperModel&&n.helperModel.length>0&&(n.$helper_keys["'"+n.labelText+"' default"]=n.helperModel)},n.$onChanges=function(e){e&&e.selectedKeys&&e.selectedKeys.currentValue&&(Object.keys(e.selectedKeys.currentValue).length>0?(n.$helper_keys=e.selectedKeys.currentValue,n.have_helper_keys=!0):(n.$helper_keys={},n.have_helper_keys=!1))},n.$onInit=function(){n.helperCtrl.onMulti||(n.helperCtrl.onMulti=[]),n.helperCtrl.onMulti.push(n._onCopy),n.helperCtrl.componentsIds||(n.helperCtrl.componentsIds=[]),n.helperCtrl.componentsIds.push(n.labelText),n.have_helper_keys=!1},n.clean=function(){n.$helper_keys={},n.have_helper_keys=!1}}]),angular.module("opengate-angular-js").component("helperUiSelect",{templateUrl:"helper/views/custom.ui.select.helper.html",transclude:{input:"?helperUiSelectInput"},require:{helperCtrl:"^^helperDialog"},controller:"helperUiSelectController",bindings:{id:"@",name:"@",labelText:"@",helperModel:"=",required:"<",multiple:"<",labelError:"@",selectedKeys:"<"}}),angular.module("opengate-angular-js").directive("customUiSelect",["$compile","Filter",function(e,t){var i=angular.element('<div title="Toggle Advanced/Basic filter search" ng-click="complex()" style="cursor:pointer" class="custom-ui-select-button input-group-addon"><i class="fa fa-filter"></i><i class="filter-icon fa fa-bold text-muted"></i></div>'),n=angular.element('<div class="custom-ui-select-container input-group"></div>'),a=angular.element('<style title="custom-ui-select-no-multiple">.custom-ui-select-no-multiple .ui-select-search[placeholder=""]{display:none}</style>'),o=function(e,t){var i=e.querySelectorAll("ui-select-choices");i.attr("refresh",t),i.attr("refresh-delay","0")};return{require:"uiSelect",scope:!0,bindToController:!0,controller:["$scope","$element","$attrs","$q","$timeout",function(e,i,n,a,o){function r(e){if(d.prefilter){var t={and:[]};return t.and.push(d.prefilter),t.and.push(e),t}return e}function s(){var t=n.customUiSelectConfig.split(".");if(1===t.length)return e[n.customUiSelectConfig];var i=e;return t.forEach(function(e){i=i[e]}),i}function l(e){u&&clearTimeout(u),u=setTimeout(function(){c(e)},500)}function c(t){function i(e){var t=[];angular.isArray(e)?angular.copy(e,t):angular.forEach(e,function(e,i){t.push(e)}),angular.copy(t,d.collection)}var a=d.builder,o=d.rootKey,r=d.limit?d.limit:25;p&&angular.equals(p,t)||(p=angular.copy(t),n.$$button.querySelectorAll(".filter-icon").removeClass("fa-bold").removeClass("fa-font").addClass("fa-spinner").addClass("fa-spin"),a.limit(r).filter(t).build().execute().then(function(t){if(e._complex?n.$$button.querySelectorAll(".filter-icon").removeClass("fa-spinner").removeClass("fa-spin").addClass("fa-font"):n.$$button.querySelectorAll(".filter-icon").removeClass("fa-spinner").removeClass("fa-spin").addClass("fa-bold"),200===t.statusCode){var a=t.data[o];angular.isFunction(d.processingData)?d.processingData(t,a).then(i):i(a),e.$apply()}else d.collection.splice(0,d.collection.length),204!==t.statusCode?console.error(JSON.stringify(t)):console.log(JSON.stringify(t)),e.$apply()})["catch"](function(e){console.error(e),n.$$button.querySelectorAll(".filter-icon").removeClass("fa-spinner").removeClass("fa-spin").addClass("fa-filter")}))}var d=s();e.complexfilter=function(e){t.parseQuery(e||"").then(function(e){var t=e.filter;Object.keys(t).length>0?(l(r(t)),console.log("Final filter: "+t)):d.collection.splice(0,d.collection.length)})["catch"](function(e){console.error(e),d.collection.splice(0,d.collection.length)})},e.asyncfilter=function(e){l(r(d.filter(e)))},e._complex=n.$$button.querySelectorAll(".fa-filter").hasClass("text-primary"),e.complex=function(){e._complex=!e._complex,e._complex?(i.css("display","").removeClass("custom-ui-select-hide"),n.$$cloneElement.css("display","none").addClass("custom-ui-select-hide"),n.$$button.querySelectorAll(".filter-icon").removeClass("fa-bold").removeClass("text-muted").addClass("fa-font").addClass("text-primary")):(i.css("display","none").addClass("custom-ui-select-hide"),n.$$cloneElement.css("display","").removeClass("custom-ui-select-hide"),n.$$button.querySelectorAll(".filter-icon").removeClass("fa-font").addClass("text-muted").addClass("fa-bold").removeClass("text-primary"))},e.customUiTagTransform=function(e){return null};var u=null,p=null}],compile:function(r,s){s.$$button=i.clone(),s.$$container=n.clone();var l="true"!==s.multiple,c=s.tagging;console.log("isSimple: "+l),l&&(r.attr("limit","1"),s.limit="1",s.searchEnabled="!$select.selected || $select.selected.length === 0",r.attr("search-enabled","!$select.selected || $select.selected.length === 0"),r.addClass("custom-ui-select-no-multiple"),s.$$style=a.clone()),c&&0!==c.trim().length||(r.attr("tagging","customUiTagTransform"),s.tagging="customUiTagTransform");var d="asyncfilter($select.search);",u="complexfilter($select.search);";if(s.customMassAutocompleteItem){o(r,u);var p=angular.element(r.clone());p.removeAttr("custom-ui-select"),o(p,d),s.$$templateElement=p}else o(r,d);return function(i,n,a,o){function r(e){if(a[e]){var t=a[e].split(".");if(1===t.length)return i[a[e]];var n=i;return t.forEach(function(e){n=n[e]}),n}}var s="mass-autocomplete-ui-select",l="async-ui-select",c=angular.element("html head");if(a.$$style&&0===c.find('style[title="custom-ui-select-no-multiple"]').length&&c.append(a.$$style),a.customMassAutocompleteItem){n.addClass(s);var d=r("customMassAutocompleteItem");d.suggest||(d.suggest=t.suggest_field_delimited);var u=n.querySelectorAll("input.ui-select-search");u.attr("mass-autocomplete-item",a.customMassAutocompleteItem),e(u)(i),a.$$container.empty(),n.before(a.$$container),n.detach(),a.$$container.append(n);var p=a.$$templateElement.clone(),m=e(p)(i,function(e,t){a.$$container.append(e)});m.addClass(l),a.$$cloneElement=m,e(a.$$button)(i),a.$$container.append(a.$$button),n.css("display","none").addClass("custom-ui-select-hide");var h=[];a.$$container.bind("keydown",function(e){h.push(e.keyCode)}),a.$$container.bind("keyup",function(e){h.length>0&&(angular.equals(h,[17,18,70])&&i.complex(),h.splice(0,h.length))})}else n.addClass(l)}}}}]),angular.module("opengate-angular-js").controller("uiSelectResourceTypeController",["$scope","$element","$attrs","$api",function(e,t,i,n){var a=this;a.ownConfig={builder:n().resourceTypeSearchBuilder(),filter:function(e){},rootKey:"resourceType",collection:[],customSelectors:n().resourceTypeSearchBuilder()},a.resourceTypeSelected=function(e,t){var i={};i.$item=e,i.$model=t,a.onSelectItem(i)},a.resourceTypeRemove=function(e,t){a.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("uiSelectResourceType",{templateUrl:"custom-ui-select/views/ui.select.resourceType.html",controller:"uiSelectResourceTypeController",bindings:{onSelectItem:"&",onRemove:"&",resourceType:"=",multiple:"<",required:"=",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("uiSelectFaStylesController",["$scope","faStylesService","$window",function(e,t,i){var n=this;n.availableIcons=t.getStyles();var a=-1;n.maxIcons=50,n.onOpenClose=function(t){n.maxIcons=50,i.clearInterval(a),t&&(a=i.setInterval(function(){n.maxIcons=n.maxIcons+50,n.maxIcons>Object.keys(n.availableIcons).length&&i.clearInterval(a),
e.$apply()},500))},n.iconSelected=function(e,t){var i={};i.$item=e,i.$model=t,n.onSelectItem(i)},n.iconRemove=function(e,t){n.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("uiSelectFaStyles",{templateUrl:"custom-ui-select/views/ui.select.icon.html",controller:"uiSelectFaStylesController",bindings:{onSelectItem:"&",onRemove:"&",required:"=",allowClear:"=",disabled:"=",icon:"=",title:"@",label:"=",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectTicketController",["$scope","$element","$attrs","$api",function(e,t,i,n){var a=this;a.ownConfig={builder:n().ticketsSearchBuilder(),filter:function(e){return{or:[{like:{"provision.administration.identifier":e}},{like:{"provision.ticket.specificType":e}},{like:{"provision.ticket.name":e}},{like:{"provision.ticket.type":e}},{like:{"provision.ticket.entity":e}}]}},rootKey:"tickets",collection:[],customSelectors:n().ticketsSearchBuilder()},a.ticketSelected=function(e,t){var i={};i.$item=e,i.$model=t,a.onSelectItem(i)},a.ticketRemove=function(e,t){a.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectTicket",{templateUrl:"custom-ui-select/views/custom.ui.select.ticket.html",controller:"customUiSelectTicketController",bindings:{onSelectItem:"&",onRemove:"&",ticket:"=",multiple:"<",required:"=",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectSubscriptionController",["$scope","$element","$attrs","$api","$entityExtractor","$translate","$doActions","$jsonFinderHelper","jsonPath",function(e,i,n,a,o,r,s,l,c){var d=this;d.ownConfig={builder:a().subscriptionsSearchBuilder().provisioned(),filter:function(e){var t={or:[{like:{"provision.device.communicationModules[].subscription.identifier":e}},{like:{"device.communicationModules[].subscription.identifier":e}}]};return d.specificType&&(t={and:[t,{or:[{eq:{"device.communicationModules[].subscription.specificType":d.specificType}},{eq:{"provision.device.communicationModules[].subscription.specificType":d.specificType}}]}]}),d.excludeDevices&&(t.and?t.and.push({eq:{resourceType:"entity.subscription"}}):t={and:[t,{eq:{resourceType:"entity.subscription"}}]}),t},rootKey:"devices",collection:[],customSelectors:a().subscriptionsSearchBuilder().provisioned(),processingData:o.extractSubscriptions,specificType:d.specificType},d.entitySelected=function(e,t){var i={};i.$item=e,i.$model=t,d.onSelectItem(i)},d.entityRemove=function(e,t){d.onRemove(e,t)},d.actions||(d.actions=[{title:r.instant("BUTTON.TITLE.NEW_SUBSCRIPTION"),icon:"glyphicon glyphicon-plus-sign",action:function(){s.executeModal("createSubscription",{},function(e){e&&e.length>0&&(d.entity=d.entity?d.entity:[],d.entity.push({provision:{administration:{identifier:{_current:{value:e[0].identifier}}},subscription:{identifier:{_current:{value:e[0].identifier}}}}}))})},permissions:"manageEntity"},{title:r.instant("BUTTON.TITLE.EXECUTE_OPERATION"),icon:"glyphicon glyphicon-flash",action:function(){s.executeModal("executeOperation",{keys:c(d.entity,"$.."+l.subscription.provisioned.getPath("identifier")+"._current.value")||[],entityType:"SUBSCRIPTION"})},disable:function(){return!d.entity||0===d.entity.length},permissions:"executeOperation"}]),d.required!==t&&(d.ngRequired=d.required)}]),angular.module("opengate-angular-js").component("customUiSelectSubscription",{templateUrl:"custom-ui-select/views/custom.ui.select.subscription.html",controller:"customUiSelectSubscriptionController",bindings:{onSelectItem:"&",onRemove:"&",entity:"=",specificType:"@",multiple:"<",ngRequired:"<",required:"<",excludeDevices:"=",action:"=?",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectSubscriberController",["$scope","$element","$attrs","$api","$entityExtractor",function(e,i,n,a,o){var r=this;r.ownConfig={builder:a().subscribersSearchBuilder().provisioned(),filter:function(e){var t={or:[{like:{"provision.device.communicationModules[].subscriber.identifier":e}},{like:{"device.communicationModules[].subscriber.identifier":e}},{like:{"provision.device.communicationModules[].subscriber.mobile.icc":e}}]};return r.specificType&&(t={and:[t,{or:[{eq:{"device.communicationModules[].subscriber.specificType":r.specificType}},{eq:{"provision.device.communicationModules[].subscriber.specificType":r.specificType}}]}]}),r.excludeDevices&&(t.and?t.and.push({eq:{resourceType:"entity.subscriber"}}):t={and:[t,{eq:{resourceType:"entity.subscriber"}}]}),t},rootKey:"devices",collection:[],customSelectors:a().subscribersSearchBuilder().provisioned(),processingData:o.extractSubscribers,specificType:r.specificType},r.entitySelected=function(e,t){var i={};i.$item=e,i.$model=t,r.onSelectItem(i)},r.entityRemove=function(e,t){r.onRemove(e,t)},r.required!==t&&(r.ngRequired=r.required)}]),angular.module("opengate-angular-js").component("customUiSelectSubscriber",{templateUrl:"custom-ui-select/views/custom.ui.select.subscriber.html",controller:"customUiSelectSubscriberController",bindings:{onSelectItem:"&",onRemove:"&",entity:"=",specificType:"@",multiple:"<",ngRequired:"<",required:"<",excludeDevices:"=",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectProvisionDatastreamController",["$api","$q","$provisionDatastreamsUtils",function(e,t,i){var n=this;n.filter="provision.",n.ownConfig={builder:e().datamodelsSearchBuilder(),filter:function(e){n.lastSearch=e;var t=i.getFilter();if(n.allowedResourceTypes){var a=n.allowedResourceTypes.replace("s*,s*",",").split(",");t.and.push({"in":{"datamodels.allowedResourceTypes":a}})}if(n.organization&&n.organization.length>0&&(t.and||(t.and=[]),t.and.push({eq:{"datamodels.organizationName":n.organization}})),e){var o={or:[{like:{"datamodels.categories.datastreams.identifier":e}},{like:{"datamodels.categories.datastreams.name":e}}]};t.and.push(o)}return t},rootKey:"datamodels",collection:[],processingData:function(e,a){return t(function(t){var o=[],r=e.data.datamodels;r=i.filterForCoreDatamodelsCatalog(r),angular.forEach(r,function(e,t){var i=e.categories,a={identifier:e.identifier,description:e.description,name:e.name,organization:e.organizationName};angular.forEach(i,function(e,t){var i=e.datastreams;if(i){var r={identifier:e.identifier};angular.forEach(i.filter(function(e){return!!/^(provision\.).*/.test(e.identifier)&&(e.identifier.indexOf(n.lastSearch)>-1&&!!n.lastSearch.length||!n.lastSearch)}),function(e,t){var i=angular.copy(e);i.datamodel=a,i.category=r,o.push(i)})}})}),angular.copy(o,a),t(a)})},customSelectors:e().datamodelsSearchBuilder()},n.datastreamSelected=function(e,t){var i={};i.$item=e,i.$model=t,n.onSelectItem(i)},n.datastreamRemove=function(e,t){var i={};i.$item=e,i.$model=t,n.onRemove(i)}}]),angular.module("opengate-angular-js").component("customUiSelectProvisionDatastream",{templateUrl:"custom-ui-select/views/custom.ui.select.datastream.html",controller:"customUiSelectProvisionDatastreamController",bindings:{onSelectItem:"&",onRemove:"&",datastream:"=",multiple:"<",required:"=",organization:"=",allowedResourceTypes:"=",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectEntityController",["$scope","$element","$attrs","$api",function(e,i,n,a){function o(e){var t=e;t?(t._current&&(t=t._current.value),r.multiple?angular.isArray(t)&&(r.entity=[],angular.forEach(t,function(e){r.entity.push({provision:{administration:{identifier:{_current:{value:e}}}}})})):r.entity=[{provision:{administration:{identifier:{_current:{value:r.identifier}}}}}]):r.entity=[]}var r=this,s=a().newSelectBuilder(),l=a().SE;s.add(l.element("provision.administration.identifier",[{field:"value"}])),s.add(l.element("provision.administration.organization",[{field:"value"}])),s.add(l.element("provision.administration.channel",[{field:"value"}])),s.add(l.element("resourceType",[{field:"value"}])),s.add(l.element("provision.device.identifier",[{field:"value"}])),s.add(l.element("provision.device.specificType",[{field:"value"}])),s.add(l.element("provision.device.operationalStatus",[{field:"value"}])),s.add(l.element("provision.device.communicationModules[].specificType",[{field:"value"}])),s.add(l.element("provision.device.communicationModules[].subscription.specificType",[{field:"value"}])),s.add(l.element("provision.device.communicationModules[].subscriber.specificType",[{field:"value"}])),s.add(l.element("provision.asset.identifier",[{field:"value"}])),s.add(l.element("provision.asset.specificType",[{field:"value"}])),r.ownConfig={builder:a().entitiesSearchBuilder().select(s),filter:function(e){return{or:[{like:{"provision.administration.identifier":e}},{like:{"provision.device.specificType":e}},{like:{"device.specificType":e}},{like:{"provision.entity.specificType":e}},{like:{"provision.device.communicationModules[].specificType":e}}]}},rootKey:"entities",collection:[],customSelectors:a().entitiesSearchBuilder()},r.entitySelected=function(e,t){if(r.multiple){var i=r.ngModel||[];angular.forEach(r.entity,function(e){i.push(e.provision.administration.identifier._current.value)}),r.ngModel=i}else r.ngModel=e.provision.administration.identifier._current.value;if(r.onSelectItem){var n={};n.$item=e,n.$model=t,r.onSelectItem(n)}},r.entityRemove=function(e,t){r.onRemove&&r.onRemove(e,t),r.ngModel=null},r.$onChanges=function(e){e&&e.identifier&&o(e.identifier.currentValue)},r.required!==t&&(r.ngRequired=r.required),r.identifier&&o(r.identifier)}]),angular.module("opengate-angular-js").component("customUiSelectEntity",{templateUrl:"custom-ui-select/views/custom.ui.select.entity.html",controller:"customUiSelectEntityController",bindings:{onSelectItem:"&",onRemove:"&",entity:"=",identifier:"<?",multiple:"<",ngRequired:"<",required:"<",label:"<",action:"<?",disabled:"<?",ngModel:"=?",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectDomainController",["$scope","$element","$attrs","$api",function(e,t,i,n){var a=this;a.ownConfig={builder:n().domainsSearchBuilder(),rootKey:"domains",collection:[],filter:function(e){return{or:[{like:{"domain.name":e}},{like:{"domain.description":e}}]}},customSelectors:n().domainsSearchBuilder()},a.domainSelected=function(e,t){var i={};i.$item=e,i.$model=t,a.onSelectItem(i)},a.domainRemove=function(e,t){a.onRemove(e,t)}}]),angular.module("opengate-angular-js").component("customUiSelectDomain",{templateUrl:"custom-ui-select/views/custom.ui.select.domain.html",controller:"customUiSelectDomainController",bindings:{onSelectItem:"&",onRemove:"&",domain:"=",multiple:"<",required:"=",label:"=",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectDeviceController",["$scope","$element","$attrs","$api","$translate","$doActions","$jsonFinderHelper","jsonPath",function(e,i,n,a,o,r,s,l){function c(e){var t=e;t?(t._current&&(t=t._current.value),p.multiple?angular.isArray(t)&&(p.device=[],angular.forEach(t,function(e){p.device.push({provision:{administration:{identifier:{_current:{value:e}}},device:{identifier:{_current:{value:e}}}}})})):p.device=[{provision:{administration:{identifier:{_current:{value:p.identifier}}},device:{identifier:{_current:{value:p.identifier}}}}}]):p.device=[]}var d=a().newSelectBuilder(),u=a().SE;d.add(u.element("provision.administration.identifier",[{field:"value"}])),d.add(u.element("provision.administration.organization",[{field:"value"}])),d.add(u.element("provision.administration.channel",[{field:"value"}])),d.add(u.element("resourceType",[{field:"value"}])),d.add(u.element("provision.device.identifier",[{field:"value"}])),d.add(u.element("provision.device.specificType",[{field:"value"}])),d.add(u.element("provision.device.operationalStatus",[{field:"value"}])),d.add(u.element("provision.device.communicationModules[].specificType",[{field:"value"}])),d.add(u.element("provision.device.communicationModules[].subscription.specificType",[{field:"value"}])),d.add(u.element("provision.device.communicationModules[].subscriber.specificType",[{field:"value"}]));var p=this;p.ownConfig={builder:a().devicesSearchBuilder().select(d),filter:function(e){var t={or:[{like:{"provision.administration.identifier":e}},{like:{"provision.device.specificType":e}},{like:{"device.specificType":e}}]};return p.specificType&&(t={and:[t,{or:[{eq:{"device.specificType":p.specificType}},{eq:{"provision.device.specificType":p.specificType}}]}]}),t},rootKey:"devices",collection:[],customSelectors:a().devicesSearchBuilder(),specificType:p.specificType},p.deviceSelected=function(e,t){if(p.multiple){var i=[];angular.forEach(p.device,function(e){i.push(e.provision.administration.identifier._current.value)}),p.ngModel=i}else p.ngModel=e.provision.administration.identifier._current.value;if(p.onSelectItem){var n={};n.$item=e,n.$model=t,p.onSelectItem(n)}},p.deviceRemove=function(e,t){p.onRemove&&p.onRemove(e,t),p.ngModel=null},p.actions||(p.actions=[{title:o.instant("BUTTON.TITLE.NEW_DEVICE"),icon:"glyphicon glyphicon-plus-sign",action:function(){var e={};p.specificType&&(e={resourceType:{_current:{value:"entity.device"}},provision:{device:{specificType:{_current:{value:p.specificType}}}}}),r.executeModal("createDevice",e,function(e){e&&e.length>0&&(p.device=p.device?p.device:[],p.device.push({provision:{administration:{identifier:{_current:{value:e[0].identifier}}},device:{identifier:{_current:{value:e[0].identifier}}}}}))})},permissions:"manageEntity"},{title:o.instant("BUTTON.TITLE.EXECUTE_OPERATION"),icon:"glyphicon glyphicon-flash",action:function(){r.executeModal("executeOperation",{keys:l(p.device,"$.."+s.provisioned.getPath("identifier")+"._current.value")||[],entityType:"GATEWAY"})},disable:function(){return!p.device||0===p.device.length},permissions:"executeOperation"}]),p.$onChanges=function(e){e&&e.identifier&&c(e.identifier.currentValue)},p.required!==t&&(p.ngRequired=p.required),p.identifier&&c(p.identifier)}]),angular.module("opengate-angular-js").component("customUiSelectDevice",{templateUrl:"custom-ui-select/views/custom.ui.select.device.html",controller:"customUiSelectDeviceController",bindings:{onSelectItem:"&",onRemove:"&",device:"=",identifier:"<?",multiple:"<",ngRequired:"<",required:"<",label:"=",action:"=?",specificType:"@?",disabled:"<?",ngModel:"=?",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectDatastreamController",["$api","$q","Authentication",function(e,i,n){function a(e){var t=e;t?(t._current&&(t=t._current.value),o.multiple?angular.isArray(t)&&(o.datastream=[],angular.forEach(t,function(e){o.datastream.push({identifier:e})})):o.datastream=[{identifier:o.identifier}]):o.datastream=[]}var o=this;o.ownConfig={builder:e().datamodelsSearchBuilder(),limit:5,filter:function(e){o.lastSearch=e;var t={};if(o.resourceTypes&&angular.isArray(o.resourceTypes)&&o.resourceTypes.length>0&&(t.and=[{"in":{"datamodels.allowedResourceTypes":o.resourceTypes}}]),o.organization&&o.organization.length>0&&(t.and||(t.and=[]),t.and.push({eq:{"datamodels.organizationName":o.organization}})),e){var i={or:[{like:{"datamodels.categories.datastreams.identifier":e}},{like:{"datamodels.categories.datastreams.name":e}},{like:{"datamodels.identifier":e}},{like:{"datamodels.name":e}},{like:{"datamodels.description":e}},{like:{"datamodels.version":e}}]};return t.and?(t.and.push(i),t):i}return n&&n.user&&n.user.domain&&(!o.organization||o.organization.length<=0)&&(t.and||(t.and=[]),t.and.push({eq:{"datamodels.organizationName":n.user.domain}})),t},rootKey:"datamodels",collection:[],processingData:function(e,t){return i(function(i){var n=[],a=e.data.datamodels;angular.forEach(a,function(e,t){var i=e.categories,a={identifier:e.identifier,description:e.description,name:e.name,organization:e.organizationName};angular.forEach(i,function(e,t){var i=e.datastreams;if(i){var r={identifier:e.identifier};angular.forEach(i.filter(function(e){return e.identifier.toLowerCase().indexOf(o.lastSearch.toLowerCase())>-1&&!!o.lastSearch.length||!o.lastSearch}),function(e,t){var i=angular.copy(e);if(i.datamodel=a,i.category=r,o.postFilter){var s=o.postFilter(i);s||n.push(i)}else n.push(i)})}})}),angular.copy(n,t),i(t)})},customSelectors:e().datamodelsSearchBuilder()},o.datastreamSelected=function(e,t){if(o.multiple){var i=o.ngModel||[];angular.forEach(o.datastream,function(e){i.push(e.identifier)}),o.ngModel=i}else o.ngModel=e.identifier;if(o.onSelectItem){var n={};n.$item=e,n.$model=t,o.onSelectItem(n)}},o.datastreamRemove=function(e,t){if(o.onRemove){var i={};i.$item=e,i.$model=t,o.onRemove(i)}o.ngModel=null},o.$onChanges=function(e){e&&e.identifier&&a(e.identifier.currentValue)},o.required!==t&&(o.ngRequired=o.required),o.identifier&&a(o.identifier),o.maxResults||(o.maxResults=100)}]),angular.module("opengate-angular-js").component("customUiSelectDatastream",{templateUrl:"custom-ui-select/views/custom.ui.select.datastream.html",controller:"customUiSelectDatastreamController",bindings:{onSelectItem:"&",onRemove:"&",datastream:"=",multiple:"<",maxResults:"<",ngRequired:"<",required:"<",postFilter:"<",resourceTypes:"=",organization:"=",placeholder:"=",uiSelectMatchClass:"@?",identifier:"<?",ngModel:"=?"}}),angular.module("opengate-angular-js").controller("customUiSelectBundleController",["$scope","$element","$attrs","$api","$q",function(e,t,i,n,a){var o=this;o.ownConfig={builder:n().bundlesSearchBuilder(),filter:function(e){return o.lastSearch=e,e?{or:[{like:{"bundles.name":e}},{like:{"bundles.version":e}},{like:{"bundles.description":e}}]}:{}},rootKey:"bundles",collection:[],customSelectors:n().bundlesSearchBuilder()},o.bundleSelected=function(e,t){var i={};i.$item=e,i.$model=t,o.onSelectItem(i)},o.bundleRemove=function(e,t){var i={};i.$item=e,i.$model=t,o.onRemove(i)}}]),angular.module("opengate-angular-js").component("customUiSelectBundle",{templateUrl:"custom-ui-select/views/custom.ui.select.bundle.html",controller:"customUiSelectBundleController",bindings:{onSelectItem:"&",onRemove:"&",bundle:"=",multiple:"<",required:"=",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectAssetController",["$scope","$element","$attrs","$api","$doActions","$translate","$jsonFinderHelper","jsonPath",function(e,i,n,a,o,r,s,l){function c(e){var t=e;t?(t._current&&(t=t._current.value),p.multiple?angular.isArray(t)&&(p.asset=[],angular.forEach(t,function(e){p.asset.push({provision:{administration:{identifier:{_current:{value:e}}},asset:{identifier:{_current:{value:e}}}}})})):p.asset=[{provision:{administration:{identifier:{_current:{value:p.identifier}}},asset:{identifier:{_current:{value:p.identifier}}}}}]):p.asset=[]}var d=a().newSelectBuilder(),u=a().SE;d.add(u.element("provision.administration.identifier",[{field:"value"}])),d.add(u.element("provision.administration.organization",[{field:"value"}])),d.add(u.element("provision.administration.channel",[{field:"value"}])),d.add(u.element("resourceType",[{field:"value"}])),d.add(u.element("provision.asset.identifier",[{field:"value"}])),d.add(u.element("provision.asset.name",[{field:"value"}])),d.add(u.element("provision.asset.specificType",[{field:"value"}]));var p=this;p.ownConfig={builder:a().assetsSearchBuilder().select(d),filter:function(e){var t={or:[{like:{"provision.administration.identifier":e}},{like:{"provision.asset.specificType":e}},{like:{"asset.specificType":e}}]};return p.specificType&&(t={and:[t,{or:[{eq:{"asset.specificType":p.specificType}},{eq:{"provision.asset.specificType":p.specificType}}]}]}),t},rootKey:"assets",collection:[],customSelectors:a().assetsSearchBuilder(),specificType:p.specificType},p.assetSelected=function(e,t){if(p.multiple){var i=[];angular.forEach(p.asset,function(e){i.push(e.provision.administration.identifier._current.value)}),p.ngModel=i}else p.ngModel=e.provision.administration.identifier._current.value;if(p.onSelectItem){var n={};n.$item=e,n.$model=t,p.onSelectItem(n)}},p.assetRemove=function(e,i){p.onRemove&&p.onRemove(e,i),p.ngModel=t},p.actions||(p.actions=[{title:p.ownConfig.specificType||r.instant("BUTTON.TITLE.NEW_ASSET"),icon:"glyphicon glyphicon-plus-sign",action:function(){var e={};p.specificType&&(e={resourceType:{_current:{value:"entity.asset"}},provision:{asset:{specificType:{_current:{value:p.specificType}}}}}),o.executeModal("createAsset",e,function(e){e&&e.length>0&&(p.asset=p.asset?p.asset:[],p.asset.push({provision:{administration:{identifier:{_current:{value:e[0].identifier}}},asset:{identifier:{_current:{value:e[0].identifier}}}}}))})},permissions:"manageEntity"}]),p.$onChanges=function(e){e&&e.identifier&&c(e.identifier.currentValue)},p.required!==t&&(p.ngRequired=p.required),p.identifier&&c(p.identifier)}]),angular.module("opengate-angular-js").component("customUiSelectAsset",{templateUrl:"custom-ui-select/views/custom.ui.select.asset.html",controller:"customUiSelectAssetController",bindings:{onSelectItem:"&",onRemove:"&",asset:"=",identifier:"<?",multiple:"<",ngRequired:"<",required:"<",label:"=",action:"=?",specificType:"@?",disabled:"<?",ngModel:"=?",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").controller("customUiSelectAreaController",["$scope","$element","$attrs","$api","$q",function(e,t,i,n,a){var o,r=this;r.organization&&(o=[{eq:{"areas.organization":r.organization}}]),r.ownConfig={builder:n().areasSearchBuilder(),filter:function(e){return r.lastSearch=e,o?(e&&o.push({or:[{like:{"areas.name":e}},{like:{"areas.organization":e}}]}),{and:o}):e?{or:[{like:{"areas.name":e}},{like:{"areas.organization":e}}]}:{}},rootKey:"areas",collection:[],customSelectors:n().areasSearchBuilder()},r.areaSelected=function(e,t){var i={};i.$item=e,i.$model=t,r.onSelectItem(i)},r.areaRemove=function(e,t){var i={};i.$item=e,i.$model=t,r.onRemove(i)}}]),angular.module("opengate-angular-js").component("customUiSelectArea",{templateUrl:"custom-ui-select/views/custom.ui.select.area.html",controller:"customUiSelectAreaController",bindings:{onSelectItem:"&",onRemove:"&",area:"=",multiple:"<",required:"=",organization:"<",uiSelectMatchClass:"@?"}}),angular.module("opengate-angular-js").service("$provisionDatastreamsUtils",[function(){function e(e){return e.filter(function(e){return n.indexOf(e.identifier)===-1})}function t(){return angular.copy(a)}function i(){return angular.copy(n)}var n=["internal","provisionSubscriber","provisionGeneric","provisionDevice","provisionAsset","provisionSubscription","ticket","provisionGenericChannel","provisionGenericOrganization","provisionGenericIdentifier"],a={and:[{like:{"datamodels.categories.datastreams.identifier":"^(provision.).*"}}]};return{getCoreDatamodelsCatalog:i,filterForCoreDatamodelsCatalog:e,getFilter:t}}]),angular.module("opengate-angular-js").service("$oguxThemes",[function(){var e="light",i="orange",n=e+" "+i,a=[{name:"default"},{name:"light"}],o={red:{id:"red",sample:"#f44336",sampleType:"normal",rgba:"rgba(244, 67, 54, 0.5)",name:"COLOR.RED",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_red.css"]},"neon-red":{id:"neon-red",sample:"#f44336",sampleType:"neon",rgba:"rgba(244, 67, 54, 0.5)",name:"COLOR.NEON_RED",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-red.css"]},"darkneon-red":{id:"darkneon-red",sample:"#f44336",sampleType:"neon",rgba:"rgba(244, 67, 54, 0.5)",name:"COLOR.DARK_NEON_RED",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-red.css"]},pink:{id:"pink",sample:"#e91e63",rgba:"rgba(233, 30, 99, 0.5)",name:"COLOR.PINK",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_pink.css"]},purple:{id:"purple",sample:"#9c27b0",rgba:"rgba(156, 39, 176, 0.5)",name:"COLOR.PURPLE",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_purple.css"]},deeppurple:{id:"deeppurple",sample:"#673ab7",rgba:"rgba(103, 10, 183, 0.5)",name:"COLOR.DEEP_PURPLE",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_deeppurple.css"]},indigo:{id:"indigo",sample:"#3f51b5",rgba:"rgba(63, 81, 181, 0.5)",name:"COLOR.INDIGO",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_indigo.css"]},blue:{id:"blue",sample:"#2196f3",rgba:"rgba(33, 150, 243, 0.5)",name:"COLOR.BLUE",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_blue.min.css"]},"neon-blue":{id:"neon-blue",sample:"#2196f3",sampleType:"neon",rgba:"rgba(33, 150, 243, 0.5)",name:"COLOR.NEON_BLUE",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-blue.css"]},"darkneon-blue":{id:"darkneon-blue",sample:"#2196f3",sampleType:"neon",rgba:"rgba(33, 150, 243, 0.5)",name:"COLOR.DARK_NEON_BLUE",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-blue.css"]},lightblue:{id:"lightblue",sample:"#03a9f4",rgba:"rgba(3, 169, 244, 0.5)",name:"COLOR.LIGTH_BLUE",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_lightblue.css"]},cyan:{id:"cyan",sample:"#00bcd4",rgba:"rgba(0, 188, 212, 0.5)",name:"COLOR.CYAN",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_cyan.min.css"]},teal:{id:"teal",sample:"#009688",rgba:"rgba(0, 150, 136, 0.5)",name:"COLOR.TEAL",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_teal.min.css"]},"neon-teal":{id:"neon-teal",sample:"#009688",sampleType:"neon",rgba:"rgba(0, 150, 136, 0.5)",name:"COLOR.NEON_TEAL",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-teal.css"]},"darkneon-teal":{id:"darkneon-teal",sample:"#009688",sampleType:"neon",rgba:"rgba(0, 150, 136, 0.5)",name:"COLOR.DARK_NEON_TEAL",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-teal.css"]},green:{id:"green",sample:"#4caf50",rgba:"rgba(76, 175, 80, 0.5)",name:"COLOR.GREEN",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_green.min.css"]},"neon-green":{id:"neon-green",sample:"#4caf50",sampleType:"neon",rgba:"rgba(76, 175, 80, 0.5)",name:"COLOR.NEON_GREEN",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-green.css"]},"darkneon-green":{id:"darkneon-green",sample:"#4caf50",sampleType:"neon",rgba:"rgba(76, 175, 80, 0.5)",name:"COLOR.DARK_NEON_GREEN",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-green.css"]},lightgreen:{id:"lightgreen",sample:"#8bc34a",rgba:"rgba(139, 195, 74, 0.5)",name:"COLOR.LIGHT_GREEN",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_lightgreen.min.css"]},lime:{id:"lime",sample:"#cddc39",rgba:"rgba(205, 220, 57, 0.5)",name:"COLOR.LIME",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_lime.min.css"]},yellow:{id:"yellow",sample:"#ffeb3b",rgba:"rgba(255, 235, 59, 0.5)",name:"COLOR.YELLOW",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_yellow.min.css"]},amber:{id:"amber",sample:"#ffc107",rgba:"rgba(255, 193, 7, 0.5)",name:"COLOR.AMBER",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_amber.min.css"]},"neon-orange":{id:"neon-orange",sample:"#ff9800",sampleType:"neon",rgba:"rgba(255, 152, 0, 0.5)",name:"COLOR.NEON_ORANGE",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-orange.css"]},"darkneon-orange":{id:"darkneon-orange",sample:"#ff9800",sampleType:"neon",rgba:"rgba(255, 152, 0, 0.5)",name:"COLOR.DARK_NEON_ORANGE",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-orange.css"]},orange:{id:"orange",sample:"#ff9800",rgba:"rgba(255, 152, 0, 0.5)",name:"COLOR.ORANGE",theme:["light","default","fresh","freshdark","traversed","traversed-dark"]},deeporange:{id:"deeporange",sample:"#ff5722",rgba:"rgba(255, 87, 34, 0.5)",name:"COLOR.DEEP_ORANGE",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_deeporange.min.css"]},brown:{id:"brown",sample:"#795548",rgba:"rgba(121, 85, 72, 0.5)",name:"COLOR.BROWN",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_brown.min.css"]},grey:{id:"grey",sample:"#9e9e9e",rgba:"rgba(33, 150, 243, 1)",name:"COLOR.GREY",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_grey.min.css"]},"neon-grey":{id:"neon-grey",sample:"#9e9e9e",sampleType:"neon",rgba:"rgba(33, 150, 243, 1)",name:"COLOR.NEON_GREY",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_neon-grey.css"]},"darkneon-grey":{id:"darkneon-grey",sample:"#9e9e9e",sampleType:"neon",rgba:"rgba(33, 150, 243, 1)",name:"COLOR.DARK_NEON_GREY",theme:["default","freshdark","traversed-dark"],url:["css/themes/bootstrap-material-design_darkneon-grey.css"]},bluegrey:{id:"bluegrey",sample:"#607d8b",rgba:"rgba(96, 125, 139, 0.5)",name:"COLOR.BLUE_GREY",theme:["light","default","fresh","freshdark","traversed","traversed-dark"],url:["css/themes/bootstrap-material-design_bluegrey.min.css"]},darkgrey:{id:"darkgrey",sample:"#2D2D2D",rgba:"rgba(45, 45, 45, 0.5)",name:"COLOR.DARK_GREY",theme:["light","fresh","traversed"],url:["css/themes/bootstrap-material-design_darkgrey.min.css"]}};return{setThemeComposition:function(t){n=t;var a=n.split(" ");e=a[0],i=a[1]},colors:function(){var e={};return angular.forEach(o,function(t,i){t.hidden||(e[i]=t)}),e},themes:function(){return a},getColorConfig:function(e){return o[e]?o[e]:t},getColorsKeys:function(){return Object.keys(o)},colorsByTheme:function(e){var t=[];return angular.forEach(o,function(i,n){i.hidden||i.theme.indexOf(e)===-1||t.push(i)}),t},getThemeFromThemeComposition:function(){return e},getColorFromThemeComposition:function(){return o[i]},getColorsCombinationFromTheme:function(){var e=new ColorScheme;return e.from_hex(o[i].sample.substring(1)),e.scheme("analogic"),e.distance(1),e.add_complement(!0),e.variation("light"),e.colors()}}}]),angular.module("opengate-angular-js").service("$ogapi",function(){function i(){var i;this.api=function(){if("undefined"!=typeof i)return i;throw new Error("Must invoke create([options]) function before api() function")},this.create=function(t){return i=new e.OpenGateAPI(t)},this.release=function(){return i=t,this}}return new i}),angular.module("opengate-angular-js").service("$ogapiErrorParser",["jsonPath",function(e){return{toString:function(t,i){if(t.data&&!angular.isString(t.data)){for(var n="",a=e(t,"$..message"),o=0;o<a.length;o++)n+=a[o]+(i?i:"\n");return n}return t.data&&angular.isString(t.data)?t.data:t},toStringArray:function(t){var i=e(t,"$..message");return i}}}]),angular.module("opengate-angular-js").service("$jsonFinderHelper",["jsonPath",function(e){return o.prototype.jsonPath=e,{administration:new o,provisioned:new s,collected:new r,subscriber:{collected:new h,provisioned:new m},subscription:{collected:new f,provisioned:new g},asset:{collected:new l,provisioned:new c},human:{collected:new u,provisioned:new p},ticket:{provisioned:new d}}}]),o.prototype.getOriginalPath=function(e){if(!this.fields[e])throw new Error("Field <"+e+"> not found. Available:"+JSON.stringify(Object.keys(this.fields)));return this.fields[e]},o.prototype.getPath=function(e){return this.getOriginalPath(e).replace("[]","[*]")},o.prototype.getAmpliaPath=function(e){if(!this.fields[e])throw new Error("Field <"+e+"> not found. Available:"+JSON.stringify(Object.keys(this.fields)));return this.fields[e]},o.prototype.findOne=function(e,t){return this.findAll(e,t)[0]},o.prototype.findAll=function(e,t){return this.jsonPath(e,this.getPath(t)+"._current.value")||[];
},r.prototype=new o,s.prototype=new r,s.prototype.getPath=function(e){var t=o.prototype.getPath.call(this,e);return t.startsWith("provision.")||(t="provision."+t),t},s.prototype.getAmpliaPath=function(e){var t=o.prototype.getAmpliaPath.call(this,e);return t.startsWith("provision.")||(t="provision."+t),t},s.prototype.getOriginalPath=function(e){var t=o.prototype.getOriginalPath.call(this,e);return t.startsWith("provision.")||(t="provision."+t),t},h.prototype=new r,h.prototype.getPath=function(e){var t=r.prototype.getPath.call(this,e);return t.replace("device.communicationModules[*].subscriber","")},h.prototype.getOriginalPath=function(e){var t=r.prototype.getOriginalPath.call(this,e);return t.replace("device.communicationModules[].subscriber","")},m.prototype=new s,m.prototype.getPath=function(e){var t=s.prototype.getPath.call(this,e);return t.replace("device.communicationModules[*].subscriber","")},m.prototype.getOriginalPath=function(e){var t=s.prototype.getOriginalPath.call(this,e);return t.replace("device.communicationModules[].subscriber","")},f.prototype=new r,f.prototype.getPath=function(e){var t=r.prototype.getPath.call(this,e);return t.replace("device.communicationModules[*].subscription","")},f.prototype.getOriginalPath=function(e){var t=r.prototype.getOriginalPath.call(this,e);return t.replace("device.communicationModules[].subscription","")},g.prototype=new s,g.prototype.getPath=function(e){var t=s.prototype.getPath.call(this,e);return t.replace("device.communicationModules[*].subscription","")},g.prototype.getOriginalPath=function(e){var t=s.prototype.getOriginalPath.call(this,e);return t.replace("device.communicationModules[*].subscription","")},l.prototype=new r,l.prototype.getPath=function(e){var t=r.prototype.getPath.call(this,e);return t.replace("device.","asset.")},l.prototype.getOriginalPath=function(e){var t=r.prototype.getOriginalPath.call(this,e);return t.replace("device.","asset.")},c.prototype=new s,c.prototype.getPath=function(e){var t=s.prototype.getPath.call(this,e);return t.replace("device.","asset.")},c.prototype.getOriginalPath=function(e){var t=s.prototype.getOriginalPath.call(this,e);return t.replace("device.","asset.")},d.prototype=new s,d.prototype.getPath=function(e){var t=s.prototype.getPath.call(this,e);return t.replace("device.","ticket.")},d.prototype.getOriginalPath=function(e){var t=s.prototype.getOriginalPath.call(this,e);return t.replace("device.","ticket.")},u.prototype=new l,u.prototype.getPath=function(e){var t=l.prototype.getPath.call(this,e),i=t.replace("asset.","human.");return i.replace("device.","human.")},u.prototype.getOriginalPath=function(e){var t=l.prototype.getOriginalPath.call(this,e),i=t.replace("asset.","human.");return i.replace("device.","human.")},p.prototype=new c,p.prototype.getPath=function(e){var t=c.prototype.getPath.call(this,e),i=t.replace("asset.","human.");return i.replace("device.","human.")},p.prototype.getOriginalPath=function(e){var t=c.prototype.getOriginalPath.call(this,e),i=t.replace("asset.","human.");return i.replace("device.","human.")},angular.module("opengate-angular-js").factory("Filter",["$window","$sce","$q",function(e,i,n){function a(e,t){var n,a,o,s=[];if(e&&0!==e.trim().length){var l=e.toLowerCase().trim();for(n=0;n<t.length&&s.length<8;n++)if(a=t[n],a.toLowerCase().indexOf(l)>-1){var c=s.find(function(e){return e.value===a});c||s.push({label:i.trustAsHtml(r(a,e)),value:a})}for(n=0;n<p.length&&s.length<12;n++)o=p[n],o.toLowerCase().indexOf(l)>-1&&s.push({label:i.trustAsHtml(r(o,e)),value:o})}else{for(n=0;n<t.length&&s.length<8;n++){a=t[n];var c=s.find(function(e){return e.value===a});c||s.push({label:i.trustAsHtml(r(a,e)),value:a})}for(n=0;n<p.length&&s.length<12;n++)o=p[n],s.push({label:i.trustAsHtml(r(o,e)),value:o})}return s}function o(e,i,o){var r=n.defer();return o.findFields(e).then(function(n){var o=n,s=-1;if(i.selectionStart?s=i.selectionStart-1:i.prop&&(s=i.prop("selectionStart")-1),!(s<0)){var l;if(e!==t&&""!==e){for(var c=-1;s>=0&&c===-1;s--)m.indexOf(e[s])>-1?c=s+1:0===s&&(c=s);var d=c;for(s=c;s<e.length&&d===c;s++)m.indexOf(e[s])>-1?d=s+1:s===e.length-1&&(d=s+1);l=a(e.substring(c,d),o)}else l=a();l.forEach(function(e){e.value=e.value}),r.resolve(l)}})["catch"](function(e){console.error(e),r.reject(e)}),r.promise}function r(e,t){var i=new RegExp("("+t+")","gi");return e.replace(i,'<span class="text-info">$1</span>')}function s(t){var i=n.defer(),a=i.promise,o=null,r={text:[],offsets:[],filter:{}};try{e.jsep.addBinaryOp("and",1),e.jsep.addBinaryOp("&&",1),e.jsep.addBinaryOp("||",2),e.jsep.addBinaryOp("or",2),e.jsep.addBinaryOp("in",2),e.jsep.addBinaryOp("within",2),e.jsep.addBinaryOp("~",6),e.jsep.addBinaryOp("=",6),e.jsep.addBinaryOp("like",6),e.jsep.addBinaryOp("gt",6),e.jsep.addBinaryOp("lte",6),e.jsep.addBinaryOp("gte",6),e.jsep.addBinaryOp("eq",6),e.jsep.addBinaryOp("neq",6),e.jsep.addBinaryOp(",",6),o=e.jsep(t),r.filter[o.operator]=[],r.filter=l(o),i.resolve(r)}catch(s){var c=s;s.description&&(c=s.description),i.reject(c)}return a}function l(e){var t,i,n,a={};if("BinaryExpression"===e.type&&/\eq|\neq|\like|\gt|\lt|\gte|\lte|\=|\'<'|\'>'|\~|\!/.test(e.operator)){t=d(e.left).split(".").reverse().join("."),t=t.replace(".undefined","[]");var o=e.right;if("UnaryExpression"===o.type&&o.prefix){var r=o.operator+o.argument.value;i=isNaN(r)?r:1*r}else i=o.name||o.value;n=u(e.operator),a[n]={},a[n][t]=i}else if("BinaryExpression"===e.type&&/or|and/.test(e.operator))a[e.operator]=[],a[e.operator].push(l(e.left)),a[e.operator].push(l(e.right));else if("BinaryExpression"===e.type&&/\within/.test(e.operator))"ArrayExpression"===e.right.type&&e.right.elements[0].left&&e.right.elements[0].right&&(t=d(e.left).split(".").reverse().join("."),t=t.replace(".undefined","[]"),n=u(e.operator),a[n]={},a[n][t]=[e.right.elements[0].left.value,e.right.elements[0].right.value]);else if("BinaryExpression"===e.type&&/\in/.test(e.operator)){t=d(e.left).split(".").reverse().join("."),t=t.replace(".undefined","[]"),n=u(e.operator),a[n]={};var s=c(e.right);console.log(s),a[n][t]=s}return a}function c(e){var t=[];switch(e.type){case"Identifier":t.push(e.name);break;case"Literal":t.push(e.value);break;case"BinaryExpression":if(/\,/.test(e.operator)){var i=c(e.left),n=c(e.right);t=i.concat(n)}}return t}function d(e){var t="";return"Identifier"===e.type?t=e.name:"MemberExpression"===e.type&&(t=e.property.name+"."+d(e.object)),t}function u(e){return"=="===e?"eq":"="===e?"eq":"!="===e?"neq":"~"===e?"like":">"===e?"gt":"<"===e?"lt":">="===e?"gte":"<="===e?"lte":e}var p=[],m=[" ","\n","!","=","~",">","<","&","or","and",")","in",",","neq","like","within"];return{suggest_field_delimited:function(e,t,i){var n=o(e,t,i);return n},parseQuery:function(e){var t=s(e);return t}}}]),angular.module("opengate-angular-js").factory("faStylesService",["$http",v]),angular.module("opengate-angular-js").service("$entityQratingUtils",[function(){function e(e){var t=0,i=0,n=0,a=0,o=0,r=0;return angular.forEach(e,function(e){var o=jsonPath(e,"_value._current.scoring");if(o){t+=o[0].performance;var r=o[0].qrating.max_score;r>0&&(a+=r*o[0].performance/100,n+=r),i++}}),i>0&&t>0&&n>0?(r=t/i,o=100*a/n,{qPerformance:o,avgPerformance:r,medidas:i,maxScore:n,score:a}):null}function t(e){var t=0,i=0,n=0,a=0,o=0,r=0;return angular.forEach(e,function(e,o){if(e._value&&e._value._current&&e._value._current.scoring&&e._value._current.scoring.qrating&&e._value._current.scoring.performance){var r=e._value._current.scoring;t+=r.performance;var s=r.qrating.max_score;s>0&&(a+=s*r.performance/100,n+=s),i++}}),i>0&&t>0&&n>0?(r=t/i,o=100*a/n,{qPerformance:o,avgPerformance:r,medidas:i,maxScore:n,score:a}):null}return{calculate:e,calculateFlattened:t}}]),angular.module("opengate-angular-js").service("$entityFlattenedExtractor",["$jsonFinderHelper",function(e){function t(t,i){var n=[];if(t&&t.length>0){var a={};angular.forEach(t,function(t,n){(t[e.provisioned.getAmpliaPath(i+"Identifier")]||t[e.collected.getAmpliaPath(i+"Identifier")])&&angular.forEach(t,function(e,o){o.startsWith("provision.device.communicationModules[]."+i)||o.startsWith("device.communicationModules[]."+i)?angular.forEach(e,function(e,i){e._index&&(a[n]||(a[n]={},a[n].$device=t),a[n][o]=e)}):(o.startsWith("provision.administration")||"resourceType"===o)&&(a[n]||(a[n]={},a[n].$device=t),a[n][o]=e)})}),angular.forEach(a,function(e,t){n.push(e)})}return n}function i(e,i){var n=t(e,"subscriber");return i&&(i=n),n}function n(e,i){var n=t(e,"subscription");return i&&(i=n),n}return{extractSubscribers:i,extractSubscriptions:n}}]).service("$entityExtractor",["$q",function(e){function t(e,t){var i=[];return(e&&e.length>0||e&&e.length>0)&&angular.forEach(e,function(e,n){var a=null,o=null;e.provision.device&&e.provision.device.communicationModules&&e.provision.device.communicationModules.length>0&&angular.forEach(e.provision.device.communicationModules,function(e,i){e[t]&&(a?a.provision||(a.provision={}):a={provision:{}},a.provision[t]=e[t],a.provision[t].identifier&&(o=angular.copy(a.provision[t].identifier)))}),e.device&&e.device.communicationModules&&e.device.communicationModules.length>0&&angular.forEach(e.device.communicationModules,function(e,i){e[t]&&(a||(a={}),a[t]=e[t])}),(a[t]||a.provision[t])&&(a.$device=e,e.provision.administration&&(a.provision||(a.provision={}),a.provision.administration=e.provision.administration,o&&(a.provision.administration.identifier=o))),a&&i.push(a)}),i}function i(i,n){var a;i&&i.devices?a=t(i.devices,"subscriber"):i&&i.data&&i.data.devices&&(a=t(i.data.devices,"subscriber")),n&&angular.copy(a,n);var o={subscribers:a};return e(function(e){e(n||o)})}function n(i,n){var a;i&&i.devices?a=t(i.devices,"subscription"):i&&i.data&&i.data.devices&&(a=t(i.data.devices,"subscription")),n&&angular.copy(a,n);var o={subscriptions:a};return e(function(e){e(n||o)})}return{extractSubscribers:i,extractSubscriptions:n}}]),angular.module("opengate-angular-js").service("$dataFormatter",[function(){return new y}]),y.prototype.format=function(e){return this.isDataUrl(e)?(new b).format(e):e},b.prototype=new y,b.prototype.format=function(e){return'<img alt="image" class="datastreamImage" src="'+e+'"/>'},angular.module("opengate-angular-js").filter("communicationsInterface",function(){return function(e){var t=e;switch(t){case"COMMUNICATIONS_MODULE":return"Communications module";case"SUBSCRIPTION":return"Mobile line";case"SUBSCRIBER":return"SIM";case"HOME_OPERATOR":return"Home Operator";case"REGISTER_OPERATOR":return"Register Operator";case"ADDRESS":return"IP";case"SOFTWARE":return"Software";case"HARDWARE":return"Hardware";case"entityKey":return"Identifier";default:return t}}}).filter("dateNames",function(){var e={MON:"Monday",TUE:"Tuesday",WED:"Wednesday",THU:"Thursday",FRI:"Friday",SAT:"Saturday",SUN:"Sunday"},t={JAN:"January",FEB:"February",MAR:"March",APR:"April",MAY:"May",JUN:"June",JUL:"July",AUG:"August",SEP:"September",OCT:"October",NOV:"November",DEC:"December"};return function(i){return e[i]||t[i]||i}}).filter("icons",function(){return function(e,t,i){var n="fa fa-info";return"list"===e&&(n="fa fa-list"),"ban"===e&&(n="fa fa-ban"),"laptop"===e&&(n="fa fa-laptop"),"spin"===e&&(n="fa fa-spinner fa-spin"),"unit"===e&&(n="fa fa-plus-square"),"tags"===e&&(n="fa fa-tags"),n}}).filter("codeErrors",function(){var e={1004:"At least one valid reference to an entity is required",1005:"At least one valid reference to an entity is required",1017:"Tag is not valid. Please, check it."};return function(t){return{code:t.code,message:e[t.code]||t.message}}}).filter("wapiErrors",function(){var e={"-1":"Connection problems",413:"Upload size exceeded"};return function(t,i){var n="";return n=angular.isUndefined(i)?e[t]?e[t]:"Code: "+t:i+" ("+(e[t]?e[t]:"Code: "+t)+")"}}).filter("textlength",function(){return function(e,t){var i=30;return t&&angular.isNumber(t)&&(i=t),e&&e.length>i?e.substring(0,i)+"...":e}}).filter("compactid",function(){return function(e){return e&&e.indexOf(".")>-1?e.substring(e.lastIndexOf(".")+1):e}}),angular.module("opengate-angular-js").directive("showErrors",["$timeout","$interpolate",function(e,t){var i=function(i,n,a,o){var r,s,l,c,d,u,p=!1,m=!1;if(c=i.$eval(a.showErrors)||{},d=c.showSuccess||!1,r=n[0].querySelector(".form-control[name]")||n[0].querySelector("[name]"),l=angular.element(r),s=t(l.attr("name")||"")(i),!s)throw"show-errors element has no child input elements with a 'name' attribute class";var h=function(){return e(function(){n.removeClass("has-error"),n.removeClass("has-success"),m=!1},0,!1)};i.$watch(function(){return o[s]&&o[s].$invalid},function(e){return u(e)}),i.$on("show-errors-check-validity",function(e,t){if(angular.isUndefined(t)||o.$name===t)return p=!0,m=!0,u(o[s].$invalid)}),i.$on("show-errors-reset",function(e,t){if(angular.isUndefined(t)||o.$name===t)return h()}),u=function(e){if(n.toggleClass("has-error",m&&e),d)return n.toggleClass("has-success",m&&!e)}};return{restrict:"A",require:"^form",compile:function(e,t){if(t.showErrors.indexOf("skipFormGroupCheck")===-1&&!e.hasClass("form-group")&&!e.hasClass("input-group"))throw"show-errors element does not have the 'form-group' or 'input-group' class";return i}}}]),angular.module("opengate-angular-js").directive("elemReady",["$parse",function(e){return{restrict:"A",link:function(t,i,n){i.ready(function(){t.$apply(function(){var i=e(n.elemReady);i(t)})})}}}]),angular.module("opengate-angular-js").directive("disallowSpaces",function(){return{restrict:"A",link:function(t,i){i.bind("input",function(){e.$(this).val(e.$(this).val().replace(/ /g,""))})}}}),angular.module("opengate-angular-js").controller("fieldOptionsController",["$scope","$element","$attrs",function(e,t,i){}]),angular.module("opengate-angular-js").component("fieldOptions",{templateUrl:"components/views/fieldOptions.html",controller:"fieldOptionsController",bindings:{multiple:"<",required:"<",loading:"<"}}),angular.module("opengate-angular-js").controller("customUiMapController",["$scope","mapUxService","geocodingService","Authentication","$timeout",function(e,i,n,a,o){function r(t,i,n){c.location.position||(c.location.position={type:"Point"}),c.location.position.coordinates=[i,t],c.coordsObj={current:{lat:t,lng:i},"new":{lat:t,lng:i}},c.location.zoom=n?n:c.map.center.zoom,c.map.markers.marker||(c.map.center={lat:t,lng:i,zoom:n?n:c.map.center.zoom},c.map.markers={marker:{lat:t,lng:i,draggable:!c.disabled,message:l(c.location,!0),compileMessage:!0,getMessageScope:function(){return e.removeMarker=s,e}}})}function s(){c.disabled||(c.map.markers={},c.location.position&&delete c.location.position,c.getInfo())}function l(e,t){var i="";return i+=e.address?e.address:"",i+=e.postal?(i?", ":"")+e.postal:"",i+=e.town?(i?", ":"")+e.town:"",i+=e.province?(i?", ":"")+e.province:"",i+=e.region?(i?", ":"")+e.region:"",i+=e.country?(i?", ":"")+e.country:"",t&&!c.disabled&&(i+='<br><div class="text-right"><button type="button" class="btn btn-warning text-danger btn-xs no-margin" ng-click="removeMarker()"><i class="fa fa-trash"></i></button></div>'),i}var c=this;c.coordsObj={current:{lat:null,lng:null},"new":{lat:null,lng:null}},c.reloadingInfo=!1,c.getInfo=function(){c.reloadingInfo=!0,c.location.country=t,c.location.region=t,c.location.province=t,c.location.town=t,c.location.postal=t,c.location.address=t,c.display_name=t,c.map.markers.marker?n.reverseSearch(c.map.markers.marker.lat,c.map.markers.marker.lng,18,function(e,i){c.reloadingInfo=!1,i&&i.address&&(c.location.country=i.address.country||t,c.location.region=i.address.state||t,c.location.province=i.address.county||t,c.location.town=i.address.city||i.address.village||i.address.town||t,c.location.postal=i.address.postcode||t,c.location.address=i.address.road||i.address.pedestrian||t),c.display_name=l(c.location),c.map.markers.marker.message=l(c.location,!0)},{},a.user.langCode):c.reloadingInfo=!1};var d=i.getDefaultOptions();delete d.l_gohome,delete d.l_print,c.map=i.createNgOptions(d),angular.extend(c.map,{center:{lat:40.095,lng:-3.823,zoom:4},markers:{},events:{markers:{enable:["dragend","click"],logic:"emit"},map:{enable:["click","focus"],logic:"emit"}}}),c.location&&(c.location.position&&c.location.position.coordinates&&r(c.location.position.coordinates[1],c.location.position.coordinates[0],c.location.zoom),c.display_name=l(c.location)),c.map.id=e.$id,c.searchCoords=function(){c.map.center={lat:c.coordsObj["new"].lat,lng:c.coordsObj["new"].lng,zoom:17},c.coordsObj={current:{lat:c.coordsObj["new"].lat,lng:c.coordsObj["new"].lng},"new":{lat:c.coordsObj["new"].lat,lng:c.coordsObj["new"].lng}},i.getMapWithId(c.map.id,function(e){e.invalidateSize(),e.fireEvent("focus")})},c.applyCoords=function(){c.coordsObj={current:{lat:c.coordsObj["new"].lat,lng:c.coordsObj["new"].lng},"new":{lat:c.coordsObj["new"].lat,lng:c.coordsObj["new"].lng}},i.getMapWithId(c.map.id,function(e){e.invalidateSize(),e.fireEvent("focus")}),c.disabled||(delete c.map.markers.marker,r(c.coordsObj["new"].lat,c.coordsObj["new"].lng),c.getInfo())};var u=[];u.push(e.$on("leafletDirectiveMarker."+c.map.id+".click",function(e,t){t.leafletObject._map.invalidateSize(),t.leafletObject.getPopup()._isOpen||s()})),u.push(e.$on("leafletDirectiveMap."+c.map.id+".focus",function(e,t){t.leafletObject.invalidateSize()})),u.push(e.$on("leafletDirectiveMap."+c.map.id+".click",function(e,t){if(t.leafletObject.invalidateSize(),!c.disabled){var i=t.leafletEvent.latlng;delete c.map.markers.marker,r(i.lat,i.lng,t.leafletObject._zoom),c.getInfo()}})),u.push(e.$on("leafletDirectiveMarker."+c.map.id+".dragend",function(e,t){var i=t.leafletEvent.target._leaflet_events.dragend[0].context._latlng;delete c.map.markers.marker,r(i.lat,i.lng,t.leafletObject._zoom),c.getInfo()})),c.showMap=!1,o(function(){c.showMap=!0,e.$apply(),i.getMapWithId(c.map.id,function(e){e.invalidateSize(),e.fireEvent("focus")})},500),c.$onDestroy=function(){angular.forEach(u,function(e){e()})}}]),angular.module("opengate-angular-js").component("customUiMap",{templateUrl:"components/views/custom.ui.map.html",controller:"customUiMapController",bindings:{label:"=",location:"=",required:"=",disabled:"=",onlyMap:"="}}),angular.module("opengate-angular-js").controller("actionButtonController",["$scope","$element","$attrs",function(e,t,i){var n=this;n.onAction=function(e){e.disable&&e.disable()||e.action(),console.log(e)}}]),angular.module("opengate-angular-js").component("actionButton",{templateUrl:"components/views/action.button.html",controller:"actionButtonController",bindings:{actions:"<"}})}(window);