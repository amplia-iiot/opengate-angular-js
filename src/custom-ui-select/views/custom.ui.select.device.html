<div class="form-group no-margin" mass-autocomplete ng-if="$ctrl.multiple">
    <label class="custom-ui-select-label">{{ ($ctrl.label?$ctrl.label:'FORM.LABEL.ENTITY_KEY') | translate }} <field-options required="$ctrl.ngRequired" multiple="$ctrl.multiple" /></label>
    <ui-select custom-ui-select-config="$ctrl.ownConfig" ng-disabled="$ctrl.disabled" name="device" ng-model="$ctrl.device" theme="bootstrap" title="Choose an entity" custom-ui-select multiple="true" custom-mass-autocomplete-item="$ctrl.ownConfig" on-select="$ctrl.deviceSelected($item, $model)"
        on-remove="$ctrl.deviceRemove($item, $model)" ng-required="$ctrl.ngRequired" disable-default-sorted="form.disableDefaultSorted">
        <ui-select-match class="{{$ctrl.uiSelectMatchClass}}" placeholder="{{ 'FORM.PLACEHOLDER.ENTITY' | translate }}" allow-clear="true">
            <div class="entity-editable" permission permission-only="'editDevice'" ng-dblclick="$ctrl.editDevice($item)" title="{{ 'BUTTON.TITLE.DOUBLE_CLICK_EDIT' | translate }}">&nbsp;</div> {{$item.provision.administration.identifier._current.value || $item.identifier}}
        </ui-select-match>
        <ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index">
            <span ng-bind-html="$ctrl.showFieldInfo($ctrl.matchFields.principal, entityData) | highlight: $select.search"></span>
            <small>
                <div ng-repeat="(field, path) in $ctrl.matchFields.extra track by $index" ng-if="$ctrl.showFieldInfo(path, entityData)">
                    {{ field | translate }}: <span ng-bind-html="$ctrl.showFieldInfo(path, entityData) | highlight: $select.search"></span>
                </div>
            </small>
        </ui-select-choices>
        <ui-select-no-choice>
            {{ 'UX-ERROR.DATA_NOT_FOUND' | translate }}
        </ui-select-no-choice>
    </ui-select>
</div>
<div class="form-group no-margin" mass-autocomplete ng-if="!$ctrl.multiple">
    <label class="custom-ui-select-label">{{ ($ctrl.label?$ctrl.label:'FORM.LABEL.ENTITY_KEY') | translate }} <field-options required="$ctrl.ngRequired" multiple="$ctrl.multiple" /></label>
    <ui-select custom-ui-select-config="$ctrl.ownConfig" ng-disabled="$ctrl.disabled" name="device" ng-model="$ctrl.device" theme="bootstrap" title="Choose an entity" custom-ui-select multiple="false" custom-mass-autocomplete-item="$ctrl.ownConfig" on-select="$ctrl.deviceSelected($item, $model)"
        on-remove="$ctrl.deviceRemove($item, $model)" ng-required="$ctrl.ngRequired" disable-default-sorted="form.disableDefaultSorted">
        <ui-select-match class="{{$ctrl.uiSelectMatchClass}}" placeholder="{{ 'FORM.PLACEHOLDER.ENTITY' | translate }}" allow-clear="true">
            <div class="entity-editable" permission permission-only="'editDevice'" ng-dblclick="$ctrl.editDevice($item)" title="{{ 'BUTTON.TITLE.DOUBLE_CLICK_EDIT' | translate }}">&nbsp;</div> {{$item.provision.administration.identifier._current.value || $item.identifier}}
        </ui-select-match>
        <ui-select-choices repeat="entityData in $ctrl.ownConfig.collection track by $index">
            <span ng-bind-html="$ctrl.showFieldInfo($ctrl.matchFields.principal, entityData) | highlight: $select.search"></span>
            <small>
                <div ng-repeat="(field, path) in $ctrl.matchFields.extra track by $index" ng-if="$ctrl.showFieldInfo(path, entityData)">
                    {{ field | translate }}: <span ng-bind-html="$ctrl.showFieldInfo(path, entityData) | highlight: $select.search"></span>
                </div>
            </small>
        </ui-select-choices>
        <ui-select-no-choice>
            {{ 'UX-ERROR.DATA_NOT_FOUND' | translate }}
        </ui-select-no-choice>
    </ui-select>
</div>
<action-button ng-if="!$ctrl.disabled" actions="$ctrl.uiSelectActions">
</action-button>